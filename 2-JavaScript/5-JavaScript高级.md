#ç›®å½•

>[TOC]

# ä¸€ã€javaScriptåŸºç¡€æ€»ç»“

## 1ã€æ•°æ®ç±»å‹ç›¸å…³çŸ¥è¯†ç‚¹

### â… -åŸºæœ¬(å€¼)ç±»å‹

>1. String: ä»»æ„å­—ç¬¦ä¸²
>2. Number: ä»»æ„çš„æ•°å­—
>3. boolean: true/false
>4. undefined: undefined
>5. null: null  -->ä½¿ç”¨`typeof`æ—¶è¿”å›`object`
>6. [symbol](https://developer.mozilla.org/zh-CN/docs/Glossary/Symbol) ([ECMAScript](https://developer.mozilla.org/zh-CN/docs/Glossary/ECMAScript) 2016æ–°å¢)ã€‚ -->Symbol æ˜¯ [åŸºæœ¬æ•°æ®ç±»å‹](https://developer.mozilla.org/zh-CN/docs/Glossary/Primitive) çš„ä¸€ç§ï¼Œ[`Symbol`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol) å¯¹è±¡æ˜¯ SymbolåŸå§‹å€¼çš„[å°è£… (en-US)](https://developer.mozilla.org/en-US/docs/Glossary/Wrapper) ã€‚
>7. [bigint](https://developer.mozilla.org/zh-CN/docs/Glossary/BigInt)ï¼Œ  -->**BigInt** æ˜¯ä¸€ç§æ•°å­—ç±»å‹çš„æ•°æ®ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä»»æ„ç²¾åº¦æ ¼å¼çš„æ•´æ•°ã€‚
>
>åŠ ä¸Šä¸‹æ–¹çš„ [ å¯¹è±¡ ] ç±»å‹,ç›®å‰ javaScript æœ‰å…«ç§æ•°æ®ç±»å‹

### â…¡-å¯¹è±¡(å¼•ç”¨)ç±»å‹

>1. Object: ä»»æ„å¯¹è±¡
>2. Function: ä¸€ç§ç‰¹åˆ«çš„`å¯¹è±¡`(å¯ä»¥æ‰§è¡Œ)  --å†…éƒ¨åŒ…å«å¯è¿è¡Œçš„ä»£ç 
>3. Array: ä¸€ç§ç‰¹åˆ«çš„`å¯¹è±¡`(`key`ä¸ºæ•°å€¼ä¸‹æ ‡å±æ€§, å†…éƒ¨æ•°æ®æ˜¯æœ‰åºçš„)

### â…¢-åˆ¤æ–­æ–¹æ³•

#### â‘ *` typeof`*

>**`typeof`** æ“ä½œç¬¦è¿”å›ä¸€ä¸ª`å­—ç¬¦ä¸²`ï¼Œè¡¨ç¤ºæœªç»è®¡ç®—çš„æ“ä½œæ•°çš„ç±»å‹ã€‚
>
>* å¯ä»¥åˆ¤æ–­: undefined/ æ•°å€¼ / å­—ç¬¦ä¸² / å¸ƒå°”å€¼ / function
>
>* ä¸èƒ½åˆ¤æ–­: nullä¸object  objectä¸arrayï¼›æ•°ç»„ã€å¯¹è±¡ã€nulléƒ½ä¼šè¢«åˆ¤æ–­ä¸ºobjectï¼Œå…¶ä»–åˆ¤æ–­éƒ½æ­£ç¡®
>
>* `æ³¨æ„`: è¿è¡Œ`console.log(typeof undefined)`æ—¶,å¾—åˆ°çš„çš„ä¹Ÿæ˜¯ä¸€ä¸ª`å­—ç¬¦ä¸²,åŒæ—¶ä¸ºå°å†™!!`--> `'undefined'`
>
>* ä»£ç ç¤ºä¾‹
>
> ```js
>   // typeofè¿”å›æ•°æ®ç±»å‹çš„å­—ç¬¦ä¸²è¡¨è¾¾
>   var a
>
>   //æ³¨æ„:typeofè¿”å›çš„æ˜¯å­—ç¬¦ä¸²
>   console.log(a, typeof a, typeof a==='undefined',a===undefined )  // undefined 'undefined' true true
>   console.log(undefined === 'undefined') //false
>
>   a = 4
>   console.log(typeof a==='number') //true
>
>   a = 'hongjilin'
>   console.log(typeof a==='string') //true
>   console.log(typeof a==='String') //false  -->æ³¨æ„,è¿”å›çš„ç±»å‹ä¸ºå°å†™
>
>   a = true
>   console.log(typeof a==='boolean') //true
>
>   a = null
>   console.log(typeof a, a===null) // 'object'  true
>  let b={}
>   console.log(typeof b,typeof null, '-------') // 'object' 'object'  -->æ‰€ä»¥Typeofä¸èƒ½åˆ¤æ–­nullä¸object
>
>
>var num = 18;
>console.log(typeof num); //è¿™é‡Œtypeofå’Œå˜é‡ä¹‹é—´æ˜¯ç©ºæ ¼éš”å¼€
>
>console.log(typeof 2);               // number
>console.log(typeof true);            // boolean
>console.log(typeof 'str');           // string
>console.log(typeof []);              // object    
>console.log(typeof function(){});    // function
>console.log(typeof {});              // object
>console.log(typeof undefined);       // undefined
>console.log(typeof null);            // object
> ```

#### â‘¡*`instanceof`*(åˆ¤æ–­å®ä¾‹æ–¹æ³•)

>- `ä¸“é—¨åˆ¤æ–­å¯¹è±¡`çš„å…·ä½“ç±»å‹,è¿”å›çš„æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå‡½æ•°å’Œæ•°ç»„éƒ½æ˜¯instanceof objectç›¸ç­‰
>
>- **`instanceof`** **è¿ç®—ç¬¦**ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ `prototype` å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚
>
>- ä»£ç ç¤ºä¾‹:
>
> ```js
>   var b1 = {
>     b2: [1, 'abc', console.log],
>  //å¯ä»¥ç®€åŒ–æˆ b3:()=>()=> 'hongjilin'  -->é«˜é˜¶å‡½æ•°ç›¸å…³çŸ¥è¯†
>     b3: function () {
>       return  () =>{  return   'hongjilin'}
>     }
>   }
>  /**ä½¿ç”¨instanceofè¿›è¡Œå¯¹è±¡åˆ¤æ–­*/
>   console.log(b1 instanceof Object, b1 instanceof Array) // true  false
>   console.log(b1.b2 instanceof Array, b1.b2 instanceof Object) // true trueï¼Œåé¢çš„objectä¹Ÿæ˜¯true
>   console.log(b1.b3 instanceof Function, b1.b3 instanceof Object) // true true
>
>//instanceofçš„æ„æ€æ˜¯å®ä¾‹åŒ–ï¼Œa instanceof bå°±æ˜¯aæ˜¯å¦æ˜¯bçš„å®ä¾‹åŒ–,æ¯”å¦‚b=object,objectå°±æ˜¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡
>
>   /**ä½¿ç”¨typeofè¿›è¡Œå¯¹è±¡ä¸­æŸå±æ€§çš„åˆ¤æ–­*/
>  console.log(typeof b1.b2, typeof null) // 'object' 'object'  
>   console.log(typeof b1.b3==='function') // true
>   console.log(typeof b1.b2[2]==='function') //true
>
>   /**è°ƒç”¨å¯¹è±¡ä¸æ•°ç»„ä¸­æŸå‡½æ•°ç¤ºä¾‹*/
>   b1.b2[2]('è°ƒç”¨console.logæ‰“å°hongjilin')    //è°ƒç”¨console.logæ‰“å°hongjilin
>   console.log(b1.b3()()) // hongjilin
> ```

#### â‘¢*`===`*

>å…·ä½“å¯ä»¥çœ‹ MDNçš„[JavaScriptä¸­çš„ç›¸ç­‰æ€§åˆ¤æ–­](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Equality_comparisons_and_sameness)
>
>å¯ä»¥åˆ¤æ–­: undefined, null
>
>ç®€è€Œè¨€ä¹‹ï¼Œåœ¨æ¯”è¾ƒä¸¤ä»¶äº‹æƒ…æ—¶ï¼Œ`åŒç­‰å·å°†æ‰§è¡Œç±»å‹è½¬æ¢`;` ä¸‰ç­‰å·å°†è¿›è¡Œç›¸åŒçš„æ¯”è¾ƒï¼Œè€Œä¸è¿›è¡Œç±»å‹è½¬æ¢` (å¦‚æœç±»å‹ä¸åŒ, åªæ˜¯æ€»ä¼šè¿”å› false )

### â…£-ç›¸å…³é—®é¢˜å¼•å‡º

#### â‘  *undefinedä¸nullçš„åŒºåˆ«?*

>* undefinedä»£è¡¨å®šä¹‰æœªèµ‹å€¼
>
>* nulllå®šä¹‰å¹¶èµ‹å€¼äº†, åªæ˜¯å€¼ä¸ºnull
>
>* ä»£ç ç¤ºä¾‹
>
>  ```js
>    var a
>    console.log(a)  // undefined
>    a = null
>    console.log(a) // null
>  ```

#### â‘¡ *ä»€ä¹ˆæ—¶å€™ç»™å˜é‡èµ‹å€¼ä¸ºnullå‘¢?*

>* åˆå§‹èµ‹å€¼, è¡¨æ˜å°†è¦èµ‹å€¼ä¸ºå¯¹è±¡,`å¯ä»¥ç”¨åšçº¦å®šä¿—æˆçš„å ä½ç¬¦`
>
>* ç»“æŸå‰, è®©å¯¹è±¡æˆä¸ºåƒåœ¾å¯¹è±¡(è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶)
>
>* ä»£ç ç¤ºä¾‹
>
>  ```js
>    //èµ·å§‹,å¯ä»¥ç”¨åšçº¦å®šä¿—æˆçš„å ä½ç¬¦
>    var b = null  // åˆå§‹èµ‹å€¼ä¸ºnull, è¡¨æ˜å°†è¦èµ‹å€¼ä¸ºå¯¹è±¡
>    //ç¡®å®šå¯¹è±¡å°±èµ‹å€¼
>    b = ['atguigu', 12]
>    //æœ€ååœ¨ä¸ä½¿ç”¨çš„æ—¶å€™,å°†å…¶å¼•ç”¨ç½®ç©º,å°±å¯ä»¥é‡Šæ”¾bè¿™ä¸ªå¯¹è±¡å ç”¨çš„å†…å­˜      ---å½“æ²¡æœ‰å¼•ç”¨æŒ‡å‘å®ƒçš„å¯¹è±¡ç§°ä¸ºåƒåœ¾å¯¹è±¡
>    b = null // è®©bæŒ‡å‘çš„å¯¹è±¡æˆä¸ºåƒåœ¾å¯¹è±¡(è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶)
>  ```

#### â‘¢ *ä¸¥æ ¼åŒºåˆ«å˜é‡ç±»å‹ä¸æ•°æ®ç±»å‹?*

>* æ•°æ®çš„ç±»å‹
>  * åŸºæœ¬ç±»å‹
>  * å¯¹è±¡ç±»å‹
>* å˜é‡çš„ç±»å‹(å˜é‡å†…å­˜å€¼çš„ç±»å‹)
>  * åŸºæœ¬ç±»å‹: ä¿å­˜å°±æ˜¯`åŸºæœ¬ç±»å‹`çš„æ•°æ®
>  * å¼•ç”¨ç±»å‹: ä¿å­˜çš„æ˜¯åœ°å€å€¼(å¯¹è±¡ç±»å‹)

### â…¤-è¡¥å……çŸ¥è¯†ç‚¹:

#### â‘ å­—ç¬¦ä¸²å¯¹æ¯”*`>`ã€`<`*ä»¥åŠ*`charCodeAt()`*æ–¹æ³•

>1. Javascriptå­—ç¬¦ä¸²åœ¨è¿›è¡Œå¤§äº(å°äº)æ¯”è¾ƒæ—¶ï¼Œä¼šæ ¹æ®ç¬¬ä¸€ä¸ªä¸åŒçš„å­—ç¬¦çš„asciiå€¼ç è¿›è¡Œæ¯”è¾ƒï¼Œå½“æ•°å­—(number)ä¸å­—ç¬¦ä¸²(string)è¿›è¡Œæ¯”è¾ƒå¤§å°æ—¶ï¼Œä¼šå¼ºåˆ¶çš„å°†æ•°å­—(number)è½¬æ¢æˆå­—ç¬¦ä¸²(string)ç„¶åå†è¿›è¡Œæ¯”è¾ƒ
>
>   ```js
>   (function(){
>       console.log('13'>'3'); // è¾“å‡ºï¼šfalse
>       console.log(5>'6');  // è¾“å‡ºï¼š false
>       console.log('d'>'ABDC') // è¾“å‡ºï¼š true
>       console.log(19>'ssf') // è¾“å‡º false
>       console.log('A'>'abcdef') // è¾“å‡º false
>   })()
>   ```
>
>2. æ‰‹åŠ¨è½¬æ¢ä¸ºasciiåç›¸å‡,ç”¨æ­£è´Ÿæ•°è¡¨ç¤ºå¤§å°
>
>   ```tsx
>   sorter={(a:string,b:string)=> a.charCodeAt()-b.charCodeAt()}
>   ```



## 2ã€æ•°æ®,å˜é‡, å†…å­˜çš„ç†è§£

### â… -ä»€ä¹ˆæ˜¯æ•°æ®?

>1. å­˜å‚¨åœ¨å†…å­˜ä¸­ä»£è¡¨ç‰¹å®šä¿¡æ¯çš„'ä¸œè¥¿', æœ¬è´¨ä¸Šæ˜¯0101...
>2. æ•°æ®çš„ç‰¹ç‚¹: `å¯ä¼ é€’`, `å¯è¿ç®—`    -->let a=0;b=a ğŸ”œä½“ç°å¯ä¼ é€’
>3. ä¸€åˆ‡çš†æ•°æ®
>4. å†…å­˜ä¸­æ‰€æœ‰æ“ä½œçš„ç›®æ ‡: æ•°æ®
>  * ç®—æœ¯è¿ç®—
>  * é€»è¾‘è¿ç®—
>  * èµ‹å€¼
>  * è¿è¡Œå‡½æ•°

### â…¡-ä»€ä¹ˆæ˜¯å†…å­˜?

>1. å†…å­˜æ¡é€šç”µåäº§ç”Ÿçš„å¯å‚¨å­˜æ•°æ®çš„ç©ºé—´(ä¸´æ—¶çš„)
>
>![èŠ‚ç‚¹](./image/image-20210630191828124.png)
>
>2. å†…å­˜äº§ç”Ÿå’Œæ­»äº¡: å†…å­˜æ¡(ç”µè·¯ç‰ˆ)==>é€šç”µ==>äº§ç”Ÿå†…å­˜ç©ºé—´==>å­˜å‚¨æ•°æ®==>å¤„ç†æ•°æ®==>æ–­ç”µ==>å†…å­˜ç©ºé—´å’Œæ•°æ®éƒ½æ¶ˆå¤±
>
>3. ä¸€å—å°å†…å­˜çš„2ä¸ªæ•°æ®
>  * å†…éƒ¨å­˜å‚¨çš„æ•°æ®
>  * åœ°å€å€¼
>
>4. å†…å­˜åˆ†ç±»
> * æ ˆ: å…¨å±€å˜é‡/å±€éƒ¨å˜é‡
> * å †: å¯¹è±¡
> * ![èŠ‚ç‚¹](./image/image-20210630192130518.png" alt="image-20210630192130518" style="zoom:50%;")

### â…¢-ä»€ä¹ˆæ˜¯å˜é‡?

>* å¯å˜åŒ–çš„é‡, ç”±å˜é‡åå’Œå˜é‡å€¼ç»„æˆ
>* æ¯ä¸ªå˜é‡éƒ½å¯¹åº”çš„ä¸€å—å°å†…å­˜, å˜é‡åç”¨æ¥æŸ¥æ‰¾å¯¹åº”çš„å†…å­˜, å˜é‡å€¼å°±æ˜¯å†…å­˜ä¸­ä¿å­˜çš„æ•°æ®
>
>ps:å˜é‡`obj.xx`-->`.`ç›¸å½“äºæ‹¿ç€åœ°å€æ‰¾åˆ°åé¢å¯¹åº”çš„å†…å­˜,æ‰€ä»¥åªæœ‰å½“æˆ‘å˜é‡ä¸­å­˜çš„æ˜¯åœ°å€,æ‰å¯ä»¥ç”¨`.`

### â…£-å†…å­˜,æ•°æ®, å˜é‡ä¸‰è€…ä¹‹é—´çš„å…³ç³»

>* å†…å­˜ç”¨æ¥å­˜å‚¨æ•°æ®çš„ç©ºé—´
>* å˜é‡æ˜¯å†…å­˜çš„æ ‡è¯†

### â…¤-ç›¸å…³é—®é¢˜å¼•å‡º

#### â‘  *å…³äºèµ‹å€¼å’Œå†…å­˜çš„é—®é¢˜*

>let a = xxx, aå†…å­˜ä¸­åˆ°åº•ä¿å­˜çš„æ˜¯ä»€ä¹ˆ?
>
>* xxxæ˜¯åŸºæœ¬æ•°æ®, ä¿å­˜çš„å°±æ˜¯è¿™ä¸ªæ•°æ®
>* xxxæ˜¯å¯¹è±¡, ä¿å­˜çš„æ˜¯å¯¹è±¡çš„åœ°å€å€¼
>* xxxæ˜¯ä¸€ä¸ªå˜é‡, ä¿å­˜çš„xxxçš„å†…å­˜å†…å®¹(å¯èƒ½æ˜¯åŸºæœ¬æ•°æ®, ä¹Ÿå¯èƒ½æ˜¯åœ°å€å€¼)

#### â‘¡ *å…³äºå¼•ç”¨å˜é‡èµ‹å€¼é—®é¢˜*

>* 2ä¸ªå¼•ç”¨å˜é‡æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡, é€šè¿‡ä¸€ä¸ªå˜é‡ä¿®æ”¹å¯¹è±¡å†…éƒ¨æ•°æ®, å¦ä¸€ä¸ªå˜é‡çœ‹åˆ°çš„æ˜¯ä¿®æ”¹ä¹‹åçš„æ•°æ®
>
>* 2ä¸ªå¼•ç”¨å˜é‡æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡, è®©å…¶ä¸­ä¸€ä¸ªå¼•ç”¨å˜é‡æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡, å¦ä¸€å¼•ç”¨å˜é‡ä¾ç„¶æŒ‡å‘å‰ä¸€ä¸ªå¯¹è±¡
>
>* ä»£ç ç¤ºä¾‹:
>
>  ```js
>    let a = {age: 12}
>  //æ­¤æ—¶æ˜¯å°†aæŒ‡å‘çš„åœ°å€å€¼èµ‹å€¼ç»™B,æ‰€ä»¥Bæ­¤æ—¶ä¹ŸæŒ‡å‘{age:12}è¿™ä¸ªå†…å­˜
>    let b = a
>  //æ­¤æ—¶é‡æ–°åˆ›å»ºäº†ä¸€ä¸ªå†…å­˜å¹¶è®©aæŒ‡å‘å®ƒ,æ‰€ä»¥æ­¤å¤„aæŒ‡å‘çš„æ˜¯{name:'hong'},è€ŒbæŒ‡å‘ä»æ˜¯åˆšå¼€å§‹çš„æŒ‡å‘{age:12}
>    a = {name: 'hong'}
>  //æ­¤æ—¶aä¸bæŒ‡å‘çš„å†…å­˜å·²ç»ä¸ä¸€æ ·äº†,æ‰€ä»¥ä¿®æ”¹äº’ä¸å½±å“
>    b.age = 14
>    console.log(b.age, a.name, a.age) // 14 hong undefined
>    //2ä¸ªå¼•ç”¨å˜é‡æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡, è®©å…¶ä¸­ä¸€ä¸ªå¼•ç”¨å˜é‡æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡, å¦ä¸€å¼•ç”¨å˜é‡ä¾ç„¶æŒ‡å‘å‰ä¸€ä¸ªå¯¹è±¡   -->æ‰€ä»¥ a ä»æ˜¯  {name: 'hong'}
>    const fn2=(obj) => obj = {age: 15}
>    fn2(a)
>    console.log(a.age) //undefined 
>  ```

#### â‘¢ *åœ¨jsè°ƒç”¨å‡½æ•°æ—¶ä¼ é€’å˜é‡å‚æ•°æ—¶, æ˜¯å€¼ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’*

>* ç†è§£1: éƒ½æ˜¯å€¼(åŸºæœ¬/åœ°å€å€¼)ä¼ é€’
>
> * æ‰€ä»¥å®é™…ä¸Šä¼ è¿›functionä¸­çš„å‚æ•°ä¹Ÿæ˜¯æ‹¿ç€å…¶å­˜ç€çš„åœ°å€å€¼æ‰¾å†…å­˜
>
>   ```js
>   //ä¼ è¿›æ¥çš„objå­˜å‚¨çš„æ˜¯aä¸­å­˜çš„åœ°å€å€¼,æ‰€ä»¥obj==a(å› ä¸ºä»–ä»¬åœ°å€å€¼ä¸€è‡´,æŒ‡å‘ä¸€è‡´)
>   //2ä¸ªå¼•ç”¨å˜é‡æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡, é€šè¿‡ä¸€ä¸ªå˜é‡ä¿®æ”¹å¯¹è±¡å†…éƒ¨æ•°æ®, å¦ä¸€ä¸ªå˜é‡çœ‹åˆ°çš„æ˜¯ä¿®æ”¹ä¹‹åçš„æ•°æ®  -->æ‰€ä»¥è¢«è¿›è¡Œäº†ä¿®æ”¹
>     let a = {name: 'hong'}
>     const fn2=(obj) => obj.age= 15
>     fn2(a)
>     console.log(a.age) //15
>   ```
>
>* ç†è§£2: å¯èƒ½æ˜¯å€¼ä¼ é€’, ä¹Ÿå¯èƒ½æ˜¯å¼•ç”¨ä¼ é€’(åœ°å€å€¼)

#### â‘£ *JSå¼•æ“å¦‚ä½•ç®¡ç†å†…å­˜?*

>1. å†…å­˜ç”Ÿå‘½å‘¨æœŸ
>  * åˆ†é…å°å†…å­˜ç©ºé—´, å¾—åˆ°å®ƒçš„ä½¿ç”¨æƒ
>  * å­˜å‚¨æ•°æ®, å¯ä»¥åå¤è¿›è¡Œæ“ä½œ
>  * é‡Šæ”¾å°å†…å­˜ç©ºé—´
>2. é‡Šæ”¾å†…å­˜
>  * å±€éƒ¨å˜é‡: å‡½æ•°æ‰§è¡Œå®Œè‡ªåŠ¨é‡Šæ”¾
>  * å¯¹è±¡: æˆä¸ºåƒåœ¾å¯¹è±¡==>åƒåœ¾å›æ”¶å™¨å›æ”¶
>
>```js
>  var a = 3
>  var obj = {name:"hong"}
>  obj = undefined ||null  //æ­¤æ—¶,objæ²¡æœ‰è¢«é‡Šæ”¾,ä½†æ˜¯ä¹‹å‰å£°æ˜çš„`{name:"hong"}`ç”±äºæ²¡æœ‰äººæŒ‡å‘å®ƒ,ä¼šåœ¨åé¢ä½ æŸä¸ªæ—¶åˆ»è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶
> 
>function fn () { var b = {}}
>  fn() // bæ˜¯è‡ªåŠ¨é‡Šæ”¾, bæ‰€æŒ‡å‘çš„å¯¹è±¡æ˜¯åœ¨åé¢çš„æŸä¸ªæ—¶åˆ»ç”±åƒåœ¾å›æ”¶å™¨å›æ”¶
>```

## 3ã€å¯¹è±¡

### â… -å¯¹è±¡çš„æ¦‚å¿µ

#### â‘  *ä»€ä¹ˆæ˜¯å¯¹è±¡?*

>* å¤šä¸ªæ•°æ®çš„å°è£…ä½“
>* ç”¨æ¥ä¿å­˜å¤šä¸ªæ•°æ®çš„å®¹å™¨
>* ä¸€ä¸ªå¯¹è±¡ä»£è¡¨ç°å®ä¸­çš„ä¸€ä¸ªäº‹ç‰©

#### â‘¡ *ä¸ºä»€ä¹ˆè¦ç”¨å¯¹è±¡?*

>* ç»Ÿä¸€ç®¡ç†å¤šä¸ªæ•°æ®

#### â‘¢ *å¯¹è±¡çš„ç»„æˆ*

>* å±æ€§: å±æ€§å(å­—ç¬¦ä¸²)å’Œå±æ€§å€¼(ä»»æ„)ç»„æˆ
>* æ–¹æ³•: ä¸€ç§ç‰¹åˆ«çš„å±æ€§(å±æ€§å€¼æ˜¯å‡½æ•°)

### â…¡-å¦‚ä½•è®¿é—®å¯¹è±¡å†…éƒ¨æ•°æ®?

>* `.å±æ€§å`: ç¼–ç ç®€å•, æœ‰æ—¶ä¸èƒ½ç”¨
>* `['å±æ€§å']`: ç¼–ç éº»çƒ¦, èƒ½é€šç”¨

### â…¢-ä»€ä¹ˆæ—¶å€™å¿…é¡»ä½¿ç”¨`['å±æ€§å']`çš„æ–¹å¼?

>1. å±æ€§ååŒ…å«ç‰¹æ®Šå­—ç¬¦: `-` `ç©ºæ ¼`
>2. å±æ€§åä¸ç¡®å®š
>
>```js
>  var p = {}
>  //1. ç»™på¯¹è±¡æ·»åŠ ä¸€ä¸ªå±æ€§: content type: text/json
>  // p.content-type = 'text/json' //ä¸èƒ½ç”¨
>  p['content-type'] = 'text/json'
>  console.log(p['content-type'])
>
>  //2. å±æ€§åä¸ç¡®å®š
>  var propName = 'myAge'
>  var value = 18
>  // p.propName = value //ä¸èƒ½ç”¨
>  p[propName] = value
>  console.log(p[propName])
>```

## 4ã€å‡½æ•°

### â… -å‡½æ•°çš„æ¦‚å¿µ

#### â‘  *ä»€ä¹ˆæ˜¯å‡½æ•°*

>  * å®ç°ç‰¹å®šåŠŸèƒ½çš„næ¡è¯­å¥çš„å°è£…ä½“
>  * åªæœ‰å‡½æ•°æ˜¯å¯ä»¥æ‰§è¡Œçš„, å…¶å®ƒç±»å‹çš„æ•°æ®ä¸èƒ½æ‰§è¡Œ

#### â‘¡ *ä¸ºä»€ä¹ˆè¦ç”¨å‡½æ•°?*

>* æé«˜ä»£ç å¤ç”¨
>* ä¾¿äºé˜…è¯»äº¤æµ

#### â‘¢ *å¦‚ä½•å®šä¹‰å‡½æ•°?*

>* å‡½æ•°å£°æ˜
>
>* è¡¨è¾¾å¼
>
>  ```js
>    function fn1 () { console.log('fn1()' )//å‡½æ•°å£°æ˜
>                     
>    const fn2 = ()=> console.log('fn2()')  //è¡¨è¾¾å¼
>  ```

### â…¡-å¦‚ä½•è°ƒç”¨(æ‰§è¡Œ)å‡½æ•°

>1. test(): ç›´æ¥è°ƒç”¨
>2. obj.test(): é€šè¿‡å¯¹è±¡è°ƒç”¨
>3. new test(): newè°ƒç”¨
>4. `test.call/apply(obj)`: ä¸´æ—¶è®©testæˆä¸ºobjçš„æ–¹æ³•è¿›è¡Œè°ƒç”¨
>   - ![image-20210705185535337](./image/image-20210705185535337.png)  
>
>5. ä»£ç ç¤ºä¾‹
>
>  ```js
>    var obj = {}
>    //æ­¤å¤„ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°,å› ä¸ºç®­å¤´å‡½æ•°ä¼šæ”¹å˜thisæŒ‡å‘
>    function test2 () {
>      this.xxx = 'hongjilin'
>    }
>    // obj.test2()  ä¸èƒ½ç›´æ¥, æ ¹æœ¬å°±æ²¡æœ‰
>    test2.call(obj)  // å¯ä»¥è®©ä¸€ä¸ªå‡½æ•°æˆä¸ºæŒ‡å®šä»»æ„å¯¹è±¡çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨
>    console.log(obj.xxx)
>
>  ```

### â…¢-å›è°ƒå‡½æ•°

#### â‘  *ä»€ä¹ˆå‡½æ•°æ‰æ˜¯å›è°ƒå‡½æ•°?*

>- ä½ å®šä¹‰çš„
>- ä½ æ²¡æœ‰è°ƒ
>- ä½†æœ€ç»ˆå®ƒæ‰§è¡Œäº†(åœ¨æŸä¸ªæ—¶åˆ»æˆ–æŸä¸ªæ¡ä»¶ä¸‹)

#### â‘¡ *å¸¸è§çš„å›è°ƒå‡½æ•°?*

>* domäº‹ä»¶å›è°ƒå‡½æ•° ==>å‘ç”Ÿäº‹ä»¶çš„domå…ƒç´ 
>* å®šæ—¶å™¨å›è°ƒå‡½æ•° ===>windowï¼ˆè¶…æ—¶å®šæ—¶å™¨&å¾ªç¯å®šæ—¶å™¨ï¼‰
>* ajaxè¯·æ±‚å›è°ƒå‡½æ•°(åé¢è®²)
>* ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°(åé¢è®²)
>
>```js
>   // domäº‹ä»¶å›è°ƒå‡½æ•°
>  document.getElementById('btn').onclick = function () {alert(this.innerHTML)}
>  // å®šæ—¶å™¨å›è°ƒå‡½æ•°
>  setTimeout(function () {   alert('åˆ°ç‚¹äº†'+this)}, 2000)
>```

### â…£-IIFE (è‡ªè°ƒç”¨å‡½æ•°)

>1. å…¨ç§°: `Immediately-Invoked Function Expression` è‡ªè°ƒç”¨å‡½æ•°
>
>2. ä½œç”¨:
>
>     * éšè—å®ç°
>     * ä¸ä¼šæ±¡æŸ“å¤–éƒ¨(ä¸€èˆ¬æŒ‡å…¨å±€)å‘½åç©ºé—´
>     * ç”¨å®ƒæ¥ç¼–ç jsæ¨¡å—
>
>3. ä»£ç ç¤ºä¾‹
>
>   ```js
>     (function () { //åŒ¿åå‡½æ•°è‡ªè°ƒç”¨
>       var a = 3
>       console.log(a + 3)
>     })()
>     console.log(a) // a is not defined
>       
>     //æ­¤å¤„å‰æ–¹ä¸ºä½•è¦ä¸€ä¸ª`;`-->å› ä¸ºè‡ªè°ƒç”¨å‡½æ•°å¤–éƒ¨æœ‰ä¸€ä¸ª()åŒ…è£¹,å¯èƒ½ä¸å‰æ–¹ä»¥()ç»“å°¾çš„ä»£ç è¢«ä¸€èµ·è®¤ä¸ºæ˜¯å‡½æ•°è°ƒç”¨
>     //ä¸åŠ åˆ†å·å¯èƒ½ä¼šè¢«è®¤ä¸ºè¿™æ · console.log(a)(IIFE)
>     ;(function () {//ä¸ä¼šæ±¡æŸ“å¤–éƒ¨(å…¨å±€)å‘½åç©ºé—´-->ä¸¾ä¾‹
>       let a = 1;
>       function test () { console.log(++a) } //å£°æ˜ä¸€ä¸ªå±€éƒ¨å‡½æ•°test
>       window.$ = function () {  return {test: test} }// å‘å¤–æš´éœ²ä¸€ä¸ªå…¨å±€å‡½æ•°
>     })()
>    test ()  //test is not defined
>     $().test() // 1. $æ˜¯ä¸€ä¸ªå‡½æ•° 2. $æ‰§è¡Œåè¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡
>   ```

### â…¤-å‡½æ•°ä¸­çš„this

#### â‘  *thisæ˜¯ä»€ä¹ˆ?*

>* ä»»ä½•å‡½æ•°æœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡æŸä¸ªå¯¹è±¡æ¥è°ƒç”¨çš„,å¦‚æœæ²¡æœ‰ç›´æ¥æŒ‡å®šå°±æ˜¯window
>* æ‰€æœ‰å‡½æ•°å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªå˜é‡this
>* å®ƒçš„å€¼æ˜¯`è°ƒç”¨å‡½æ•°çš„å½“å‰å¯¹è±¡`

#### â‘¡ *å¦‚ä½•ç¡®å®šthisçš„å€¼?*

>* test(): window
>* p.test(): p
>* new test(): æ–°åˆ›å»ºçš„å¯¹è±¡
>* p.call(obj): obj

#### â‘¢ *ä»£ç ä¸¾ä¾‹è¯¦è§£*

>```js
>  function Person(color) {
>    console.log(this)
>    this.color = color;
>    this.getColor = function () {
>      console.log(this)
>      return this.color;
>    };
>    this.setColor = function (color) {
>      console.log(this)
>      this.color = color;
>    };
>  }
>
>  Person("red"); //thisæ˜¯è°? window
>
>  const p = new Person("yello"); //thisæ˜¯è°? p
>
>  p.getColor(); //thisæ˜¯è°? p
>
>  const obj = {};
>  //è°ƒç”¨callä¼šæ”¹å˜thisæŒ‡å‘-->è®©æˆ‘çš„på‡½æ•°æˆä¸º`obj`çš„ä¸´æ—¶æ–¹æ³•è¿›è¡Œè°ƒç”¨
>  p.setColor.call(obj, "black"); //thisæ˜¯è°? obj
>
>  const test = p.setColor;
>  test(); //thisæ˜¯è°? window  -->å› ä¸ºç›´æ¥è°ƒç”¨äº†
>
>  function fun1() {
>    function fun2() {  console.log(this); }
>    fun2(); //thisæ˜¯è°? window
>  }
> fun1();//è°ƒç”¨fun1
>```

## 5ã€å…³äºè¯­å¥åˆ†å·

>1. jsä¸€æ¡è¯­å¥çš„åé¢å¯ä»¥ä¸åŠ åˆ†å·
>2. æ˜¯å¦åŠ åˆ†å·æ˜¯ç¼–ç é£æ ¼é—®é¢˜, æ²¡æœ‰åº”è¯¥ä¸åº”è¯¥ï¼Œåªæœ‰ä½ è‡ªå·±å–œæ¬¢ä¸å–œæ¬¢
>3. åœ¨ä¸‹é¢2ç§æƒ…å†µä¸‹ä¸åŠ åˆ†å·ä¼šæœ‰é—®é¢˜
>  * `å°æ‹¬å·å¼€å¤´çš„å‰ä¸€æ¡è¯­å¥`
>  * `ä¸­æ–¹æ‹¬å·å¼€å¤´çš„å‰ä¸€æ¡è¯­å¥`
>4. è§£å†³åŠæ³•: åœ¨è¡Œé¦–åŠ åˆ†å·
>5. å¼ºæœ‰åŠ›çš„ä¾‹å­: vue.jsåº“
>6. çŸ¥ä¹çƒ­è®®: https://www.zhihu.com/question/20298345

------



# äºŒã€å‡½æ•°é«˜çº§

## 1ã€åŸå‹ä¸åŸå‹é“¾

### â… -åŸå‹ [prototype]

>1. å‡½æ•°çš„`prototype`å±æ€§
>* æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§, å®ƒé»˜è®¤æŒ‡å‘ä¸€ä¸ªObjectç©ºå¯¹è±¡(å³ç§°ä¸º: åŸå‹å¯¹è±¡)
>* åŸå‹å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªå±æ€§constructor, å®ƒæŒ‡å‘å‡½æ•°å¯¹è±¡(æ„é€ å‡½æ•°å’ŒåŸå‹å¯¹è±¡æœ‰ç›¸äº’å¼•ç”¨çš„å…³ç³»)
>* ![èŠ‚ç‚¹](./image/image-20210714201049312.png)
>2. ç»™åŸå‹å¯¹è±¡æ·»åŠ å±æ€§(`ä¸€èˆ¬éƒ½æ˜¯æ–¹æ³•`)
>* ä½œç”¨: å‡½æ•°çš„æ‰€æœ‰å®ä¾‹å¯¹è±¡è‡ªåŠ¨æ‹¥æœ‰åŸå‹ä¸­çš„å±æ€§(æ–¹æ³•)--> å®ä¾‹å¯¹è±¡å¯ä»¥è®¿é—®
>
>3. ä»£ç ç¤ºä¾‹
>
> ```js
>
>   // æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§, å®ƒé»˜è®¤æŒ‡å‘ä¸€ä¸ªObjectç©ºå¯¹è±¡(å³ç§°ä¸º: åŸå‹å¯¹è±¡)
>   console.log(Date.prototype, typeof Date.prototype)
>   function Fun () { }
>   console.log(Fun.prototype)  // é»˜è®¤æŒ‡å‘ä¸€ä¸ªObjectç©ºå¯¹è±¡(æ²¡æœ‰æˆ‘ä»¬è‡ªå·±è‡ªå®šä¹‰æ·»åŠ çš„å±æ€§)
>
>   // åŸå‹å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªå±æ€§constructor, å®ƒæŒ‡å‘å‡½æ•°å¯¹è±¡
>   console.log(Date.prototype.constructor===Date)
>   console.log(Fun.prototype.constructor===Fun)
>
>   //ç»™åŸå‹å¯¹è±¡æ·»åŠ å±æ€§(ä¸€èˆ¬æ˜¯æ–¹æ³•) ===>å®ä¾‹å¯¹è±¡å¯ä»¥è®¿é—®
>   Fun.prototype.test = function () { console.log('test()') }
>   var fun = new Fun()
>   fun.test()
> ```

### â…¡-æ˜¾å¼åŸå‹ä¸éšå¼åŸå‹

>1. æ¯ä¸ª**å‡½æ•°**functionéƒ½æœ‰ä¸€ä¸ª`prototype`ï¼Œå³`æ˜¾å¼`åŸå‹(å±æ€§)ï¼Œé»˜è®¤æŒ‡å‘objectç©ºå®ä¾‹å¯¹è±¡
>2. æ¯ä¸ª**å®ä¾‹å¯¹è±¡**éƒ½æœ‰ä¸€ä¸ª[`__ proto __`]ï¼Œå¯ç§°ä¸º`éšå¼`åŸå‹(å±æ€§)ï¼Œé»˜è®¤æŒ‡å‘objectç©ºå®ä¾‹å¯¹è±¡
>3. **å¯¹è±¡çš„éšå¼åŸå‹çš„å€¼ç­‰äºå¯¹åº”æ„é€ å‡½æ•°çš„æ˜¾å¼åŸå‹çš„å€¼**
>4. å†…å­˜ç»“æ„
>
>  ![image-20210714203043314](./image/image-20210714203043314.png) 
>
>5. æ€»ç»“:
> * å‡½æ•°çš„[`prototype`]å±æ€§: åœ¨å®šä¹‰å‡½æ•°æ—¶è‡ªåŠ¨æ·»åŠ çš„, é»˜è®¤å€¼æ˜¯ä¸€ä¸ªç©ºObjectå®ä¾‹å¯¹è±¡
>
> * å¯¹è±¡çš„[`__ proto __`]å±æ€§: åˆ›å»ºå¯¹è±¡æ—¶è‡ªåŠ¨æ·»åŠ çš„, `é»˜è®¤å€¼ä¸ºæ„é€ å‡½æ•°çš„prototypeå±æ€§å€¼`
>
> * ç¨‹åºå‘˜èƒ½ç›´æ¥æ“ä½œæ˜¾å¼åŸå‹, ä½†ä¸èƒ½ç›´æ¥æ“ä½œéšå¼åŸå‹(ES6ä¹‹å‰)
>
> * å‡½æ•°çš„æ˜¾ç¤ºåŸå‹æŒ‡å‘çš„å¯¹è±¡é»˜è®¤æ˜¯ç©ºObjectçš„å®ä¾‹å¯¹è±¡(ä½†Objectä¸æ»¡è¶³æ­¤æ¡ä»¶ï¼ŒObjectæŒ‡å‘çš„æ˜¯null) --> æ‰€æœ‰å‡½æ•°çš„åŸå‹å¯¹è±¡é»˜è®¤éƒ½æ˜¯Objectçš„å®ä¾‹(Objecté™¤å¤–)
>
>   ```
>   console.log(Fn.prototype instanceof Object) //true
>   console.log(Object.prototype instance of Object) //false
>   console.log(Function.prototype instanceof Object)  //true
>   ```
>
> * æ‰€æœ‰å‡½æ•°éƒ½æ˜¯Functionçš„å®ä¾‹(åŒ…æ‹¬Functionæœ¬èº«)
>
>   ```
>   console.log(Function.__proto__ === Function.prototype)  //true
>   ```
>
> * Objectçš„åŸå‹å¯¹è±¡æ˜¯åŸå‹é“¾çš„å°½å¤´
>
>   ```
>   console.log(Object.prototype.__proto__) //null
>   ```
>
>   
>
>6. ä»£ç ç¤ºä¾‹:
>
>  ```js
>    //å®šä¹‰æ„é€ å‡½æ•°
>    function Fn() {
>     // å†…éƒ¨é»˜è®¤æ‰§è¡Œè¯­å¥: this.prototype = {} --> é»˜è®¤æŒ‡å‘ç©ºå¯¹è±¡
>      }
>    // 1. æ¯ä¸ªå‡½æ•°functionéƒ½æœ‰ä¸€ä¸ªprototypeï¼Œå³æ˜¾å¼åŸå‹å±æ€§, é»˜è®¤æŒ‡å‘ä¸€ä¸ªç©ºçš„Objectå¯¹è±¡
>    console.log(Fn.prototype)
>    // 2. æ¯ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª__proto__ï¼Œå¯ç§°ä¸ºéšå¼åŸå‹
>    //åˆ›å»ºå®ä¾‹å¯¹è±¡
>    var fn = new Fn()  // å†…éƒ¨é»˜è®¤æ‰§è¡Œè¯­å¥: this.__proto__ = Fn.prototype
>    console.log(fn.__proto__)
>    // 3. å¯¹è±¡çš„éšå¼åŸå‹çš„å€¼ä¸ºå…¶å¯¹åº”æ„é€ å‡½æ•°çš„æ˜¾å¼åŸå‹çš„å€¼
>    console.log(Fn.prototype===fn.__proto__) // true
>    //ç»™åŸå‹æ·»åŠ æ–¹æ³•
>    Fn.prototype.test = function () {
>      console.log('test()')
>    }
>    //é€šè¿‡å®ä¾‹è°ƒç”¨åŸå‹çš„æ–¹æ³•
>    fn.test()
>  ```



### â…¢-åŸå‹é“¾

#### â‘  *åŸå‹é“¾*

>1. åŸå‹é“¾
>  * è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œ
>    * å…ˆåœ¨è‡ªèº«å±æ€§ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°è¿”å›
>    * å¦‚æœæ²¡æœ‰, å†æ²¿ç€[`__ proto __`]è¿™æ¡é“¾å‘ä¸ŠæŸ¥æ‰¾, æ‰¾åˆ°è¿”å›
>    * å¦‚æœæœ€ç»ˆæ²¡æ‰¾åˆ°, è¿”å›undefined
>    * ![image-20210714210912653](./image/image-20210714210912653.png)
>  * åˆ«å: éšå¼åŸå‹é“¾
>  * ä½œç”¨: æŸ¥æ‰¾å¯¹è±¡çš„å±æ€§(æ–¹æ³•) 

#### â‘¡*æ„é€ å‡½æ•°/åŸå‹/å®ä¾‹å¯¹è±¡çš„å…³ç³»(å›¾è§£)*

>1. ```js
>    var o1 = new Object();
>    var o2 = {};
>
>
>  ![image-20210714212928432](image/image-20210714212928432.png) 
>
>2. ```js
>    function Foo(){  } 
>    //å®é™…ä¸Šç­‰äºvar Foo = new Function(),å› æ­¤Fooå®é™…ä¸Šä¹Ÿæ˜¯Function()çš„å®ä¾‹å¯¹è±¡ï¼Œæœ‰__proto__å±æ€§
>    //æ‰€æœ‰å‡½æ•°(funtion)éƒ½æœ‰ä¸¤ä¸ªå±æ€§ï¼Œ__proto__å’Œprototype
>          
>    //ç‰¹ä¾‹ï¼šåªæœ‰å‡½æ•°çš„æ˜¾ç¤ºåŸå‹å±æ€§ç­‰äºå®ƒè‡ªèº«çš„éšå¼åŸå‹å±æ€§(å›¾ä¸­çš„ç¬¬äºŒä¸ªprototypeå’Œ__proto__æŒ‡å‘åŒä¸€ä¸ªFunction.prototype) --> ç›¸å½“äºFunction = new Function() newè‡ªå·±æœ¬èº« --> æ‰€æœ‰å‡½æ•°çš„prototypeéƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ new Function()
>          
>    //ç¬¬ä¸‰ä¸ª__proto__æŒ‡å‘ï¼šObjectæ˜¯Function()çš„å®ä¾‹å¯¹è±¡ --> åŸå› ï¼šä»»ä½•å‡½æ•°(æ— è®ºæ˜¯å†…ç½®å‡½æ•°è¿˜æ˜¯è‡ªå®šä¹‰å‡½æ•°)éƒ½æ˜¯Functionçš„å®ä¾‹å¯¹è±¡(new Function()) --> Objectä¹Ÿæ˜¯Objectå‡½æ•°
>
> ![image-20210714212945164](image/image-20210714212945164.png) 
>
>  ps:æ‰€æœ‰å‡½æ•°çš„[`__ proto __`]éƒ½æ˜¯ä¸€æ ·çš„ï¼›Functionæ˜¯å®ƒè‡ªèº«çš„å®ä¾‹
>
>

#### â‘¢ *å±æ€§é—®é¢˜*

>- è¯»å–å¯¹è±¡çš„å±æ€§å€¼æ—¶: ä¼šè‡ªåŠ¨åˆ°åŸå‹é“¾ä¸­æŸ¥æ‰¾(åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§å®ä¾‹å¯¹è±¡éƒ½æ˜¯å¯ä»¥è·å–åˆ°çš„) 
>
>- è®¾ç½®å¯¹è±¡çš„å±æ€§å€¼æ—¶: ä¸ä¼šæŸ¥æ‰¾åŸå‹é“¾, å¦‚æœå½“å‰å¯¹è±¡ä¸­æ²¡æœ‰æ­¤å±æ€§, ç›´æ¥æ·»åŠ æ­¤å±æ€§å¹¶è®¾ç½®å…¶å€¼
>
>- æ–¹æ³•ä¸€èˆ¬å®šä¹‰åœ¨åŸå‹ä¸­, å±æ€§ä¸€èˆ¬é€šè¿‡æ„é€ å‡½æ•°å®šä¹‰åœ¨å¯¹è±¡æœ¬èº«ä¸Š
>
>- ä»£ç ç¤ºä¾‹
>
>  ```js
>    function Fn() { }
>    Fn.prototype.a = 'xxx'
>    var fn1 = new Fn()
>    console.log(fn1.a, fn1) //xxx Fn{} --> åŸå‹é“¾ä¸»è¦æ˜¯ç”¨äºæŸ¥æ‰¾å¯¹è±¡çš„
>  
>    var fn2 = new Fn()
>    fn2.a = 'yyy'
>    console.log(fn1.a, fn2.a, fn2) //xxx yyy  Fn{a: "yyy"}
>  
>    function Person(name, age) {
>      this.name = name
>      this.age = age
>    }
>    Person.prototype.setName = function (name) {
>      this.name = name
>    }
>    var p1 = new Person('Tom', 12)
>    p1.setName('Bob')
>    console.log(p1)  //PersonÂ {name: "Bob", age: 12}
>  
>    var p2 = new Person('Jack', 12)
>    p2.setName('Cat')
>    console.log(p2) //PersonÂ {name: "Cat", age: 12}
>    console.log(p1.__proto__===p2.__proto__) // true   -->æ‰€ä»¥æ–¹æ³•ä¸€èˆ¬å®šä¹‰åœ¨åŸå‹ä¸­
>  ```

### â…£-instanceof

>1. instanceofæ˜¯å¦‚ä½•åˆ¤æ–­çš„?
>  * è¡¨è¾¾å¼: A instanceof Bï¼ˆAæ˜¯å®ä¾‹å¯¹è±¡ï¼ŒBæ˜¯æ„é€ å‡½æ•°ï¼‰
>  * å¦‚æœBå‡½æ•°çš„æ˜¾å¼åŸå‹å¯¹è±¡åœ¨Aå¯¹è±¡çš„åŸå‹é“¾ä¸Š, è¿”å›true, å¦åˆ™è¿”å›false(Aåªèƒ½æ²¿ç€```__proto__```æ‰¾;Båªèƒ½æ²¿ç€``prototype``æ‰¾)
>2. Functionæ˜¯é€šè¿‡newè‡ªå·±äº§ç”Ÿçš„å®ä¾‹
>
>```js
>  /*
>  æ¡ˆä¾‹1
>   */
>  function Foo() {  }
>  var f1 = new Foo()
>  console.log(f1 instanceof Foo) // true
>  console.log(f1 instanceof Object) // true
>
>  /*
>  æ¡ˆä¾‹2
>   */
>  console.log(Object instanceof Function) // true
>  console.log(Object instanceof Object) // true
>  console.log(Function instanceof Function) // true
>  console.log(Function instanceof Object) // true
>
>  function Foo() {}
>  console.log(Object instanceof  Foo) // false
>```
>

### â…¤-ç›¸å…³é¢è¯•é¢˜

>æµ‹è¯•é¢˜1:
>
>```js
>  /*
>  æµ‹è¯•é¢˜1
>   */
>  function A () {}
>  A.prototype.n = 1
>  let b = new A()
>  A.prototype = { n: 2, m: 3}
>  let c = new A()
>  console.log(b.n, b.m, c.n, c.m) // 1 undefined 2 3
>```
>
>æµ‹è¯•é¢˜2:åŸç†çœ‹[â‘¡*æ„é€ å‡½æ•°/åŸå‹/å®ä¾‹å¯¹è±¡çš„å…³ç³»(å›¾è§£)*](#â‘¡*æ„é€ å‡½æ•°/åŸå‹/å®ä¾‹å¯¹è±¡çš„å…³ç³»(å›¾è§£)*)
>
>```js
>  /*
>   æµ‹è¯•é¢˜2
>   */
>  function F (){}
>  Object.prototype.a = function(){
>    console.log('a()')
>  }
>  Function.prototype.b = function(){
>    console.log('b()')
>  }
>  
>  let f = new F()
>  f.a() //a()
>  f.b() //f.b is not a function -->æ‰¾ä¸åˆ°
>  F.a() //a()
>  F.b() //b()
>
>  console.log(f)
>  console.log(Object.prototype)
>  console.log(Function.prototype)
>```
>
>ç»“æœå›¾ä¾‹
>
>![image-20210723173855550](image/image-20210723173855550.png)



## 2ã€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ

### â… -å˜é‡æå‡ä¸å‡½æ•°æå‡

>1. å˜é‡å£°æ˜æå‡
>  * é€šè¿‡varå®šä¹‰(å£°æ˜)çš„å˜é‡, åœ¨å®šä¹‰è¯­å¥ä¹‹å‰å°±å¯ä»¥è®¿é—®åˆ°
>  * å€¼: undefined
>2. å‡½æ•°å£°æ˜æå‡
>  * é€šè¿‡functionå£°æ˜çš„å‡½æ•°, åœ¨ä¹‹å‰å°±å¯ä»¥ç›´æ¥è°ƒç”¨
>  * å€¼: å‡½æ•°å®šä¹‰(å¯¹è±¡)
>3. å¼•å‡ºä¸€ä¸ªé—®é¢˜: å˜é‡æå‡å’Œå‡½æ•°æå‡æ˜¯å¦‚ä½•äº§ç”Ÿçš„?
>
>```jsx
> /*
>  é¢è¯•é¢˜ : è¾“å‡º undefined
>   */
>  var a = 3
>  function fn () {
>    console.log(a)
>    var a = 4 //å˜é‡æå‡
>  }
>  fn()  //undefined
>'--------------------------------------------'
>  console.log(b) //undefined  å˜é‡æå‡
>  fn2() //å¯è°ƒç”¨  å‡½æ•°æå‡ ç»“æœä¸ºfn2()
>  // fn3() //ä¸èƒ½æ‰§è¡Œ æŠ¥é”™äº† å®é™…ä¸Šæ²¡æœ‰fn3() åªæœ‰fn3å˜é‡ å¯ä»¥console.log(fn3) å˜é‡æå‡
>  var b = 3
>  function fn2() {  console.log('fn2()') }
>  var fn3 = function () { console.log('fn3()') }
>```

### â…¡-æ‰§è¡Œä¸Šä¸‹æ–‡

>1. ä»£ç åˆ†ç±»(ä½ç½®)
>  * å…¨å±€ä»£ç 
>  * å‡½æ•°(å±€éƒ¨)ä»£ç 
>2. å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡
>  * åœ¨æ‰§è¡Œå…¨å±€ä»£ç å‰å°†windowç¡®å®šä¸ºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡
>  * å¯¹å…¨å±€æ•°æ®è¿›è¡Œé¢„å¤„ç†
>    * varå®šä¹‰çš„å…¨å±€å˜é‡==>undefined, æ·»åŠ ä¸ºwindowçš„å±æ€§
>    * functionå£°æ˜çš„å…¨å±€å‡½æ•°==>èµ‹å€¼(fun), æ·»åŠ ä¸ºwindowçš„æ–¹æ³•
>    * this==>èµ‹å€¼(window)
>  * å¼€å§‹æ‰§è¡Œå…¨å±€ä»£ç 
>3. å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡
>  * åœ¨è°ƒç”¨å‡½æ•°, å‡†å¤‡æ‰§è¡Œå‡½æ•°ä½“ä¹‹å‰, åˆ›å»ºå¯¹åº”çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡(è™šæ‹Ÿçš„, å­˜åœ¨äºæ ˆä¸­)
>  * å¯¹å±€éƒ¨æ•°æ®è¿›è¡Œé¢„å¤„ç†
>    * å½¢å‚å˜é‡==>èµ‹å€¼(å®å‚)==>æ·»åŠ ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡çš„å±æ€§
>    * `arguments`==>èµ‹å€¼(å®å‚åˆ—è¡¨), æ·»åŠ ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡çš„å±æ€§ -->[ä¸æ‡‚çš„çœ‹è¿™é‡Œ](https://developer.mozilla.org/zh-CN/docs/orphaned/Web/JavaScript/Reference/Functions/arguments)
>    * varå®šä¹‰çš„å±€éƒ¨å˜é‡==>undefined, æ·»åŠ ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡çš„å±æ€§
>    * functionå£°æ˜çš„å‡½æ•° ==>èµ‹å€¼(fun), æ·»åŠ ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡çš„æ–¹æ³•
>    * this==>èµ‹å€¼(è°ƒç”¨å‡½æ•°çš„å¯¹è±¡)
>  * å¼€å§‹æ‰§è¡Œå‡½æ•°ä½“ä»£ç 

### â…¢-æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ

>1. åœ¨å…¨å±€ä»£ç æ‰§è¡Œå‰, JSå¼•æ“å°±ä¼šåˆ›å»ºä¸€ä¸ªæ ˆæ¥å­˜å‚¨ç®¡ç†æ‰€æœ‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡
>2. åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡(window)ç¡®å®šå, å°†å…¶æ·»åŠ åˆ°æ ˆä¸­(å‹æ ˆ)-->`æ‰€ä»¥æ ˆåº•ç™¾åˆ†ç™¾æ˜¯[window]`
>3. åœ¨å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå, å°†å…¶æ·»åŠ åˆ°æ ˆä¸­(å‹æ ˆ)
>4. åœ¨å½“å‰å‡½æ•°æ‰§è¡Œå®Œå,å°†æ ˆé¡¶çš„å¯¹è±¡ç§»é™¤(å‡ºæ ˆ)
>5. å½“æ‰€æœ‰çš„ä»£ç æ‰§è¡Œå®Œå, æ ˆä¸­åªå‰©ä¸‹window
>6. `ä¸Šä¸‹æ–‡æ ˆæ•°==å‡½æ•°è°ƒç”¨æ•°+1(åªæ˜¯å‡½æ•°è°ƒç”¨ï¼Œä¸æ˜¯å‡½æ•°å®šä¹‰)`
>
>```js
>//1. è¿›å…¥å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡
>var a = 10
>var bar = function (x) {
>   var b = 5
>   foo(x + b)   //3. è¿›å…¥fooæ‰§è¡Œä¸Šä¸‹æ–‡           
> }
> var foo = function (y) {
>   var c = 5
>   console.log(a + c + y)
> }
> bar(10) //2. è¿›å…¥barå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡
>```
>
>![image-20210723183046182](image/image-20210723183046182.png)
>
>æ­¤å¤„ç”¨ä¸€ä¸ªåŠ¨æ€å›¾æ¥å±•ç¤º:
>
>![](image/æ‰§è¡Œæ ˆä¸äº‹ä»¶é˜Ÿåˆ—.gif)
>
>ä¸¾ä¸ªæ —å­:  
>
>```js
>//æ —å­
><!--
>1. ä¾æ¬¡è¾“å‡ºä»€ä¹ˆ?
> gb: undefined //gbä¸­çš„iæ˜¯undefined
> fb: 1  
> fb: 2
> fb: 3
> fe: 3
> fe: 2
> fe: 1
> ge: 1
>2. æ•´ä¸ªè¿‡ç¨‹ä¸­äº§ç”Ÿäº†å‡ ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡?  5
>-->
><script type="text/javascript">
> console.log('gb: '+ i)
> var i = 1
> foo(1)
> function foo(i) {
>   if (i == 4) {
>     return
>   }
>   console.log('fb:' + i)
>   foo(i + 1) //é€’å½’è°ƒç”¨: åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨è‡ªå·±
>   console.log('fe:' + i) //å‡ºæ ˆ æ‰€ä»¥ä¼š 3 2 1è¿™æ ·çš„ç»“æœ
> }
> console.log('ge: ' + i)
></script>
>```
>
>

### â…£-ç›¸å…³é¢è¯•é¢˜

>`å‡½æ•°æå‡ä¼˜å…ˆçº§é«˜äºå˜é‡æå‡,ä¸”ä¸ä¼šè¢«å˜é‡å£°æ˜è¦†ç›–,ä½†æ˜¯ä¼šè¢«å˜é‡èµ‹å€¼è¦†ç›–`
>
>```js
>/*
>æµ‹è¯•é¢˜1:  å…ˆæ‰§è¡Œå˜é‡æå‡, å†æ‰§è¡Œå‡½æ•°æå‡ï¼Œå‡½æ•°è¦†ç›–äº†å˜é‡çš„å€¼
>
>*/
>function a() {}
>var a
>console.log(typeof a) // 'function' 
>
>
>/*
>æµ‹è¯•é¢˜2:
>*/
>if (!(b in window)) {
>var b = 1
>}
>console.log(b) // undefined b=1è¯´æ˜æ‰§è¡Œäº†é‡Œé¢çš„ä»£ç ï¼Œbä¸ºundefinedè¯´æ˜æ²¡æœ‰æ‰§è¡Œ
>
>/*
>æµ‹è¯•é¢˜3:
>*/
>var c = 1
>function c(c) {
>console.log(c)
>var c = 3 //ä¸æ­¤è¡Œæ— å…³
>}
>c(2) // æŠ¥é”™  c is not a function
>
>å®é™…ä¸Šçš„ä»£ç æ˜¯ï¼š
>var c 
>var c
>function c(c) {
>	console.log(c)
>	c=3
>}
>c=2
>c(2)  //å®é™…ä¸Šcå·²ç»ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªåŸºç¡€æ•°æ®ç±»å‹Number c=2
>```

## 3ã€ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾

### â… -ä½œç”¨åŸŸ

>1. ç†è§£
>  * å°±æ˜¯ä¸€å—"åœ°ç›˜", ä¸€ä¸ªä»£ç æ®µæ‰€åœ¨çš„åŒºåŸŸ
>  * å®ƒæ˜¯é™æ€çš„(ç›¸å¯¹äºä¸Šä¸‹æ–‡å¯¹è±¡), åœ¨ç¼–å†™ä»£ç æ—¶å°±ç¡®å®šäº†
>2. åˆ†ç±»
>  * å…¨å±€ä½œç”¨åŸŸ
>  * å‡½æ•°ä½œç”¨åŸŸ
>  * æ²¡æœ‰å—ä½œç”¨åŸŸ(ES6æœ‰äº†)   -->(javaè¯­è¨€ä¹Ÿæœ‰)
>3. ä½œç”¨
>  * éš”ç¦»å˜é‡ï¼Œä¸åŒä½œç”¨åŸŸä¸‹åŒåå˜é‡ä¸ä¼šæœ‰å†²çª
>
>```js
>/*  //æ²¡å—ä½œç”¨åŸŸ
>  if(true) { var c = 3 }
>  console.log(c)
>  */
>  var a = 10,
>    b = 20
>  function fn(x) {
>    var a = 100, c = 300;
>    console.log('fn()', a, b, c, x) //100 20 300 10
>    function bar(x) {
>      var a = 1000, d = 400
>      console.log('bar()', a, b, c, d, x)
>    }
>    bar(100)//1000 20 300 400 100
>    bar(200)//1000 20 300 400 200
>  }
>  fn(10)
>```

### â…¡-ä½œç”¨åŸŸä¸æ‰§è¡Œä¸Šä¸‹æ–‡çš„åŒºåˆ«ä¸è”ç³»

>1. åŒºåˆ«1:
> * å…¨å±€ä½œç”¨åŸŸä¹‹å¤–ï¼Œæ¯ä¸ªå‡½æ•°éƒ½ä¼šåˆ›å»ºè‡ªå·±çš„ä½œç”¨åŸŸï¼Œ`ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šäº†ã€‚è€Œä¸æ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶`(ä¸ªæ•°ä¸ºn+1ä¸ªï¼Œnä¸ºå‡½æ•°å®šä¹‰æ•°)
> * å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸç¡®å®šä¹‹å, jsä»£ç é©¬ä¸Šæ‰§è¡Œä¹‹å‰åˆ›å»º
> * å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯åœ¨è°ƒç”¨å‡½æ•°æ—¶, å‡½æ•°ä½“ä»£ç æ‰§è¡Œä¹‹å‰åˆ›å»º
>2. åŒºåˆ«2:
> * ä½œç”¨åŸŸæ˜¯é™æ€çš„, åªè¦å‡½æ•°å®šä¹‰å¥½äº†å°±ä¸€ç›´å­˜åœ¨, ä¸”ä¸ä¼šå†å˜åŒ–
> * æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯åŠ¨æ€çš„, è°ƒç”¨å‡½æ•°æ—¶åˆ›å»º, å‡½æ•°è°ƒç”¨ç»“æŸæ—¶å°±ä¼šè‡ªåŠ¨é‡Šæ”¾
>3. è”ç³»:
> * æ‰§è¡Œä¸Šä¸‹æ–‡(å¯¹è±¡)æ˜¯ä»å±äºæ‰€åœ¨çš„ä½œç”¨åŸŸ
> * å…¨å±€ä¸Šä¸‹æ–‡ç¯å¢ƒ==>å…¨å±€ä½œç”¨åŸŸ
> * å‡½æ•°ä¸Šä¸‹æ–‡ç¯å¢ƒ==>å¯¹åº”çš„å‡½æ•°ä½¿ç”¨åŸŸ
>
>![image-20210727141319410](image/image-20210727141319410.png)

### â…¢-ä½œç”¨åŸŸé“¾

>1. ç†è§£
>  * å¤šä¸ªä¸Šä¸‹çº§å…³ç³»çš„ä½œç”¨åŸŸå½¢æˆçš„é“¾, å®ƒçš„æ–¹å‘æ˜¯ä»ä¸‹å‘ä¸Šçš„(ä»å†…åˆ°å¤–)
>  * æŸ¥æ‰¾å˜é‡æ—¶å°±æ˜¯æ²¿ç€ä½œç”¨åŸŸé“¾æ¥æŸ¥æ‰¾çš„
>2. æŸ¥æ‰¾ä¸€ä¸ªå˜é‡çš„æŸ¥æ‰¾è§„åˆ™
>  * åœ¨å½“å‰ä½œç”¨åŸŸä¸‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾å¯¹åº”çš„å±æ€§, å¦‚æœæœ‰ç›´æ¥è¿”å›, å¦åˆ™è¿›å…¥2
>  * åœ¨ä¸Šä¸€çº§ä½œç”¨åŸŸçš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾å¯¹åº”çš„å±æ€§, å¦‚æœæœ‰ç›´æ¥è¿”å›, å¦åˆ™è¿›å…¥3
>  * å†æ¬¡æ‰§è¡Œ2çš„ç›¸åŒæ“ä½œ, ç›´åˆ°å…¨å±€ä½œç”¨åŸŸ, å¦‚æœè¿˜æ‰¾ä¸åˆ°å°±æŠ›å‡ºæ‰¾ä¸åˆ°çš„å¼‚å¸¸
>
>```js
> var a = 1
>  function fn1() {
>    var b = 2
>    function fn2() {
>      var c = 3
>      console.log(c)
>      console.log(b)
>      console.log(a)
>      console.log(d)  //æŠ¥é”™ d is not defined
>    }
>    fn2()
>  }
>  fn1()
>```

### â…£-ç›¸å…³é¢è¯•é¢˜

#### â‘  `ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šäº†ã€‚è€Œä¸æ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶`

>ä½œç”¨åŸŸ1:`ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šäº†ã€‚è€Œä¸æ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶`
>
>```js
>  var x = 10;
>  function fn() { console.log(x); }
>  function show(f) {
>    var x = 20;
>    f();
>  }
>  show(fn); //è¾“å‡º10
>```
>
>![image-20210726192714660](image/image-20210726192714660.png)

#### â‘¡ å¯¹è±¡å˜é‡ä¸èƒ½äº§ç”Ÿå±€éƒ¨ä½œç”¨åŸŸ

>```js
>var fn = function () {
>  console.log(fn)
>}
>fn()  //è¾“å‡ºfn()å‡½æ•°
>
>var obj = { //å¯¹è±¡å˜é‡ä¸èƒ½äº§ç”Ÿå±€éƒ¨ä½œç”¨åŸŸ,æ‰€ä»¥ä¼šæ‰¾åˆ°å…¨å±€å»,å¯¼è‡´æŠ¥é”™
>  fn2: function () {
>   console.log(fn2)  //ç›´æ¥è¾“å‡ºfn2æ˜¯windowçš„fn2,windowsä¸Šæ²¡æœ‰fn2
>   //console.log(this.fn2)  //è¿™æ ·å­æ‰¾å°±å¯ä»¥æ‰¾åˆ°
>  }
>}
>obj.fn2()
>```

## 4ã€é—­åŒ…é¢„å¤‡çŸ¥è¯†ç‚¹æ¢³ç†

##### `é«˜é˜¶å‡½æ•°æ˜¯ä»€ä¹ˆ?`

>æ‰€è°“é«˜é˜¶å‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªå‡½æ•°å°±å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–è€…æ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°-->å¸¸è§çš„é«˜é˜¶å‡½æ•°æœ‰mapã€reduceã€filterã€sortç­‰
>
>```js
>var ADD =function add(a) {
>return function(b) {
>return a+b
>}
>}
>è°ƒç”¨ï¼šADD(2)(3)å³å¯è·å¾—ç»“æœ
>```
>
>1. map
>
>  - ```js
>    //
>    mapæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œä¸æ”¹å˜åŸæ¥çš„æ•°ç»„ï¼Œåªæ˜¯è¿”å›ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„
>    var arr = [1,2,3,4,5]
>    var arr1 = arr.map(item => item = 2)
>    //arr  è¾“å‡º[1,2,3,4,5]
>    //arr1 è¾“å‡º[2,2,2,2,2]
>    ```
>
>2. reduce
>
>  - ```js
>    //
>    reduceä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„ã€‚reduceæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¦æœ‰ä¸¤ä¸ªå½¢å‚ï¼Œä»£è¡¨æ•°ç»„ä¸­çš„å‰ä¸¤é¡¹ï¼Œreduceä¼šå°†è¿™ä¸ªå‡½æ•°çš„ç»“æœä¸æ•°ç»„ä¸­çš„ç¬¬ä¸‰é¡¹å†æ¬¡ç»„æˆè¿™ä¸ªå‡½æ•°çš„ä¸¤ä¸ªå½¢å‚ä»¥æ­¤ç±»æ¨è¿›è¡Œç´¯ç§¯æ“ä½œ
>    var arr = [1,2,3,4,5]
>    var arr2 = arr.reduce((a,b)=> a+b)
>    console.log(arr2) // 15
>    ```
>
>3. filter
>
>  - ```js
>    //
>    filterè¿”å›è¿‡æ»¤åçš„æ•°ç»„ã€‚filterä¹Ÿæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†ä½œç”¨äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œæ ¹æ®è¯¥å‡½æ•°æ¯æ¬¡æ‰§è¡Œåè¿”å›çš„å¸ƒå°”å€¼æ¥ä¿ç•™ç»“æœï¼Œå¦‚æœæ˜¯trueå°±ä¿ç•™ï¼Œå¦‚æœæ˜¯falseå°±è¿‡æ»¤æ‰ï¼ˆè¿™ç‚¹ä¸mapè¦åŒºåˆ†ï¼‰
>    var arr = [1,2,3,4,5]
>     var arr3 = arr.filter(item => item % 2 == 0)
>    console.log(arr3)// [2,4]
>    ```

## 5ã€é—­åŒ…

>ä¸€ä¸ªå‡½æ•°å’Œå¯¹å…¶å‘¨å›´çŠ¶æ€ï¼ˆ**lexical environmentï¼Œè¯æ³•ç¯å¢ƒ**ï¼‰çš„å¼•ç”¨æ†ç»‘åœ¨ä¸€èµ·ï¼ˆæˆ–è€…è¯´å‡½æ•°è¢«å¼•ç”¨åŒ…å›´ï¼‰ï¼Œè¿™æ ·çš„ç»„åˆå°±æ˜¯**é—­åŒ…**ï¼ˆ**closure**ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé—­åŒ…è®©ä½ å¯ä»¥åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä¸­è®¿é—®åˆ°å…¶å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸã€‚åœ¨ JavaScript ä¸­ï¼Œæ¯å½“åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œé—­åŒ…å°±ä¼šåœ¨å‡½æ•°åˆ›å»ºçš„åŒæ—¶è¢«åˆ›å»ºå‡ºæ¥ã€‚
>

### â… -å¼•å‡ºé—­åŒ…æ¦‚å¿µ

#### â‘  é”™è¯¯åœºæ™¯

>éœ€æ±‚: `ç‚¹å‡»æŸä¸ªæŒ‰é’®, æç¤º"ç‚¹å‡»çš„æ˜¯ç¬¬nä¸ªæŒ‰é’®"`
>
>```html
><button>æµ‹è¯•1</button>
><button>æµ‹è¯•2</button>
><button>æµ‹è¯•3</button>
><!--
>éœ€æ±‚: ç‚¹å‡»æŸä¸ªæŒ‰é’®, æç¤º"ç‚¹å‡»çš„æ˜¯ç¬¬nä¸ªæŒ‰é’®"
>-->
><script type="text/javascript">
>  var btns = document.getElementsByTagName('button')
>  //æ³¨æ„[btns]ä¸æ˜¯ä¸€ä¸ªæ•°ç»„,å®ƒæ˜¯ä¸€ä¸ªä¼ªæ•°ç»„
>  //æ¯æ¬¡è·å–[btns.length]å…¶å®éƒ½æ˜¯éœ€è¦è¿›è¡Œè®¡ç®—çš„(å› ä¸ºå®ƒæ˜¯ä¼ªæ•°ç»„)
>  //æ‰€ä»¥ä¸ºäº†æ€§èƒ½æ›´å¥½,åœ¨æ­¤å¤„èµ‹å€¼,å°±åªéœ€è¦è®¡ç®—ä¸€æ¬¡
>  for (var i = 0,length=btns.length; i < length; i++) {
>    var btn = btns[i]
>    btn.onclick = function () {  //éå†åŠ ç›‘å¬
>      alert('ç¬¬'+(i+1)+'ä¸ª')     //ç»“æœ å…¨æ˜¯[4]
>    }
>  }
></script>    
>```
>
>æ­¤å¤„é”™è¯¯æ˜¯,ç›´æ¥ä¿®æ”¹å¹¶ä½¿ç”¨å…¨å±€å˜é‡[`i`],å¯¼è‡´forå¾ªç¯ç»“æŸå,æ‰€æœ‰ç‚¹å‡»æŒ‰é’®ç»‘å®šçš„å¼¹çª—å€¼éƒ½æ˜¯[`i+1`]
>
>éšåè°ƒç”¨æ—¶,éƒ½ä¼šæ‰¾åˆ°[`i`]è¿™ä¸ªå˜é‡,ä½†æ˜¯æ­¤æ—¶i==3,æ‰€ä»¥æ‰€æœ‰ç»“æœéƒ½æ˜¯4
>
>![image-20210727143351376](image/image-20210727143351376.png) 

#### â‘¡ å°†å˜é‡æŒ‚è½½åˆ°è‡ªèº«æ¥è§£å†³

>è§£å†³æ–¹å¼:å°†btnæ‰€å¯¹åº”çš„ä¸‹æ ‡ä¿å­˜åœ¨btnä¸Š
>
>```js
><button>æµ‹è¯•1</button>
><button>æµ‹è¯•2</button>
><button>æµ‹è¯•3</button>
><!--
>éœ€æ±‚: ç‚¹å‡»æŸä¸ªæŒ‰é’®, æç¤º"ç‚¹å‡»çš„æ˜¯ç¬¬nä¸ªæŒ‰é’®"
>-->
><script type="text/javascript">
>  var btns = document.getElementsByTagName('button')
>  for (var i = 0,length=btns.length; i < length; i++) {
>    var btn = btns[i]
>    //å°†btnæ‰€å¯¹åº”çš„ä¸‹æ ‡ä¿å­˜åœ¨btnä¸Š
>    btn.index = i
>    btn.onclick = function () {  //éå†åŠ ç›‘å¬
>      alert('ç¬¬'+(i+1)+'ä¸ª')     //ç»“æœ å…¨æ˜¯[4]
>    }
>  }
></script>    
>```
>
>å°†å…¶æ”¾åœ¨è‡ªå·±çš„èº«ä¸Š,éœ€è¦æ—¶è‡ªå·±æ‰¾è‡ªå·±æ‹¿,è¿™æ ·å°±èƒ½è§£å†³
>
>![image-20210727143824641](image/image-20210727143824641.png)

#### â‘¢ åˆ©ç”¨é—­åŒ…
>
>```js
><body>
><button>æµ‹è¯•1</button>
><button>æµ‹è¯•2</button>
><button>æµ‹è¯•3</button>
>
><script type="text/javascript">
>  //åˆ©ç”¨é—­åŒ…
>  for (var i = 0,length=btns.length; i < length; i++) {
>     //æ­¤å¤„çš„jæ˜¯å±€éƒ¨çš„,å®ƒå°†ä¼ å…¥çš„[i]å­˜å…¥å±€éƒ¨çš„[j]ä¸­,è¿™æ ·å°±èƒ½å®ç°æ•ˆæœ 
>    (function (j) {
>      var btn = btns[j]
>      btn.onclick = function () {
>        alert('ç¬¬'+(j+1)+'ä¸ª')
>      }
>    })(i)
>  }
></script>  
></body>
>```
>
>![image-20210727143824641](image/image-20210727143824641.png)

### â…¡-å¦‚ä½•äº§ç”Ÿé—­åŒ…
 > å½“ä¸€ä¸ªåµŒå¥—çš„å†…éƒ¨(å­)å‡½æ•°å¼•ç”¨äº†åµŒå¥—çš„å¤–éƒ¨(çˆ¶)å‡½æ•°çš„å˜é‡(å‡½æ•°)æ—¶ï¼Œå°±äº§ç”Ÿäº†é—­åŒ…
>
> é—­åŒ…çš„ç†è§£ï¼š
> ç†è§£ä¸€ï¼šé—­åŒ…æ˜¯åµŒå¥—çš„å†…éƒ¨å‡½æ•°
> ç†è§£äºŒï¼šåŒ…å«è¢«å¼•ç”¨å˜é‡(å‡½æ•°)çš„å¯¹è±¡
> ps:é—­åŒ…å­˜åœ¨äºåµŒå¥—çš„å†…éƒ¨å‡½æ•°ä¸­
>
> äº§ç”Ÿé—­åŒ…çš„æ¡ä»¶ï¼š
> å‡½æ•°åµŒå¥—
> å†…éƒ¨å‡½æ•°å¼•ç”¨äº†å¤–éƒ¨å‡½æ•°çš„æ•°æ®(å˜é‡/å‡½æ•°)
> ```js
> function fn1(){
> 	var a = 2
> 	var b = 'abc'
> 	function fn2(){ 
>         //ps:å¦‚æœæ˜¯var fn2 = function(){}åˆ™ä¸ä¼šäº§ç”Ÿé—­åŒ…ï¼Œå› ä¸ºæ‰§è¡Œå‡½æ•°å®šä¹‰æ‰ä¼šäº§ç”Ÿé—­åŒ…(ä¸ç”¨è°ƒç”¨å†…éƒ¨å‡½æ•°)
> 	console.log(a)
> 	}
> }
> fn1()
> ```
### â…¢-å¸¸è§çš„é—­åŒ…

#### â‘  å°†å‡½æ•°ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼

>```js
>// 1. å°†å‡½æ•°ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼
>  function fn1() {
>    var a = 2
>    function fn2() {
>      a++
>      console.log(a)
>    }
>    return fn2
>  }
>  var f = fn1()
>  f() // 3
>  f() // 4
>```

#### â‘¡ å°†å‡½æ•°ä½œä¸ºå®å‚ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨

>```js
>// 2. å°†å‡½æ•°ä½œä¸ºå®å‚ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨
>  function showDelay(msg, time) {
>    setTimeout(function () {
>      alert(msg)
>    }, time)
>  }
>  showDelay('atguigu', 2000)
>```

#### â‘¢ é«˜é˜¶å‡½æ•°ä¸æŸ¯é‡ŒåŒ–

>æœ‰æ—¶å€™é—­åŒ…åœ¨ä½ ç”šè‡³æ²¡æœ‰æ³¨æ„åˆ°å®ƒçš„æ—¶å€™å°±ä¼šå‡ºç°ï¼Œä½ å¯èƒ½å·²ç»çœ‹åˆ°äº†æˆ‘ä»¬ç§°ä¸ºéƒ¨åˆ†åº”ç”¨ç¨‹åºçš„ç¤ºä¾‹
>
>å½“ç„¶å¦‚æœä½ è¿˜ä¸ç†è§£çš„è¯å¯ä»¥,å¯ä»¥å®Œæ•´çš„å¤šçœ‹å‡ æ¬¡æœ¬ç¬”è®°é—­åŒ…çŸ¥è¯†ç‚¹éƒ¨åˆ†,æˆ–è€…ç»“åˆä¸Šæ–¹[ `â…¡-ä¸¾ä¸ªé—­åŒ…æ —å­åˆ†æç†è§£` ](#â…¡-ä¸¾ä¸ªé—­åŒ…æ —å­åˆ†æç†è§£)è¿›è¡Œç†è§£

##### 1ã€ä» ES6 é«˜é˜¶ç®­å¤´å‡½æ•°ç†è§£å‡½æ•°æŸ¯é‡ŒåŒ–(`è¿ç”¨åˆ°é—­åŒ…`)

>1. é¦–å…ˆçœ‹åˆ°äº†è¿™æ ·çš„ä¸€ä¸ªä¾‹å­ï¼š
>
>  ```js
>let add = a => b => a + b
>  ```
>
>2. ä»¥ä¸Šæ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç›¸åŠ å‡½æ•°ï¼ŒæŠŠå®ƒè½¬åŒ–æˆ ES5 çš„å†™æ³•å¦‚ä¸‹
>
>  ```js
>function add(a) {
>      return function(b) {
>          return a + b
>      }
>  }
>  var add3 = add(3) //add3è¡¨ç¤ºä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„å˜é‡ å¯ä»¥å½“æˆå‡½æ•°è°ƒç”¨åæ¥ç”¨
>  add3(4) === 3 + 4 //true
>  ```
>
>3. å†ç®€åŒ–ä¸€ä¸‹ï¼Œå¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š
>
>  ```js
>let add = function(a) {
>    var param = a;
>    var innerFun = function(b) {
>        return param + b;
>    }
>    return innerFun;
>}
>  ```
>
>4. è™½ç„¶å¥½åƒæ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶ä¸Šè¿°ä½¿ç”¨äº†[`é—­åŒ…`]ï¼Œè€Œä¸”è¯¥å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å…¶å®ï¼Œè¿™å°±æ˜¯`é«˜é˜¶å‡½æ•°çš„å®šä¹‰ï¼šä»¥å‡½æ•°ä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼æ˜¯å‡½æ•°çš„å‡½æ•°ã€‚`
>
>  ![image-20210415160945789](image/image-20210415160945789.png)

##### 2ã€æŸ¯é‡ŒåŒ–

>1. å›¾ä¾‹:
>
>  ![image-20210415161137977](image/image-20210415161137977.png)
>
>2. å…³é”®å°±æ˜¯`ç†è§£æŸ¯é‡ŒåŒ–`ï¼Œå…¶å®å¯ä»¥æŠŠå®ƒç†è§£æˆï¼ŒæŸ¯é‡ŒåŒ–åï¼Œ`å°†ç¬¬ä¸€ä¸ªå‚æ•°å˜é‡å­˜åœ¨å‡½æ•°é‡Œé¢äº†(é—­åŒ…)`ï¼Œç„¶åæœ¬æ¥éœ€è¦nä¸ªå‚æ•°çš„å‡½æ•°å¯ä»¥å˜æˆåªéœ€è¦å‰©ä¸‹çš„ï¼ˆn - 1ä¸ªï¼‰å‚æ•°å°±å¯ä»¥è°ƒç”¨ï¼Œæ¯”å¦‚
>
>  ```js
>let add = x => y => x + y
>let add2 = add(2)
>-*----------------------------------
>æœ¬æ¥å®Œæˆ add è¿™ä¸ªæ“ä½œï¼Œåº”è¯¥æ˜¯è¿™æ ·è°ƒç”¨
>let add = (x, y) => x + y
>add(2,3)
>----------------------------------
>1. è€Œç°åœ¨ add2 å‡½æ•°å®ŒæˆåŒæ ·æ“ä½œåªéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œè¿™åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­å¹¿æ³›åº”ç”¨ã€‚
>let add = x => y => x + y
>let add2 = add(2)
>2.è¯¦ç»†è§£é‡Šä¸€ä¸‹ï¼Œå°±æ˜¯ add2 å‡½æ•° ç­‰ä»·äº æœ‰äº† x è¿™ä¸ªé—­åŒ…å˜é‡çš„ y => x + y å‡½æ•°,å¹¶ä¸”æ­¤æ—¶ x = 2ï¼Œæ‰€ä»¥æ­¤æ—¶è°ƒç”¨
>add2(3) === 2 + 3
>  ```

##### 4ã€æ€»ç»“

>1. å¦‚æœæ˜¯`a => b => c => {xxx}`è¿™ç§å¤šæ¬¡æŸ¯é‡ŒåŒ–çš„,å¦‚ä½•ç†è§£?
>
>  ç†è§£:å‰` n - 1 `æ¬¡è°ƒç”¨ï¼Œå…¶å®æ˜¯æå‰å°†å‚æ•°ä¼ é€’è¿›å»ï¼Œå¹¶æ²¡æœ‰è°ƒç”¨æœ€å†…å±‚å‡½æ•°ä½“ï¼Œæœ€åä¸€æ¬¡è°ƒç”¨æ‰ä¼šè°ƒç”¨æœ€å†…å±‚å‡½æ•°ä½“ï¼Œå¹¶è¿”å›æœ€å†…å±‚å‡½æ•°ä½“çš„è¿”å›å€¼
>
>2. ç»“åˆä¸Šæ–‡å¯çŸ¥ï¼Œè¿™é‡Œçš„å¤šä¸ªè¿ç»­ç®­å¤´ï¼ˆæ— è®ºä¿©ä¸ªç®­å¤´å‡½æ•°ä¸‰ä¸ªåŠä»¥ä¸Šï¼‰å‡½æ•°è¿åœ¨ä¸€èµ· å°±æ˜¯åœ¨æŸ¯é‡ŒåŒ–ã€‚æ‰€ä»¥è¿ç»­ç®­å¤´å‡½æ•°å°±æ˜¯å¤šæ¬¡æŸ¯é‡ŒåŒ–å‡½æ•°çš„ es6 å†™æ³•ã€‚
>
>3. `è°ƒç”¨ç‰¹ç‚¹`:let test = a => b => c => {xxx}
>
>  æ¯”å¦‚å¯¹äºä¸Šé¢çš„ `test` å‡½æ•°ï¼Œå®ƒæœ‰ 3 ä¸ªç®­å¤´ï¼Œ è¿™ä¸ªå‡½æ•°è¦è¢«è°ƒç”¨ 3 æ¬¡ `test(a)(b)(c)`ï¼Œå‰ä¸¤æ¬¡è°ƒç”¨åªæ˜¯åœ¨ä¼ é€’å‚æ•°ï¼Œåªæœ‰æœ€åä¾æ¬¡è°ƒç”¨æ‰ä¼šè¿”å› `{xxx}` ä»£ç æ®µçš„è¿”å›å€¼ï¼Œå¹¶ä¸”åœ¨ `{xxx}` ä»£ç æ®µä¸­å¯ä»¥è°ƒç”¨ a,b,c

### â…£-é—­åŒ…çš„ä½œç”¨

>1. ä½¿ç”¨å‡½æ•°å†…éƒ¨çš„å˜é‡åœ¨å‡½æ•°æ‰§è¡Œå®Œå, ä»ç„¶å­˜æ´»åœ¨å†…å­˜ä¸­(å»¶é•¿äº†å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ)
>2. è®©å‡½æ•°å¤–éƒ¨å¯ä»¥æ“ä½œ(è¯»å†™)åˆ°å‡½æ•°å†…éƒ¨çš„æ•°æ®(å˜é‡/å‡½æ•°)
>
>é—®é¢˜:
>    1. å‡½æ•°æ‰§è¡Œå®Œå, å‡½æ•°å†…éƒ¨å£°æ˜çš„å±€éƒ¨å˜é‡æ˜¯å¦è¿˜å­˜åœ¨? 
>         -  ä¸€èˆ¬æ˜¯ä¸å­˜åœ¨, å­˜åœ¨äºé—­ä¸­çš„å˜é‡æ‰å¯èƒ½å­˜åœ¨
>    2. åœ¨å‡½æ•°å¤–éƒ¨èƒ½ç›´æ¥è®¿é—®å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡å—? 
>         - ä¸èƒ½, ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡é—­åŒ…è®©å¤–éƒ¨æ“ä½œå®ƒ

### â…¤-é—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸ

>1. äº§ç”Ÿ: åœ¨åµŒå¥—å†…éƒ¨å‡½æ•°å®šä¹‰æ‰§è¡Œå®Œæ—¶å°±äº§ç”Ÿäº†(ä¸æ˜¯åœ¨è°ƒç”¨)
>2. æ­»äº¡: åœ¨åµŒå¥—çš„å†…éƒ¨å‡½æ•°æˆä¸ºåƒåœ¾å¯¹è±¡æ—¶
>   - å³æ²¡æœ‰äººæŒ‡å‘å®ƒæ—¶æ­»äº¡,é€šå¸¸ç½®ä¸º[`null`],å½“ç„¶æŒ‡å‘å…¶ä»–ä¹Ÿè¡Œ,ä½†ä¸å®‰å…¨(å®¹æ˜“æ±¡æŸ“å˜é‡)
>
>```js
>//é—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸ
>function fn1() {
>    //æ­¤æ—¶é—­åŒ…å°±å·²ç»äº§ç”Ÿäº†(å‡½æ•°æå‡,å®é™…ä¸Š[fn2]æå‡åˆ°äº†ç¬¬ä¸€è¡Œ, å†…éƒ¨å‡½æ•°å¯¹è±¡å·²ç»åˆ›å»ºäº†)
>    var a = 2
>    function fn2 () { //å¦‚æœæ—¶[let fn2=function(){}],é‚£ä¹ˆåœ¨è¿™è¡Œæ‰ä¼šäº§ç”Ÿé—­åŒ…
>      a++
>      console.log(a)
>    }
>    return fn2
>  }
>  var f = fn1()
>  f() // 3
>  f() // 4
>  f = null //é—­åŒ…æ­»äº¡(åŒ…å«é—­åŒ…çš„å‡½æ•°å¯¹è±¡æˆä¸ºåƒåœ¾å¯¹è±¡)
>```

### â…¥-é—­åŒ…çš„åº”ç”¨

>é—­åŒ…çš„åº”ç”¨ : å®šä¹‰JSæ¨¡å—
>  * å…·æœ‰ç‰¹å®šåŠŸèƒ½çš„jsæ–‡ä»¶
>  * å°†æ‰€æœ‰çš„æ•°æ®å’ŒåŠŸèƒ½éƒ½å°è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨(ç§æœ‰çš„)
>  * åªå‘å¤–æš´éœ²ä¸€ä¸ªåŒ…ä¿¡nä¸ªæ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°
>  * æ¨¡å—çš„ä½¿ç”¨è€…, åªéœ€è¦é€šè¿‡æ¨¡å—æš´éœ²çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•æ¥å®ç°å¯¹åº”çš„åŠŸèƒ½
>
>1. æ¨¡å—å®šä¹‰:
>
>   - ```js
>     //myModule.js
>     function myModule() {
>       //ç§æœ‰æ•°æ®
>       var msg = 'My atguigu'
>       //æ“ä½œæ•°æ®çš„å‡½æ•°
>       function doSomething() {
>         console.log('doSomething() '+msg.toUpperCase())
>       }
>       function doOtherthing () {
>         console.log('doOtherthing() '+msg.toLowerCase())
>       }
>                                                 
>       //å‘å¤–æš´éœ²å¯¹è±¡(ç»™å¤–éƒ¨ä½¿ç”¨çš„æ–¹æ³•)
>       return {
>         doSomething: doSomething,
>         doOtherthing: doOtherthing
>       }
>     }
>                                                 
>     -----------------------------------------------------------------
>     // myModule2.js   
>     (function () {
>       //ç§æœ‰æ•°æ®
>       var msg = 'My atguigu'
>       //æ“ä½œæ•°æ®çš„å‡½æ•°
>       function doSomething() {
>         console.log('doSomething() '+msg.toUpperCase())
>       }
>       function doOtherthing () {
>         console.log('doOtherthing() '+msg.toLowerCase())
>       }
>                                                 
>       //å‘å¤–æš´éœ²å¯¹è±¡(ç»™å¤–éƒ¨ä½¿ç”¨çš„æ–¹æ³•)
>       window.myModule2 = {
>         doSomething: doSomething,
>         doOtherthing: doOtherthing
>       }
>     })()    
>                                                     
>     ```
>
>2. æ¨¡å—è°ƒç”¨
>
>   - ```js
>     //è°ƒç”¨ç¤ºä¾‹
>     ------------  æ¨¡å—è°ƒç”¨1 --------------------------------------------
>     <script type="text/javascript" src="myModule.js"></script>
>     <script type="text/javascript">
>       var module = myModule()
>       module.doSomething()
>       module.doOtherthing()
>     </script>
>     ------------  æ¨¡å—è°ƒç”¨2 --------------------------------------------
>     <script type="text/javascript" src="myModule2.js"></script>
>     <script type="text/javascript">
>       myModule2.doSomething()
>       myModule2.doOtherthing()
>     </script>
>     ```

### â…¦-é—­åŒ…çš„ç¼ºç‚¹åŠè§£å†³

>1. ç¼ºç‚¹:
>  * å‡½æ•°æ‰§è¡Œå®Œå, å‡½æ•°å†…çš„å±€éƒ¨å˜é‡æ²¡æœ‰é‡Šæ”¾, å ç”¨å†…å­˜æ—¶é—´ä¼šå˜é•¿
>  * å®¹æ˜“é€ æˆå†…å­˜æ³„éœ²
>2. è§£å†³:
>  * èƒ½ä¸ç”¨é—­åŒ…å°±ä¸ç”¨
>
>  * åŠæ—¶é‡Šæ”¾
>
>  * ```js
>    function fn1() {
>      var arr = new Array(100000)
>      function fn2() {
>        console.log(arr.length)
>      }
>      return fn2
>    }
>    var f = fn1()
>    f()
>    f = null //è®©å†…éƒ¨å‡½æ•°æˆä¸ºåƒåœ¾å¯¹è±¡-->å›æ”¶é—­åŒ…
>    ```
>
>æˆ‘è¿˜æœ‰ä¸€ä¸ªè§£å†³æ–¹å¼,è°ƒç”¨æ—¶ç›´æ¥`f()()`ç›´æ¥è¿è¡Œè°ƒç”¨å³å¯-->åŒ¿åå‡½æ•°,ç”¨å®Œè‡ªåŠ¨å°±é”€æ¯äº†
>
>![image-20210727191229838](image/image-20210727191229838.png)

### â…§-å†…å­˜æº¢å‡ºä¸å†…å­˜æ³„éœ²

>1. å†…å­˜æº¢å‡º
>  * ä¸€ç§ç¨‹åºè¿è¡Œå‡ºç°çš„é”™è¯¯
>  * å½“ç¨‹åºè¿è¡Œéœ€è¦çš„å†…å­˜è¶…è¿‡äº†å‰©ä½™çš„å†…å­˜æ—¶, å°±å‡ºæŠ›å‡ºå†…å­˜æº¢å‡ºçš„é”™è¯¯
>2. å†…å­˜æ³„éœ²
>  * å ç”¨çš„å†…å­˜æ²¡æœ‰åŠæ—¶é‡Šæ”¾
>  * `å†…å­˜æ³„éœ²ç§¯ç´¯å¤šäº†å°±å®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡º`
>  * å¸¸è§çš„å†…å­˜æ³„éœ²:
>    * æ„å¤–çš„å…¨å±€å˜é‡
>    * æ²¡æœ‰åŠæ—¶æ¸…ç†çš„è®¡æ—¶å™¨æˆ–å›è°ƒå‡½æ•°
>    * é—­åŒ…
>
>```js
><script type="text/javascript">
>  // 1. å†…å­˜æº¢å‡º
>  var obj = {}
>  for (var i = 0; i < 10000; i++) {
>    obj[i] = new Array(10000000)
>    console.log('-----')
>  }
>
>  // 2. å†…å­˜æ³„éœ²
>    // æ„å¤–çš„å…¨å±€å˜é‡
>  function fn() {
>    a = new Array(10000000)  //ä¸ä½¿ç”¨var let constå»æ‰¿æ¥
>    console.log(a)
>  }
>  fn()
>
>   // æ²¡æœ‰åŠæ—¶æ¸…ç†çš„è®¡æ—¶å™¨æˆ–å›è°ƒå‡½æ•°
>  var intervalId = setInterval(function () { //å¯åŠ¨å¾ªç¯å®šæ—¶å™¨åä¸æ¸…ç†
>    console.log('----')
>  }, 1000)
>
>  // clearInterval(intervalId)
>
>    // é—­åŒ…
>  function fn1() {
>    var a = 4
>    function fn2() {
>      console.log(++a)
>    }
>    return fn2
>  }
>  var f = fn1()
>  f()
>  // f = null
>
></script>
>```
>
>ä¸ä½¿ç”¨let const varç­‰å»å£°æ˜,å®é™…ä¸Šæ˜¯æŒ‚è½½åˆ°[`window`]ä¸Šçš„,æ‰€ä»¥å¯¼è‡´å†…å­˜æ³„éœ²![image-20210727193110329](image/image-20210727193110329.png)

### â…¨-ç›¸å…³é¢è¯•é¢˜1

>```js
>//ä»£ç ç‰‡æ®µä¸€  -->æ²¡æœ‰äº§ç”Ÿé—­åŒ…:å› ä¸ºå†…éƒ¨å‡½æ•°æ²¡æœ‰è°ƒç”¨å¤–éƒ¨å˜é‡
>var name = "The Window";
>var object = {
>  name : "My Object",
>  getNameFunc : function(){
>    return function(){
>      return this.name;
>    };
>  }
>};
>alert(object.getNameFunc()());  //?  the window
>//å‡½æ•°ä½“çš„thisæ˜¯window
>
>//ä»£ç ç‰‡æ®µäºŒ
>var name2 = "The Window";
>var object2 = {
>  name2 : "My Object",
>  getNameFunc : function(){
>  //æ­¤å¤„çš„thisæŒ‡å‘æ˜¯[getNameFunc],ä»–æ˜¯å¯¹è±¡ä¸­çš„å±æ€§,æ‰€ä»¥thisæŒ‡å‘å°±æ˜¯object
>    var that = this;
>    return function(){
>      //æ­¤å¤„ç”¨çš„æ˜¯ä¿å­˜çš„  that
>      return that.name2;
>    };
>  }
>};
>alert(object2.getNameFunc()()); //?  my object
>```
>
>1. ä»£ç ç‰‡æ®µä¸€:
>   - å‡½æ•°ä½“çš„`this`æŒ‡å‘æ˜¯[`window`]
>   - æ²¡æœ‰äº§ç”Ÿé—­åŒ…:å› ä¸ºå†…éƒ¨å‡½æ•°æ²¡æœ‰è°ƒç”¨å¤–éƒ¨å˜é‡
>2. ä»£ç ç‰‡æ®µäºŒä¸ºä½•æŒ‡å‘æ˜¯å¯¹è±¡?
>   - thisæŒ‡å‘æ˜¯è°ƒç”¨å®ƒçš„[`getNameFunc`],ä»–æ˜¯å¯¹è±¡ä¸­çš„å±æ€§,æ‰€ä»¥thisæŒ‡å‘å°±æ˜¯object
>   - äº§ç”Ÿäº†é—­åŒ…

### â…©-ç›¸å…³é¢è¯•é¢˜2

>```js
>function fun(n,o) {
>  console.log(o)
>  return {
>    fun:function(m){
>      return fun(m,n)
>    }
>  }
>}
>var a = fun(0) //undefined
>a.fun(1)  //0
>a.fun(2)  //0	
>a.fun(3)  //0
>
>var b = fun(0).fun(1).fun(2).fun(3) //undefined 0 1 2
>
>var c = fun(0).fun(1) //undefined  0
>c.fun(2)//1 -->ç»è¿‡ä¸Šæ–¹å®šä¹‰å nå›ºå®šä¸º1
>c.fun(3)//1 -->æ­¤å¤„æ˜¯é™·é˜±!!!  ä¸€ç›´æ²¡æœ‰æ”¹åˆ°n,æ‰€ä»¥ä¸€ç›´æ˜¯1
>```

# ä¸‰ã€é¢å‘å¯¹è±¡é«˜çº§

>æ­¤éƒ¨åˆ†è¦æ±‚ä½ å¯¹å‰æ–¹[å‡½æ•°é«˜çº§éƒ¨åˆ†çš„1ã€åŸå‹ä¸åŸå‹é“¾](#1ã€åŸå‹ä¸åŸå‹é“¾)æ¯”è¾ƒç†Ÿæ‚‰,å¦‚æœæŒæ¡ä¸å¤Ÿå¥½ç†è§£ä¼šç›¸å¯¹å›°éš¾

## 1ã€å¯¹è±¡åˆ›å»ºæ¨¡å¼

### â… -Objectæ„é€ å‡½æ•°æ¨¡å¼

>æ–¹å¼ä¸€: Objectæ„é€ å‡½æ•°æ¨¡å¼
>  * å¥—è·¯: å…ˆåˆ›å»ºç©ºObjectå¯¹è±¡, å†åŠ¨æ€æ·»åŠ å±æ€§/æ–¹æ³•
>  * é€‚ç”¨åœºæ™¯: èµ·å§‹æ—¶ä¸ç¡®å®šå¯¹è±¡å†…éƒ¨æ•°æ®
>  * é—®é¢˜: è¯­å¥å¤ªå¤š
>
>```js
>/*ä¸€ä¸ªäºº: name:"Tom", age: 12*/
>// å…ˆåˆ›å»ºç©ºObjectå¯¹è±¡
>  var p = new Object()
>  p = {} //æ­¤æ—¶å†…éƒ¨æ•°æ®æ˜¯ä¸ç¡®å®šçš„
>  // å†åŠ¨æ€æ·»åŠ å±æ€§/æ–¹æ³•
>  p.name = 'Tom'
>  p.age = 12
>  p.setName = function (name) {
>    this.name = name
>  }
>
>  //æµ‹è¯•
>  console.log(p.name, p.age)
>  p.setName('Bob')
>  console.log(p.name, p.age)
>```

### â…¡-å¯¹è±¡å­—é¢é‡æ¨¡å¼

>æ–¹å¼äºŒ: å¯¹è±¡å­—é¢é‡æ¨¡å¼
>  * å¥—è·¯: ä½¿ç”¨{}åˆ›å»ºå¯¹è±¡, åŒæ—¶æŒ‡å®šå±æ€§/æ–¹æ³•
>  * é€‚ç”¨åœºæ™¯: èµ·å§‹æ—¶å¯¹è±¡å†…éƒ¨æ•°æ®æ˜¯ç¡®å®šçš„
>  * é—®é¢˜: å¦‚æœåˆ›å»ºå¤šä¸ªå¯¹è±¡, æœ‰é‡å¤ä»£ç 
>
>```js
>//å¯¹è±¡å­—é¢é‡æ¨¡å¼
>var p = {
>    name: 'Tom',
>    age: 12,
>    setName: function (name) {
>      this.name = name
>    }
>  }
>  //æµ‹è¯•
>  console.log(p.name, p.age)
>  p.setName('JACK')
>  console.log(p.name, p.age)
>
>  var p2 = {  //å¦‚æœåˆ›å»ºå¤šä¸ªå¯¹è±¡ä»£ç å¾ˆé‡å¤
>    name: 'Bob',
>    age: 13,
>    setName: function (name) {
>      this.name = name
>    }
>  }
>```

### â…¢-å·¥å‚æ¨¡å¼

>æ–¹å¼ä¸‰: å·¥å‚æ¨¡å¼
>  * å¥—è·¯: é€šè¿‡å·¥å‚å‡½æ•°åŠ¨æ€åˆ›å»ºå¯¹è±¡å¹¶è¿”å›
>  * é€‚ç”¨åœºæ™¯: éœ€è¦åˆ›å»ºå¤šä¸ªå¯¹è±¡
>  * é—®é¢˜: `å¯¹è±¡æ²¡æœ‰ä¸€ä¸ªå…·ä½“çš„ç±»å‹`, éƒ½æ˜¯Objectç±»å‹
>
>```js
>//è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å‡½æ•°===>å·¥å‚å‡½æ•°
>function createPerson(name, age) { 
>  var obj = {
>    name: name,
>    age: age,
>    setName: function (name) {
>      this.name = name
>    }
>  }
>  return obj
>}
>
>// åˆ›å»º2ä¸ªäºº
>var p1 = createPerson('Tom', 12)
>var p2 = createPerson('Bob', 13)
>
>// p1/p2æ˜¯Objectç±»å‹
>
>function createStudent(name, price) {
>  var obj = {
>    name: name,
>    price: price
>  }
>  return obj
>}
>var s = createStudent('å¼ ä¸‰', 12000)
>// sä¹Ÿæ˜¯Object
>```

### â…£-è‡ªå®šä¹‰æ„é€ å‡½æ•°æ¨¡å¼

>æ–¹å¼å››: è‡ªå®šä¹‰æ„é€ å‡½æ•°æ¨¡å¼
>  * å¥—è·¯: è‡ªå®šä¹‰æ„é€ å‡½æ•°, é€šè¿‡newåˆ›å»ºå¯¹è±¡
>  * é€‚ç”¨åœºæ™¯: éœ€è¦åˆ›å»ºå¤šä¸ª`ç±»å‹ç¡®å®š`çš„å¯¹è±¡,ä¸ä¸Šæ–¹å·¥å‚æ¨¡å¼æœ‰æ‰€å¯¹æ¯”
>  * é—®é¢˜: æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç›¸åŒçš„æ•°æ®, æµªè´¹å†…å­˜
>
>```js
>//å®šä¹‰ç±»å‹
>function Person(name, age) {
>  this.name = name
>  this.age = age
>  this.setName = function (name) {
>    this.name = name
>  }
>}
>var p1 = new Person('Tom', 12)
>p1.setName('Jack')
>console.log(p1.name, p1.age)
>console.log(p1 instanceof Person)
>
>function Student (name, price) {
>  this.name = name
>  this.price = price
>}
>var s = new Student('Bob', 13000)
>console.log(s instanceof Student)
>
>var p2 = new Person('JACK', 23)
>console.log(p1, p2)
>```

### â…¤-æ„é€ å‡½æ•°+åŸå‹çš„ç»„åˆæ¨¡å¼

>æ–¹å¼å…­: æ„é€ å‡½æ•°+åŸå‹çš„ç»„åˆæ¨¡å¼-->`æœ€å¥½ç”¨è¿™ä¸ªå†™æ³•`
>  * å¥—è·¯: è‡ªå®šä¹‰æ„é€ å‡½æ•°, å±æ€§åœ¨å‡½æ•°ä¸­åˆå§‹åŒ–, æ–¹æ³•æ·»åŠ åˆ°åŸå‹ä¸Š
>  * é€‚ç”¨åœºæ™¯: éœ€è¦`åˆ›å»ºå¤šä¸ªç±»å‹ç¡®å®š`çš„å¯¹è±¡
>  * æ”¾åœ¨åŸå‹ä¸Šå¯ä»¥èŠ‚çœç©ºé—´(åªéœ€è¦åŠ è½½ä¸€éæ–¹æ³•)
>
>```js
>//åœ¨æ„é€ å‡½æ•°ä¸­åªåˆå§‹åŒ–ä¸€èˆ¬å‡½æ•°
>function Person(name, age) { 
>  this.name = name
>  this.age = age
>}
>Person.prototype.setName = function (name) {
>  this.name = name
>}
>
>var p1 = new Person('Tom', 23)
>var p2 = new Person('Jack', 24)
>console.log(p1, p2)
>```

## 2ã€ç»§æ‰¿æ¨¡å¼

### â… -åŸå‹é“¾ç»§æ‰¿

>æ–¹å¼1: åŸå‹é“¾ç»§æ‰¿
>
>      1. å¥—è·¯
>         - å®šä¹‰çˆ¶ç±»å‹æ„é€ å‡½æ•°
>         - ç»™çˆ¶ç±»å‹çš„åŸå‹æ·»åŠ æ–¹æ³•
>         - å®šä¹‰å­ç±»å‹çš„æ„é€ å‡½æ•°
>         - åˆ›å»ºçˆ¶ç±»å‹çš„å¯¹è±¡èµ‹å€¼ç»™å­ç±»å‹çš„åŸå‹
>         - `å°†å­ç±»å‹åŸå‹çš„æ„é€ å±æ€§è®¾ç½®ä¸ºå­ç±»å‹`-->æ­¤å¤„æœ‰ç–‘æƒ‘çš„å¯ä»¥çœ‹æœ¬ç¬”è®°[å‡½æ•°é«˜çº§éƒ¨åˆ†çš„1ã€åŸå‹ä¸åŸå‹é“¾](#1ã€åŸå‹ä¸åŸå‹é“¾)
>         - ç»™å­ç±»å‹åŸå‹æ·»åŠ æ–¹æ³•
>         - åˆ›å»ºå­ç±»å‹çš„å¯¹è±¡: å¯ä»¥è°ƒç”¨çˆ¶ç±»å‹çš„æ–¹æ³•
>      2. å…³é”®
>         - `å­ç±»å‹çš„åŸå‹ä¸ºçˆ¶ç±»å‹çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡`
>
>```js
>//çˆ¶ç±»å‹
>function Supper() {
> this.supProp = 'çˆ¶äº²çš„åŸå‹é“¾'
>}
>//ç»™çˆ¶ç±»å‹çš„åŸå‹ä¸Šå¢åŠ ä¸€ä¸ª[showSupperProp]æ–¹æ³•,æ‰“å°è‡ªèº«subProp
>Supper.prototype.showSupperProp = function () {
> console.log(this.supProp)
>}
>
>//å­ç±»å‹
>function Sub() {
> this.subProp = 'å„¿å­çš„åŸå‹é“¾'
>}
>
>// å­ç±»å‹çš„åŸå‹ä¸ºçˆ¶ç±»å‹çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡
>Sub.prototype = new Supper()
>// è®©å­ç±»å‹çš„åŸå‹çš„constructoræŒ‡å‘å­ç±»å‹
>// å¦‚æœä¸åŠ ,å…¶æ„é€ å‡½æ•°æ‰¾çš„[`new Supper()`]æ—¶ä»é¡¶å±‚Objectç»§æ‰¿æ¥çš„æ„é€ å‡½æ•°,æŒ‡å‘[`Supper()`]
>Sub.prototype.constructor = Sub
>//ç»™å­ç±»å‹çš„åŸå‹ä¸Šå¢åŠ ä¸€ä¸ª[showSubProp]æ–¹æ³•,æ‰“å°è‡ªèº«subProp
>Sub.prototype.showSubProp = function () {
> console.log(this.subProp)
>}
>
>var sub = new Sub()
>
>sub.showSupperProp() //çˆ¶äº²çš„åŸå‹é“¾
>sub.showSubProp() //å„¿å­çš„åŸå‹é“¾
>console.log(sub)  
>/**
>Sub {subProp: "å„¿å­çš„åŸå‹é“¾"}
>subProp: "å„¿å­çš„åŸå‹é“¾"
>__proto__: Supper
>constructor: Æ’ Sub()
>showSubProp: Æ’ ()
>supProp: "çˆ¶äº²çš„åŸå‹é“¾"
>__proto__: Object
>*/
>```

#### â‘  ç¤ºä¾‹å›¾

>`æ³¨æ„`:æ­¤å›¾ä¸­æ²¡æœ‰ä½“ç°[`constructoræ„é€ å‡½æ•° `],ä¼šåœ¨ä¸‹æ–¹æ„é€ å‡½æ•°è¡¥å……å¤„æŒ‡å‡º
>
>![image-20210728101320606](image/image-20210728101320606.png)

#### â‘¡ æ„é€ å‡½æ•°è¡¥å……

>å¯¹äºä»£ç ä¸­[`Sub.prototype.constructor = Sub`]æ˜¯å¦æœ‰ç–‘æƒ‘?
>
>å¦‚æœä¸åŠ ,å…¶æ„é€ å‡½æ•°æ‰¾çš„[`new Supper()`]æ˜¯ä»é¡¶å±‚Objectç»§æ‰¿æ¥çš„æ„é€ å‡½æ•°,æŒ‡å‘[`Supper()`],è™½ç„¶å¦‚æœä½ ä¸åŠ è¿™å¥è¯,å¤§ä½“ä¸Šä½¿ç”¨æ˜¯ä¸å—å½±å“çš„,ä½†æ˜¯ä½ æœ‰ä¸€ä¸ªå±æ€§æŒ‡å‘æ˜¯é”™è¯¯çš„,å¦‚æœåœ¨å¤§å‹é¡¹ç›®ä¸­ä¸‡ä¸€ä¸‡ä¸€å“ªé‡Œå†è°ƒç”¨åˆ°äº†å‘¢?
>
>1. è¿™é‡Œå¯ä»¥è¡¥å……ä¸€ä¸‹constructor çš„æ¦‚å¿µï¼š
>   - `constructor æˆ‘ä»¬ç§°ä¸ºæ„é€ å‡½æ•°ï¼Œå› ä¸ºå®ƒæŒ‡å›æ„é€ å‡½æ•°æœ¬èº«`
>   - å…¶ä½œç”¨æ˜¯è®©æŸä¸ªæ„é€ å‡½æ•°äº§ç”Ÿçš„ æ‰€æœ‰å®ä¾‹å¯¹è±¡ï¼ˆæ¯”å¦‚fï¼‰ èƒ½å¤Ÿæ‰¾åˆ°ä»–çš„æ„é€ å‡½æ•°ï¼ˆæ¯”å¦‚Funï¼‰ï¼Œç”¨æ³•å°±æ˜¯f.constructor
>2. æ­¤æ—¶å®ä¾‹å¯¹è±¡é‡Œæ²¡æœ‰constructor è¿™ä¸ªå±æ€§ï¼Œäºæ˜¯æ²¿ç€åŸå‹é“¾å¾€ä¸Šæ‰¾åˆ°Fun.prototype é‡Œçš„constructorï¼Œå¹¶æŒ‡å‘Fun å‡½æ•°æœ¬èº«
>   - constructoræœ¬å°±å­˜åœ¨äºåŸå‹ä¸­,æŒ‡å‘æ„é€ å‡½æ•°,æˆä¸ºå­å¯¹è±¡åï¼Œå¦‚æœè¯¥åŸå‹é“¾ä¸­çš„constructoråœ¨è‡ªèº«æ²¡æœ‰è€Œæ˜¯åœ¨çˆ¶åŸå‹ä¸­æ‰¾åˆ°,æ‰€ä»¥æŒ‡å‘çˆ¶ç±»çš„æ„é€ å‡½æ•°
>3. ç”±äºè¿™é‡Œçš„ç»§æ‰¿æ˜¯ç›´æ¥æ”¹äº†æ„é€ å‡½æ•°çš„prototype çš„æŒ‡å‘ï¼Œæ‰€ä»¥åœ¨ subçš„åŸå‹é“¾ä¸­ï¼ŒSub.prototype æ²¡æœ‰constructor å±æ€§ï¼Œåè€Œæ˜¯çœ‹åˆ°äº†ä¸€ä¸ªsuper å®ä¾‹
>4. è¿™å°±è®©sub å®ä¾‹çš„constructor æ— æ³•ä½¿ç”¨äº†ã€‚ä¸ºäº†ä»–è¿˜èƒ½ç”¨ï¼Œå°±åœ¨é‚£ä¸ªsuper å®ä¾‹ä¸­æ‰‹åŠ¨åŠ äº†ä¸€ä¸ªconstructor å±æ€§ï¼Œä¸”æŒ‡å‘Sub å‡½æ•°çœ‹åˆ°äº†ä¸€ä¸ªsuper å®ä¾‹

### â…¡-å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿(å‡çš„)

>æ–¹å¼2: å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿(å‡çš„)
>
>1. å¥—è·¯:
>     - å®šä¹‰çˆ¶ç±»å‹æ„é€ å‡½æ•°
>     - å®šä¹‰å­ç±»å‹æ„é€ å‡½æ•°
>     - åœ¨å­ç±»å‹æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±»å‹æ„é€ 
>2. å…³é”®:
>     - `åœ¨å­ç±»å‹æ„é€ å‡½æ•°ä¸­é€šç”¨call()è°ƒç”¨çˆ¶ç±»å‹æ„é€ å‡½æ•°`
>3. ä½œç”¨:
>   - èƒ½å€Ÿç”¨çˆ¶ç±»ä¸­çš„æ„é€ æ–¹æ³•,ä½†æ˜¯ä¸çµæ´»
>
>```js
>function Person(name, age) {
>  this.name = name
>  this.age = age
>}
>function Student(name, age, price) {
>   //æ­¤å¤„åˆ©ç”¨call(),å°† [Student]çš„thisä¼ é€’ç»™Personæ„é€ å‡½æ•°
>  Person.call(this, name, age)  // ç›¸å½“äº: this.Person(name, age)
>  /*this.name = name
>  this.age = age*/
>  this.price = price
>}
>
>var s = new Student('Tom', 20, 14000)
>console.log(s.name, s.age, s.price)
>```
>
>[`Person`]ä¸­çš„thisæ˜¯åŠ¨æ€å˜åŒ–çš„,åœ¨[`Student`]ä¸­åˆ©ç”¨[`Person.call(this, name, age)`]æ”¹å˜äº†å…¶thisæŒ‡å‘,æ‰€ä»¥å¯ä»¥å®ç°æ­¤æ•ˆæœ

### â…¢-ç»„åˆç»§æ‰¿

>æ–¹å¼3: åŸå‹é“¾+å€Ÿç”¨æ„é€ å‡½æ•°çš„ç»„åˆç»§æ‰¿
>
>1. åˆ©ç”¨åŸå‹é“¾å®ç°å¯¹çˆ¶ç±»å‹å¯¹è±¡çš„æ–¹æ³•ç»§æ‰¿
>2. åˆ©ç”¨super()å€Ÿç”¨çˆ¶ç±»å‹æ„å»ºå‡½æ•°åˆå§‹åŒ–ç›¸åŒå±æ€§
>
>```js
>function Person(name, age) {
>  this.name = name
>  this.age = age
>}
>Person.prototype.setName = function (name) {
>  this.name = name
>}
>
>function Student(name, age, price) {
>  Person.call(this, name, age)  // ä¸ºäº†å¾—åˆ°å±æ€§
>  this.price = price
>}
>Student.prototype = new Person() // ä¸ºäº†èƒ½çœ‹åˆ°çˆ¶ç±»å‹çš„æ–¹æ³•
>Student.prototype.constructor = Student //ä¿®æ­£constructorå±æ€§
>Student.prototype.setPrice = function (price) {
>  this.price = price
>}
>
>var s = new Student('Tom', 24, 15000)
>s.setName('Bob')
>s.setPrice(16000)
>console.log(s.name, s.age, s.price)
>```

# ä¸‰ã€çº¿ç¨‹æœºåˆ¶ä¸äº‹ä»¶æœºåˆ¶

## 1ã€è¿›ç¨‹ä¸çº¿ç¨‹

> ![image-20210728115630974](image/image-20210728115630974.png)  

### â… - è¿›ç¨‹

>1. ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œ,å®ƒ`å æœ‰ä¸€ç‰‡ç‹¬æœ‰çš„å†…å­˜ç©ºé—´`
>2. å¯ä»¥é€šè¿‡windowsä»»åŠ¡ç®¡ç†å™¨æŸ¥çœ‹è¿›ç¨‹
>   - å¯ä»¥çœ‹å‡ºæ¯ä¸ªç¨‹åºçš„å†…å­˜ç©ºé—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„
>   - <img src="image/image-20210728115541255.png" alt="image-20210728115541255" style="zoom:80%;" /> 

### â…¡-çº¿ç¨‹

>æ¦‚å¿µ:
>
>- æ˜¯è¿›ç¨‹å†…çš„ä¸€ä¸ªç‹¬ç«‹æ‰§è¡Œå•å…ƒ
>- æ˜¯ç¨‹åºæ‰§è¡Œçš„ä¸€ä¸ªå®Œæ•´æµç¨‹
>- æ˜¯CPUçš„æœ€å°çš„è°ƒåº¦å•å…ƒ

### â…¢-è¿›ç¨‹ä¸çº¿ç¨‹

>1. åº”ç”¨ç¨‹åºå¿…é¡»è¿è¡Œåœ¨æŸä¸ªè¿›ç¨‹çš„æŸä¸ªçº¿ç¨‹ä¸Š
>2. ä¸€ä¸ªè¿›ç¨‹ä¸­è‡³å°‘æœ‰ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹:ä¸»çº¿ç¨‹                 -->è¿›ç¨‹å¯åŠ¨åè‡ªåŠ¨åˆ›å»º
>3. ä¸€ä¸ªè¿›ç¨‹ä¸­ä¹Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªçº¿ç¨‹:æ­¤æ—¶æˆ‘ä»¬ä¼šè¯´è¿™ä¸ªç¨‹åºæ˜¯å¤šçº¿ç¨‹è¿è¡Œçš„
>4. å¤šä¸ªè¿›ç¨‹ä¹‹é—´çš„æ•°æ®æ˜¯ä¸èƒ½ç›´æ¥å…±äº«çš„                    -->å†…å­˜ç›¸äº’ç‹¬ç«‹(éš”ç¦»)
>5. `çº¿ç¨‹æ± (thread pool)`:ä¿å­˜å¤šä¸ªçº¿ç¨‹å¯¹è±¡çš„å®¹å™¨,å®ç°çº¿ç¨‹å¯¹è±¡çš„åå¤åˆ©ç”¨

### â…£-å¼•å‡ºçš„é—®é¢˜

#### â‘  ä½•ä¸ºå¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹?

>å¤šè¿›ç¨‹è¿è¡Œ: ä¸€åº”ç”¨ç¨‹åºå¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ªå®ä¾‹è¿è¡Œ
>
>å¤šçº¿ç¨‹: åœ¨ä¸€ä¸ªè¿›ç¨‹å†…, åŒæ—¶æœ‰å¤šä¸ªçº¿ç¨‹è¿è¡Œ

#### â‘¡æ¯”è¾ƒå•çº¿ç¨‹ä¸å¤šçº¿ç¨‹?

>å¤šçº¿ç¨‹:
>
>- ä¼˜ç‚¹:èƒ½æœ‰æ•ˆæå‡CPUçš„åˆ©ç”¨ç‡
>- ç¼ºç‚¹
>  - åˆ›å»ºå¤šçº¿ç¨‹å¼€é”€
>  - çº¿ç¨‹é—´åˆ‡æ¢å¼€é”€
>  - æ­»é”ä¸çŠ¶æ€åŒæ­¥é—®é¢˜
>
>å•çº¿ç¨‹:
>
>* ä¼˜ç‚¹:é¡ºåºç¼–ç¨‹ç®€å•æ˜“æ‡‚
>* ç¼ºç‚¹:æ•ˆç‡ä½

#### â‘¢ JSæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹?

>`JSæ˜¯å•çº¿ç¨‹è¿è¡Œçš„ , ä½†ä½¿ç”¨H5ä¸­çš„ Web Workerså¯ä»¥å¤šçº¿ç¨‹è¿è¡Œ`
>
>* åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹å»æ“ä½œDOMç•Œé¢
>* å…·ä½“åŸå› å¯çœ‹ä¸‹æ–¹[3ã€JSæ˜¯å•çº¿ç¨‹çš„](#3ã€JSæ˜¯å•çº¿ç¨‹çš„)éƒ¨åˆ†ç»™å‡ºçš„è¯¦è§£

#### â‘£ æµè§ˆå™¨è¿è¡Œæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹?

>éƒ½æ˜¯å¤šçº¿ç¨‹è¿è¡Œçš„

#### â‘¤ æµè§ˆå™¨è¿è¡Œæ˜¯å•è¿›ç¨‹è¿˜æ˜¯å¤šè¿›ç¨‹?

>æœ‰çš„æ˜¯å•è¿›ç¨‹:
>
>* firefox
>* è€ç‰ˆIE
>
>æœ‰çš„æ˜¯å¤šè¿›ç¨‹:
>
>* chrome
>* æ–°ç‰ˆIE
>
>å¦‚ä½•æŸ¥çœ‹æµè§ˆå™¨æ˜¯å¦æ˜¯å¤šè¿›ç¨‹è¿è¡Œçš„å‘¢? ä»»åŠ¡ç®¡ç†å™¨-->è¿›ç¨‹

## 2ã€æµè§ˆå™¨å†…æ ¸

>æ”¯æ’‘æµè§ˆå™¨è¿è¡Œçš„æœ€æ ¸å¿ƒçš„ç¨‹åº

### â… -ä¸åŒæµè§ˆå™¨çš„å†…æ ¸

>- Chrome, Safari : webkit
>- firefox : Gecko
>- IE	: Trident
>- 360,æœç‹—ç­‰å›½å†…æµè§ˆå™¨: Trident + webkit

### â…¡-å†…æ ¸ç”±ä»€ä¹ˆæ¨¡å—ç»„æˆ?

>ä¸»çº¿ç¨‹
>
>1. jså¼•æ“æ¨¡å— : è´Ÿè´£jsç¨‹åºçš„ç¼–è¯‘ä¸è¿è¡Œ
>2. html,cssæ–‡æ¡£è§£ææ¨¡å— : è´Ÿè´£é¡µé¢æ–‡æœ¬çš„è§£æ(æ‹†è§£)
>3. dom/cssæ¨¡å— : è´Ÿè´£dom/cssåœ¨å†…å­˜ä¸­çš„ç›¸å…³å¤„ç†
>4. å¸ƒå±€å’Œæ¸²æŸ“æ¨¡å— : è´Ÿè´£é¡µé¢çš„å¸ƒå±€å’Œæ•ˆæœçš„ç»˜åˆ¶
>5. å¸ƒå±€å’Œæ¸²æŸ“æ¨¡å— : è´Ÿè´£é¡µé¢çš„å¸ƒå±€å’Œæ•ˆæœçš„ç»˜åˆ¶
>
>åˆ†çº¿ç¨‹
>
>- å®šæ—¶å™¨æ¨¡å— : è´Ÿè´£å®šæ—¶å™¨çš„ç®¡ç†
>- ç½‘ç»œè¯·æ±‚æ¨¡å— : è´Ÿè´£æœåŠ¡å™¨è¯·æ±‚(å¸¸è§„/Ajax)
>- äº‹ä»¶å“åº”æ¨¡å— : è´Ÿè´£äº‹ä»¶çš„ç®¡ç†
>
>å›¾ä¾‹
>
>![image-20210728141032723](image/image-20210728141032723.png)

## 3ã€å®šæ—¶å™¨å¼•å‘çš„æ€è€ƒ

>```js
><body>
><button id="btn">å¯åŠ¨å®šæ—¶å™¨</button>
><script type="text/javascript">
>  document.getElementById('btn').onclick = function () {
>    var start = Date.now()
>    console.log('å¯åŠ¨å®šæ—¶å™¨å‰...')
>    setTimeout(function () {
>      console.log('å®šæ—¶å™¨æ‰§è¡Œäº†', Date.now()-start) //å®šæ—¶å™¨å¹¶ä¸èƒ½ä¿è¯çœŸæ­£å®šæ—¶æ‰§è¡Œ,ä¸€èˆ¬ä¼šå»¶è¿Ÿä¸€ä¸ç‚¹
>    }, 200)
>    console.log('å¯åŠ¨å®šæ—¶å™¨å...')
>    // åšä¸€ä¸ªé•¿æ—¶é—´çš„å·¥ä½œ
>    for (var i = 0; i < 1000000000; i++) { //ä¼šé€ æˆå®šæ—¶å™¨å»¶é•¿å¾ˆé•¿æ—¶é—´
>        ...
>    }
>  }
></script>
></body>
>```

### â… -å®šæ—¶å™¨çœŸæ˜¯å®šæ—¶æ‰§è¡Œçš„å—?

>* å®šæ—¶å™¨å¹¶ä¸èƒ½ä¿è¯çœŸæ­£å®šæ—¶æ‰§è¡Œ
>* ä¸€èˆ¬ä¼šå»¶è¿Ÿä¸€ä¸ç‚¹(å¯ä»¥æ¥å—), ä¹Ÿæœ‰å¯èƒ½å»¶è¿Ÿå¾ˆé•¿æ—¶é—´(ä¸èƒ½æ¥å—)

### â…¡-å®šæ—¶å™¨å›è°ƒå‡½æ•°æ˜¯åœ¨åˆ†çº¿ç¨‹æ‰§è¡Œçš„å—?

>åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„, JSæ˜¯å•çº¿ç¨‹çš„

### â…¢-å®šæ—¶å™¨æ˜¯å¦‚ä½•å®ç°çš„?

> `äº‹ä»¶å¾ªç¯æ¨¡å‹`,åœ¨ä¸‹æ–¹ç»™å‡ºè¯¦è§£

## 3ã€JSæ˜¯å•çº¿ç¨‹çš„

### â… -å¦‚ä½•è¯æ˜JSæ‰§è¡Œæ˜¯å•çº¿ç¨‹çš„

>* `setTimeout()çš„å›è°ƒå‡½æ•°æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„`
>* å®šæ—¶å™¨å›è°ƒå‡½æ•°åªæœ‰åœ¨è¿è¡Œæ ˆä¸­çš„ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œåæ‰æœ‰å¯èƒ½æ‰§è¡Œ
>
>```js
>// å¦‚ä½•è¯æ˜JSæ‰§è¡Œæ˜¯å•çº¿ç¨‹çš„
> setTimeout(function () { //4. åœ¨å°†[timeout 1111]å¼¹çª—å…³é—­å,å†ç­‰ä¸€ç§’ æ‰§è¡Œæ­¤å¤„
>    console.log('timeout 2222')
>    alert('22222222')
>  }, 2000)
>  setTimeout(function () { //3. è¿‡äº†ä¸€ç§’å æ‰“å° timeout 1111å¹¶å¼¹çª—,æ­¤å¤„å¦‚æœä¸å°†å¼¹çª—å…³é—­,ä¸ä¼šç»§ç»­æ‰§è¡Œä¸Šæ–¹222
>    console.log('timeout 1111')
>    alert('1111111')
>  }, 1000)
>  setTimeout(function () { //2. ç„¶åæ‰“å°timeout() 00000
>    console.log('timeout() 00000')
>  }, 0)
>  function fn() { //1. fn()
>    console.log('fn()')
>  }
>  fn()
>//----------------------
>  console.log('alert()ä¹‹å‰')
>  alert('------') //æš‚åœå½“å‰ä¸»çº¿ç¨‹çš„æ‰§è¡Œ, åŒæ—¶æš‚åœè®¡æ—¶, ç‚¹å‡»ç¡®å®šå, æ¢å¤ç¨‹åºæ‰§è¡Œå’Œè®¡æ—¶
>  console.log('alert()ä¹‹å')
>```
>
>æµç¨‹ç»“æœ:
>
>1. å…ˆæ‰“å°äº†[`fn()`],ç„¶åé©¬ä¸Šå°±æ‰“å°äº†[`timeout() 00000`]
>2. è¿‡äº†ä¸€ç§’å æ‰“å° timeout 1111å¹¶å¼¹çª—,æ­¤å¤„å¦‚æœä¸å°†å¼¹çª—å…³é—­,ä¸ä¼šç»§ç»­æ‰§è¡Œä¸Šæ–¹222
>3. åœ¨å°†[timeout 1111]å¼¹çª—å…³é—­å,`å†ç­‰ä¸€ç§’` æ‰§è¡Œæ­¤å¤„
>   - é—®:ä¸ºä½•æ˜æ˜å†™çš„æ˜¯2ç§’,å´å…³é—­ä¸Šä¸€ä¸ªå¼¹çª—å†è¿‡ä¸€ç§’å°±æ‰§è¡Œ?
>   - è§£:å¹¶ä¸æ˜¯å…³é—­åå†è®¡ç®—çš„,è€Œæ˜¯ä¸€èµ·è®¡ç®—çš„,alertåªæ˜¯æš‚åœäº†ä¸»çº¿ç¨‹æ‰§è¡Œ

### â…¡-JSå¼•æ“æ‰§è¡Œä»£ç çš„åŸºæœ¬æµç¨‹ä¸ä»£ç åˆ†ç±»

>ä»£ç åˆ†ç±»:
>
>- åˆå§‹åŒ–ä»£ç 
>- å›è°ƒä»£ç 
>
>jså¼•æ“æ‰§è¡Œä»£ç çš„åŸºæœ¬æµç¨‹
>
>1. å…ˆæ‰§è¡Œåˆå§‹åŒ–ä»£ç : åŒ…å«ä¸€äº›ç‰¹åˆ«çš„ä»£ç    å›è°ƒå‡½æ•°(å¼‚æ­¥æ‰§è¡Œ)
>  * è®¾ç½®å®šæ—¶å™¨
>  * ç»‘å®šäº‹ä»¶ç›‘å¬
>  * å‘é€ajaxè¯·æ±‚
>2. åé¢åœ¨æŸä¸ªæ—¶åˆ»æ‰ä¼šæ‰§è¡Œå›è°ƒä»£ç 

### â…¢-ä¸ºä»€ä¹ˆjsè¦ç”¨å•çº¿ç¨‹æ¨¡å¼, è€Œä¸ç”¨å¤šçº¿ç¨‹æ¨¡å¼?

>  1. JavaScriptçš„å•çº¿ç¨‹ï¼Œä¸å®ƒçš„ç”¨é€”æœ‰å…³ã€‚
>  2. ä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼ŒJavaScriptçš„ä¸»è¦ç”¨é€”æ˜¯ä¸ç”¨æˆ·äº’åŠ¨ï¼Œä»¥åŠæ“ä½œDOMã€‚
>  3. è¿™å†³å®šäº†å®ƒåªèƒ½æ˜¯å•çº¿ç¨‹ï¼Œå¦åˆ™ä¼šå¸¦æ¥å¾ˆå¤æ‚çš„åŒæ­¥é—®é¢˜
>       * ä¸¾ä¸ªæ —å­:å¦‚æœæˆ‘ä»¬è¦å®ç°æ›´æ–°é¡µé¢ä¸Šä¸€ä¸ªdomèŠ‚ç‚¹ç„¶ååˆ é™¤,ç”¨å•çº¿ç¨‹æ˜¯æ²¡é—®é¢˜çš„
>       * ä½†æ˜¯å¦‚æœå¤šçº¿ç¨‹,å½“æˆ‘åˆ é™¤çº¿ç¨‹å…ˆåˆ é™¤äº†domèŠ‚ç‚¹,æ›´æ–°çº¿ç¨‹è¦å»æ›´æ–°çš„æ—¶å€™å°±ä¼šå‡ºé”™

## 4ã€äº‹ä»¶å¾ªç¯æ¨¡å‹(Event Loop)æœºåˆ¶

### â… -æ¦‚å¿µå¼•å‡º

>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ`javascriptä»è¯ç”Ÿä¹‹æ—¥èµ·å°±æ˜¯ä¸€é—¨å•çº¿ç¨‹çš„éé˜»å¡çš„è„šæœ¬è¯­è¨€`ã€‚è¿™æ˜¯ç”±å…¶æœ€åˆçš„ç”¨é€”æ¥å†³å®šçš„ï¼š`ä¸æµè§ˆå™¨äº¤äº’`ã€‚
>
>å•çº¿ç¨‹æ„å‘³ç€ï¼Œjavascriptä»£ç åœ¨æ‰§è¡Œçš„ä»»ä½•æ—¶å€™ï¼Œéƒ½åªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹æ¥å¤„ç†æ‰€æœ‰çš„ä»»åŠ¡ã€‚
>
>`éé˜»å¡`:
>
>>è€Œéé˜»å¡åˆ™æ˜¯å½“ä»£ç éœ€è¦è¿›è¡Œä¸€é¡¹å¼‚æ­¥ä»»åŠ¡ï¼ˆæ— æ³•ç«‹åˆ»è¿”å›ç»“æœï¼Œéœ€è¦èŠ±ä¸€å®šæ—¶é—´æ‰èƒ½è¿”å›çš„ä»»åŠ¡ï¼Œå¦‚I/Oäº‹ä»¶ï¼‰çš„æ—¶å€™ï¼Œä¸»çº¿ç¨‹ä¼šæŒ‚èµ·ï¼ˆpendingï¼‰è¿™ä¸ªä»»åŠ¡ï¼Œç„¶ååœ¨å¼‚æ­¥ä»»åŠ¡è¿”å›ç»“æœçš„æ—¶å€™å†æ ¹æ®ä¸€å®šè§„åˆ™å»æ‰§è¡Œç›¸åº”çš„å›è°ƒã€‚
>
>`å•çº¿ç¨‹æ˜¯å¿…è¦çš„`:
>
>>ä¹Ÿæ˜¯javascriptè¿™é—¨è¯­è¨€çš„åŸºçŸ³ï¼ŒåŸå› ä¹‹ä¸€åœ¨å…¶æœ€åˆä¹Ÿæ˜¯æœ€ä¸»è¦çš„æ‰§è¡Œç¯å¢ƒâ€”â€”æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œå„ç§å„æ ·çš„domæ“ä½œã€‚è¯•æƒ³ä¸€ä¸‹ å¦‚æœjavascriptæ˜¯å¤šçº¿ç¨‹çš„ï¼Œé‚£ä¹ˆå½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹domè¿›è¡Œä¸€é¡¹æ“ä½œï¼Œä¾‹å¦‚ä¸€ä¸ªå‘å…¶æ·»åŠ äº‹ä»¶ï¼Œè€Œå¦ä¸€ä¸ªåˆ é™¤äº†è¿™ä¸ªdomï¼Œæ­¤æ—¶è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿå› æ­¤ï¼Œä¸ºäº†ä¿è¯ä¸ä¼š å‘ç”Ÿç±»ä¼¼äºè¿™ä¸ªä¾‹å­ä¸­çš„æƒ…æ™¯ï¼Œjavascripté€‰æ‹©åªç”¨ä¸€ä¸ªä¸»çº¿ç¨‹æ¥æ‰§è¡Œä»£ç ï¼Œè¿™æ ·å°±ä¿è¯äº†ç¨‹åºæ‰§è¡Œçš„ä¸€è‡´æ€§ã€‚
>
>å½“ç„¶ï¼Œç°å¦‚ä»Šäººä»¬ä¹Ÿæ„è¯†åˆ°ï¼Œå•çº¿ç¨‹åœ¨ä¿è¯äº†æ‰§è¡Œé¡ºåºçš„åŒæ—¶ä¹Ÿé™åˆ¶äº†javascriptçš„æ•ˆç‡ï¼Œå› æ­¤å¼€å‘å‡ºäº†`web workers`æŠ€æœ¯ã€‚è¿™é¡¹æŠ€æœ¯å·ç§°å¯ä»¥è®©javaScriptæˆä¸ºä¸€é—¨å¤šçº¿ç¨‹è¯­è¨€ã€‚
>
>>ç„¶è€Œï¼Œä½¿ç”¨web workersæŠ€æœ¯å¼€çš„å¤šçº¿ç¨‹æœ‰ç€è¯¸å¤šé™åˆ¶ï¼Œä¾‹å¦‚ï¼š`æ‰€æœ‰æ–°çº¿ç¨‹éƒ½å—ä¸»çº¿ç¨‹çš„å®Œå…¨æ§åˆ¶ï¼Œä¸èƒ½ç‹¬ç«‹æ‰§è¡Œ`ã€‚è¿™æ„å‘³ç€è¿™äº›â€œçº¿ç¨‹â€ å®é™…ä¸Šåº”å±äºä¸»çº¿ç¨‹çš„å­çº¿ç¨‹ã€‚å¦å¤–ï¼Œè¿™äº›å­çº¿ç¨‹å¹¶æ²¡æœ‰æ‰§è¡ŒI/Oæ“ä½œçš„æƒé™ï¼Œåªèƒ½ä¸ºä¸»çº¿ç¨‹åˆ†æ‹…ä¸€äº›è¯¸å¦‚è®¡ç®—ç­‰ä»»åŠ¡ã€‚æ‰€ä»¥ä¸¥æ ¼æ¥è®²è¿™äº›çº¿ç¨‹å¹¶æ²¡æœ‰å®Œæ•´çš„åŠŸèƒ½ï¼Œä¹Ÿå› æ­¤è¿™é¡¹æŠ€æœ¯å¹¶éæ”¹å˜äº†javascriptè¯­è¨€çš„å•çº¿ç¨‹æœ¬è´¨ã€‚
>
>å¯ä»¥é¢„è§ï¼Œæœªæ¥çš„javascriptä¹Ÿä¼šä¸€ç›´æ˜¯ä¸€é—¨å•çº¿ç¨‹çš„è¯­è¨€ã€‚
>
>è¯è¯´å›æ¥ï¼Œå‰é¢æåˆ°javascriptçš„å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯â€œ`éé˜»å¡`â€ï¼Œé‚£ä¹ˆjavascriptå¼•æ“åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„è¿™ä¸€ç‚¹å‘¢ï¼Ÿ
>
>>ç­”æ¡ˆå°±æ˜¯â€”â€”event loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰ã€‚
>
>**æ³¨ï¼š`è™½ç„¶nodejsä¸­çš„ä¹Ÿå­˜åœ¨ä¸ä¼ ç»Ÿæµè§ˆå™¨ç¯å¢ƒä¸‹çš„ç›¸ä¼¼çš„äº‹ä»¶å¾ªç¯ã€‚ç„¶è€Œä¸¤è€…é—´å´æœ‰ç€è¯¸å¤šä¸åŒï¼Œæ•…æŠŠä¸¤è€…åˆ†å¼€ï¼Œå•ç‹¬è§£é‡Š`ã€‚**

### â…¡-æµè§ˆå™¨ç¯å¢ƒä¸‹JSå¼•æ“çš„äº‹ä»¶å¾ªç¯æœºåˆ¶

#### â‘  æ‰§è¡Œæ ˆæ¦‚å¿µ

>æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆè¯¦æƒ…å¯ä»¥çœ‹ä¸Šæ–¹ç¬”è®° -->[å‡½æ•°é«˜çº§çš„2ã€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ](#2ã€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ),æ­¤å¤„ç»§ç»­è¿›è¡Œä¸€æ¬¡æ¦‚è¿°åŠ æ·±ç†è§£
>
>å½“javascriptä»£ç æ‰§è¡Œçš„æ—¶å€™ä¼šå°†ä¸åŒçš„å˜é‡å­˜äºå†…å­˜ä¸­çš„ä¸åŒä½ç½®ï¼š`å †ï¼ˆheapï¼‰`å’Œ`æ ˆï¼ˆstackï¼‰`ä¸­æ¥åŠ ä»¥åŒºåˆ†ã€‚å…¶ä¸­ï¼Œå †é‡Œå­˜æ”¾ç€ä¸€äº›å¯¹è±¡ã€‚è€Œæ ˆä¸­åˆ™å­˜æ”¾ç€ä¸€äº›åŸºç¡€ç±»å‹å˜é‡ä»¥åŠå¯¹è±¡çš„æŒ‡é’ˆã€‚ `ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œè¯´çš„æ‰§è¡Œæ ˆå’Œä¸Šé¢è¿™ä¸ªæ ˆçš„æ„ä¹‰å´æœ‰äº›ä¸åŒ`ã€‚
>
>`æ‰§è¡Œæ ˆ`:
>
>> å½“æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œjsä¼šç”Ÿæˆä¸€ä¸ªä¸è¿™ä¸ªæ–¹æ³•å¯¹åº”çš„æ‰§è¡Œç¯å¢ƒï¼ˆcontextï¼‰ï¼Œåˆå«`æ‰§è¡Œä¸Šä¸‹æ–‡`ã€‚è¿™ä¸ªæ‰§è¡Œç¯å¢ƒä¸­å­˜åœ¨ç€è¿™ä¸ªæ–¹æ³•çš„ç§æœ‰ä½œç”¨åŸŸã€ä¸Šå±‚ä½œç”¨åŸŸçš„æŒ‡å‘ã€æ–¹æ³•çš„å‚æ•°ï¼Œè¿™ä¸ªä½œç”¨åŸŸä¸­å®šä¹‰çš„å˜é‡ä»¥åŠè¿™ä¸ªä½œç”¨åŸŸçš„thiså¯¹è±¡ã€‚ è€Œå½“ä¸€ç³»åˆ—æ–¹æ³•è¢«ä¾æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œå› ä¸ºjsæ˜¯å•çº¿ç¨‹çš„ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼Œäºæ˜¯è¿™äº›æ–¹æ³•è¢«æ’é˜Ÿåœ¨ä¸€ä¸ªå•ç‹¬çš„åœ°æ–¹ã€‚è¿™ä¸ªåœ°æ–¹è¢«ç§°ä¸ºæ‰§è¡Œæ ˆã€‚
>
>å½“ä¸€ä¸ªè„šæœ¬ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œjså¼•æ“ä¼šè§£æè¿™æ®µä»£ç ï¼Œå¹¶å°†å…¶ä¸­çš„åŒæ­¥ä»£ç æŒ‰ç…§æ‰§è¡Œé¡ºåºåŠ å…¥æ‰§è¡Œæ ˆä¸­ï¼Œç„¶åä»å¤´å¼€å§‹æ‰§è¡Œã€‚å¦‚æœå½“å‰æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆjsä¼šå‘æ‰§è¡Œæ ˆä¸­æ·»åŠ è¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œç¯å¢ƒï¼Œç„¶åè¿›å…¥è¿™ä¸ªæ‰§è¡Œç¯å¢ƒç»§ç»­æ‰§è¡Œå…¶ä¸­çš„ä»£ç ã€‚`å½“è¿™ä¸ªæ‰§è¡Œç¯å¢ƒä¸­çš„ä»£ç  æ‰§è¡Œå®Œæ¯•å¹¶è¿”å›ç»“æœåï¼Œjsä¼šé€€å‡ºè¿™ä¸ªæ‰§è¡Œç¯å¢ƒå¹¶æŠŠè¿™ä¸ªæ‰§è¡Œç¯å¢ƒé”€æ¯ï¼Œå›åˆ°ä¸Šä¸€ä¸ªæ–¹æ³•çš„æ‰§è¡Œç¯å¢ƒ`ã€‚è¿™ä¸ªè¿‡ç¨‹åå¤è¿›è¡Œï¼Œç›´åˆ°æ‰§è¡Œæ ˆä¸­çš„ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ã€‚
>
>æ­¤å¤„ç»§ç»­æ‹¿å‡ºæ ˆå›¾åŠ æ·±ç†è§£:<img src="image/æ‰§è¡Œæ ˆä¸äº‹ä»¶é˜Ÿåˆ—.gif" style="zoom:80%;" /> 
>
>ä»å›¾ç‰‡å¯çŸ¥ï¼Œä¸€ä¸ªæ–¹æ³•æ‰§è¡Œä¼šå‘æ‰§è¡Œæ ˆä¸­åŠ å…¥è¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œç¯å¢ƒï¼Œåœ¨è¿™ä¸ªæ‰§è¡Œç¯å¢ƒä¸­è¿˜å¯ä»¥è°ƒç”¨å…¶ä»–æ–¹æ³•ï¼Œç”šè‡³æ˜¯è‡ªå·±ï¼Œå…¶ç»“æœä¸è¿‡æ˜¯åœ¨æ‰§è¡Œæ ˆä¸­å†æ·»åŠ ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥æ˜¯æ— é™è¿›è¡Œä¸‹å»çš„ï¼Œ`é™¤éå‘ç”Ÿäº†æ ˆæº¢å‡ºï¼Œå³è¶…è¿‡äº†æ‰€èƒ½ä½¿ç”¨å†…å­˜çš„æœ€å¤§å€¼`ã€‚
>
>ä»¥ä¸Šçš„è¿‡ç¨‹è¯´çš„éƒ½æ˜¯åŒæ­¥ä»£ç çš„æ‰§è¡Œã€‚é‚£ä¹ˆå½“ä¸€ä¸ªå¼‚æ­¥ä»£ç ï¼ˆå¦‚å‘é€ajaxè¯·æ±‚æ•°æ®ï¼‰æ‰§è¡Œåä¼šå¦‚ä½•å‘¢ï¼Ÿ
>
>> åˆšåˆšè¯´è¿‡jsçš„å¦ä¸€å¤§ç‰¹ç‚¹æ˜¯éé˜»å¡ï¼Œå®ç°è¿™ä¸€ç‚¹çš„å…³é”®åœ¨äºä¸‹é¢è¦è¯´çš„è¿™é¡¹æœºåˆ¶â€”â€”`äº‹ä»¶é˜Ÿåˆ—ï¼ˆTask Queueï¼‰`ã€‚

#### â‘¡ äº‹ä»¶é˜Ÿåˆ—ï¼ˆTask Queueï¼‰

>JSå¼•æ“é‡åˆ°ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶åå¹¶ä¸ä¼šä¸€ç›´ç­‰å¾…å…¶è¿”å›ç»“æœï¼Œè€Œæ˜¯ä¼šå°†è¿™ä¸ªäº‹ä»¶æŒ‚èµ·ï¼Œç»§ç»­æ‰§è¡Œæ‰§è¡Œæ ˆä¸­çš„å…¶ä»–ä»»åŠ¡,å½“ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶è¿”å›ç»“æœåï¼Œjsä¼šå°†è¿™ä¸ªäº‹ä»¶åŠ å…¥ä¸å½“å‰æ‰§è¡Œæ ˆä¸åŒçš„å¦ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º`äº‹ä»¶é˜Ÿåˆ—`ã€‚
>
>> è¢«æ”¾å…¥äº‹ä»¶é˜Ÿåˆ—ä¸ä¼šç«‹åˆ»æ‰§è¡Œå…¶å›è°ƒï¼Œè€Œæ˜¯`ç­‰å¾…å½“å‰æ‰§è¡Œæ ˆä¸­çš„æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæ¯•ï¼Œ ä¸»çº¿ç¨‹å¤„äºé—²ç½®çŠ¶æ€æ—¶ï¼Œä¸»çº¿ç¨‹ä¼šå»æŸ¥æ‰¾äº‹ä»¶é˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡`ã€‚å¦‚æœæœ‰ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹ä¼šä»ä¸­å–å‡ºæ’åœ¨ç¬¬ä¸€ä½çš„äº‹ä»¶ï¼Œå¹¶æŠŠè¿™ä¸ªäº‹ä»¶å¯¹åº”çš„å›è°ƒæ”¾å…¥æ‰§è¡Œæ ˆä¸­ï¼Œç„¶åæ‰§è¡Œå…¶ä¸­çš„åŒæ­¥ä»£ç ...ï¼Œå¦‚æ­¤åå¤ï¼Œ`è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªæ— é™çš„å¾ªç¯ã€‚è¿™å°±æ˜¯è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºâ€œäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰â€çš„åŸå› ã€‚`
>
>è¿™é‡Œè¿˜æœ‰ä¸€å¼ å›¾æ¥å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹:<img src="image/image-20210729163242840.png" alt="image-20210729163242840" style="zoom:67%;" />
>
>å›¾ä¸­çš„stackè¡¨ç¤ºæˆ‘ä»¬æ‰€è¯´çš„æ‰§è¡Œæ ˆï¼Œweb apisåˆ™æ˜¯ä»£è¡¨ä¸€äº›å¼‚æ­¥äº‹ä»¶ï¼Œè€Œcallback queueå³äº‹ä»¶é˜Ÿåˆ—ã€‚
>
>ä»¥ä¸Šçš„äº‹ä»¶å¾ªç¯è¿‡ç¨‹æ˜¯ä¸€ä¸ªå®è§‚çš„è¡¨è¿°ï¼Œå®é™…ä¸Šå› ä¸ºå¼‚æ­¥ä»»åŠ¡ä¹‹é—´å¹¶ä¸ç›¸åŒï¼Œå› æ­¤ä»–ä»¬çš„æ‰§è¡Œä¼˜å…ˆçº§ä¹Ÿæœ‰åŒºåˆ«ã€‚`ä¸åŒçš„å¼‚æ­¥ä»»åŠ¡è¢«åˆ†ä¸ºä¸¤ç±»ï¼šå¾®ä»»åŠ¡ï¼ˆmicro taskï¼‰å’Œå®ä»»åŠ¡ï¼ˆmacro taskï¼‰`,æ­¤éƒ¨åˆ†çœ‹ä¸‹æ–¹è¯¦è§£

### â…¢-å®ä»»åŠ¡(**macro task**)ä¸å¾®ä»»åŠ¡(**micro task**)

> å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡äº¦å±äº[â…¡-æµè§ˆå™¨ç¯å¢ƒä¸‹JSå¼•æ“çš„äº‹ä»¶å¾ªç¯æœºåˆ¶](#â…¡-æµè§ˆå™¨ç¯å¢ƒä¸‹JSå¼•æ“çš„äº‹ä»¶å¾ªç¯æœºåˆ¶)å†…çŸ¥è¯†ç‚¹,ä½†æœ¬äººè§‰å¾—æ¯”è¾ƒé‡è¦,å°†å…¶æé«˜è‡³å…¶çŸ¥è¯†ç‚¹

#### â‘  å®ä»»åŠ¡é˜Ÿåˆ—ä¸å¾®ä»»åŠ¡é˜Ÿåˆ—è§£é‡Š

>é¡¾åæ€ä¹‰,å®ä»»åŠ¡æ”¾è‡³å®ä»»åŠ¡é˜Ÿåˆ—(`ç®€ç§°å®é˜Ÿåˆ—`)ä¸­ã€å¾®ä»»åŠ¡æ”¾è‡³å¾®ä»»åŠ¡é˜Ÿåˆ—(`ç®€ç§°å¾®é˜Ÿåˆ—`)ä¸­
>
>1. JSä¸­ç”¨æ¥å­˜å‚¨å¾…æ‰§è¡Œå›è°ƒå‡½æ•°çš„é˜Ÿåˆ—åŒ…å«2ä¸ªä¸åŒç‰¹å®šçš„åˆ—é˜Ÿ
>   - `å®é˜Ÿåˆ—`:ç”¨æ¥ä¿å­˜å¾…æ‰§è¡Œçš„å®ä»»åŠ¡(å›è°ƒ),æ¯”å¦‚:`å®šæ—¶å™¨`å›è°ƒ/ajaxå›è°ƒ/domäº‹ä»¶å›è°ƒ
>   - `å¾®é˜Ÿåˆ—`:ç”¨æ¥ä¿å­˜å¾…æ‰§è¡Œçš„å¾®ä»»åŠ¡(å›è°ƒ),æ¯”å¦‚:`Promise`çš„å›è°ƒ/muntationå›è°ƒ
>2. JSæ‰§è¡Œæ—¶ä¼šåŒºåˆ«è¿™2ä¸ªé˜Ÿåˆ—:
>     - JSæ‰§è¡Œå¼•æ“é¦–å…ˆå¿…é¡»æ‰§è¡Œæ‰€æœ‰çš„`åˆå§‹åŒ–åŒæ­¥ä»»åŠ¡`ä»£ç 
>     - æ¯æ¬¡å‡†å¤‡å–å‡ºç¬¬ä¸€ä¸ª`å®ä»»åŠ¡æ‰§è¡Œå‰`,éƒ½è¦å°†æ‰€æœ‰çš„`å¾®ä»»åŠ¡`ä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥æ‰§è¡Œ
>
>å‰é¢æˆ‘ä»¬ä»‹ç»è¿‡ï¼Œåœ¨ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸­ï¼Œå¼‚æ­¥äº‹ä»¶è¿”å›ç»“æœåä¼šè¢«æ”¾åˆ°ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ç„¶è€Œï¼Œæ ¹æ®è¿™ä¸ªå¼‚æ­¥äº‹ä»¶çš„ç±»å‹ï¼Œè¿™ä¸ªäº‹ä»¶å®é™…ä¸Šä¼šè¢«å¯¹åº”çš„å®ä»»åŠ¡é˜Ÿåˆ—æˆ–è€…å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­å»ã€‚å¹¶ä¸”åœ¨å½“å‰æ‰§è¡Œæ ˆä¸ºç©ºçš„æ—¶å€™ï¼Œä¸»çº¿ç¨‹ä¼š æŸ¥çœ‹å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰äº‹ä»¶å­˜åœ¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå†å»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªäº‹ä»¶å¹¶æŠŠå¯¹åº”çš„å›åˆ°åŠ å…¥å½“å‰æ‰§è¡Œæ ˆï¼›å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šä¾æ¬¡æ‰§è¡Œé˜Ÿåˆ—ä¸­äº‹ä»¶å¯¹åº”çš„å›è°ƒï¼Œç›´åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œç„¶åå»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºæœ€å‰é¢çš„ä¸€ä¸ªäº‹ä»¶ï¼ŒæŠŠå¯¹åº”çš„å›è°ƒåŠ å…¥å½“å‰æ‰§è¡Œæ ˆ...å¦‚æ­¤åå¤ï¼Œè¿›å…¥å¾ªç¯ã€‚
>
>æˆ‘ä»¬åªéœ€è®°ä½:** `å½“å‰æ‰§è¡Œæ ˆæ‰§è¡Œå®Œæ¯•æ—¶ä¼šç«‹åˆ»å…ˆå¤„ç†æ‰€æœ‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„äº‹ä»¶ï¼Œç„¶åå†å»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªäº‹ä»¶ã€‚åŒä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­ï¼Œå¾®ä»»åŠ¡æ°¸è¿œåœ¨å®ä»»åŠ¡ä¹‹å‰æ‰§è¡Œ` **

#### â‘¡ åŸç†å›¾

>![Promiseç³»ç»Ÿå­¦ä¹ _å®ä»»åŠ¡å¾®ä»»åŠ¡åŸç†å›¾](image/Promiseç³»ç»Ÿå­¦ä¹ _å®ä»»åŠ¡å¾®ä»»åŠ¡åŸç†å›¾.png) 
>



#### â‘¢ ç”±ä»£ç é€†å‘ç†è§£å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡

> ä»£ç ç¤ºä¾‹
>
> ```js
> setTimeout(() => { 
>       console.log('timeout callback1ï¼ˆï¼‰')//ç«‹å³æ”¾å…¥å®é˜Ÿåˆ—
>       Promise.resolve(3).then(
>         value => { 
>           console.log('Promise onResolved3()', value)//å½“è¿™ä¸ªå®ä»»åŠ¡æ‰§è¡Œå ç«‹é©¬æ”¾å…¥å¾®é˜Ÿåˆ—,æ‰€ä»¥è¿™ä¸ªå¾®ä»»åŠ¡æ‰§è¡Œå®Œåä¸‹ä¸ªå®ä»»åŠ¡æ‰èƒ½æ‰§è¡Œ 
>         }
>       )
>     }, 0)
> 
>     setTimeout(() => { 
>       console.log('timeout callback2ï¼ˆï¼‰') //ç«‹å³æ”¾å…¥å®é˜Ÿåˆ—,
>     }, 0)
> 
>     Promise.resolve(1).then(
>       value => { 
>         console.log('Promise onResolved1()', value)//ç«‹å³æ”¾å…¥å¾®é˜Ÿåˆ—
>         setTimeout(() => {
>           console.log('timeout callback3ï¼ˆï¼‰', value) //ç«‹å³æ”¾å…¥å®ä»»åŠ¡
>         }, 0)
>       }
>     )
> 
>     Promise.resolve(2).then(
>       value => { 
>         console.log('Promise onResolved2()', value)//ç«‹å³æ”¾å…¥å¾®é˜Ÿåˆ—
>       }
>     )
> console.log('åŒæ­¥ä»£ç ') //åŒæ­¥ä»£ç ç«‹å³æ‰§è¡Œ
> ```
>
> ç»“æœ
>
> ```js
>  'åŒæ­¥ä»£ç ',
>   'Promise onResolved1()',
>   'Promise onResolved2()',
>   'timeout callback1ï¼ˆï¼‰',
>   'Promise onResolved3()',
>   'timeout callback2ï¼ˆï¼‰',
>   'timeout callback3ï¼ˆï¼‰'
> ```

### â…£-**nodeç¯å¢ƒä¸‹çš„äº‹ä»¶å¾ªç¯æœºåˆ¶**

>`ä¸å­¦nodeçš„å°ä¼™ä¼´å°±è·³è¿‡æ­¤éƒ¨åˆ†ç›´æ¥å»ä¸‹ä¸€èŠ‚Web Workersç¬”è®°å§`

#### â‘  **ä¸æµè§ˆå™¨ç¯å¢ƒæœ‰ä½•ä¸åŒ?**

>åœ¨nodeä¸­ï¼Œäº‹ä»¶å¾ªç¯è¡¨ç°å‡ºçš„çŠ¶æ€ä¸æµè§ˆå™¨ä¸­å¤§è‡´ç›¸åŒã€‚ä¸åŒçš„æ˜¯nodeä¸­æœ‰ä¸€å¥—è‡ªå·±çš„æ¨¡å‹ã€‚nodeä¸­äº‹ä»¶å¾ªç¯çš„å®ç°æ˜¯ä¾é çš„libuvå¼•æ“ã€‚æˆ‘ä»¬çŸ¥é“nodeé€‰æ‹©chrome v8å¼•æ“ä½œä¸ºjsè§£é‡Šå™¨ï¼Œv8å¼•æ“å°†jsä»£ç åˆ†æåå»è°ƒç”¨å¯¹åº”çš„node apiï¼Œè€Œè¿™äº›apiæœ€ååˆ™ç”±libuvå¼•æ“é©±åŠ¨ï¼Œæ‰§è¡Œå¯¹åº”çš„ä»»åŠ¡ï¼Œå¹¶æŠŠä¸åŒçš„äº‹ä»¶æ”¾åœ¨ä¸åŒçš„é˜Ÿåˆ—ä¸­ç­‰å¾…ä¸»çº¿ç¨‹æ‰§è¡Œã€‚ `å› æ­¤å®é™…ä¸Šnodeä¸­çš„äº‹ä»¶å¾ªç¯å­˜åœ¨äºlibuvå¼•æ“ä¸­`ã€‚

#### â‘¡ **äº‹ä»¶å¾ªç¯æ¨¡å‹**

>ä¸‹é¢æ˜¯ä¸€ä¸ªlibuvå¼•æ“ä¸­çš„äº‹ä»¶å¾ªç¯çš„æ¨¡å‹:
>
>```js
>//libuvå¼•æ“ä¸­çš„äº‹ä»¶å¾ªç¯çš„æ¨¡å‹
>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
>â”Œâ”€>â”‚        timers         â”‚
>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
>â”‚  â”‚     I/O callbacks     â”‚
>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
>â”‚  â”‚     idle, prepare     â”‚
>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   incoming:   â”‚
>â”‚  â”‚         poll          â”‚<â”€â”€connectionsâ”€â”€â”€     â”‚
>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   data, etc.  â”‚
>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
>â”‚  â”‚        check          â”‚
>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
>â””â”€â”€â”¤    close callbacks    â”‚
>   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
>```
>
>*æ³¨ï¼šæ¨¡å‹ä¸­çš„æ¯ä¸€ä¸ªæ–¹å—ä»£è¡¨äº‹ä»¶å¾ªç¯çš„ä¸€ä¸ªé˜¶æ®µ*
>
>è¿™ä¸ªæ¨¡å‹æ˜¯nodeå®˜ç½‘ä¸Šçš„ä¸€ç¯‡æ–‡ç« ä¸­ç»™å‡ºçš„ï¼Œæˆ‘ä¸‹é¢çš„è§£é‡Šä¹Ÿéƒ½æ¥æºäºè¿™ç¯‡æ–‡ç« ã€‚æˆ‘ä¼šåœ¨æ–‡æœ«æŠŠæ–‡ç« åœ°å€è´´å‡ºæ¥ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥äº²è‡ªä¸çœ‹çœ‹åŸæ–‡ã€‚

#### â‘¢ **äº‹ä»¶å¾ªç¯å„é˜¶æ®µè¯¦è§£**

>ä»ä¸Šé¢è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´åˆ†æå‡ºnodeä¸­çš„äº‹ä»¶å¾ªç¯çš„é¡ºåºï¼š
>
>> å¤–éƒ¨è¾“å…¥æ•°æ®-->è½®è¯¢é˜¶æ®µ(poll)-->æ£€æŸ¥é˜¶æ®µ(check)-->å…³é—­äº‹ä»¶å›è°ƒé˜¶æ®µ(close callback)-->å®šæ—¶å™¨æ£€æµ‹é˜¶æ®µ(timer)-->I/Oäº‹ä»¶å›è°ƒé˜¶æ®µ(I/O callbacks)-->é—²ç½®é˜¶æ®µ(idle, prepare)-->è½®è¯¢é˜¶æ®µ...
>
>è¿™äº›é˜¶æ®µå¤§è‡´çš„åŠŸèƒ½å¦‚ä¸‹ï¼š
>
>- timers(å®šæ—¶å™¨æ£€æµ‹é˜¶æ®µ): è¿™ä¸ªé˜¶æ®µæ‰§è¡Œå®šæ—¶å™¨é˜Ÿåˆ—ä¸­çš„å›è°ƒå¦‚ `setTimeout()` å’Œ `setInterval()`ã€‚
>- I/O callbacks(I/Oäº‹ä»¶å›è°ƒé˜¶æ®µ): è¿™ä¸ªé˜¶æ®µæ‰§è¡Œå‡ ä¹æ‰€æœ‰çš„å›è°ƒã€‚ä½†æ˜¯ä¸åŒ…æ‹¬closeäº‹ä»¶ï¼Œå®šæ—¶å™¨å’Œ`setImmediate()`çš„å›è°ƒã€‚
>- idle, prepare: è¿™ä¸ªé˜¶æ®µä»…åœ¨å†…éƒ¨ä½¿ç”¨ï¼Œå¯ä»¥ä¸å¿…ç†ä¼šã€‚
>- poll(è½®è¯¢é˜¶æ®µ): ç­‰å¾…æ–°çš„I/Oäº‹ä»¶ï¼Œnodeåœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ä¼šé˜»å¡åœ¨è¿™é‡Œã€‚
>- check(æ£€æŸ¥é˜¶æ®µ): `setImmediate()`çš„å›è°ƒä¼šåœ¨è¿™ä¸ªé˜¶æ®µæ‰§è¡Œã€‚
>- close callbacks(å…³é—­äº‹ä»¶å›è°ƒé˜¶æ®µ): ä¾‹å¦‚`socket.on('close', ...)`è¿™ç§closeäº‹ä»¶çš„å›è°ƒã€‚
>
>ä¸‹é¢æˆ‘ä»¬æ¥æŒ‰ç…§ä»£ç ç¬¬ä¸€æ¬¡è¿›å…¥libuvå¼•æ“åçš„é¡ºåºæ¥è¯¦ç»†è§£è¯´è¿™äº›é˜¶æ®µï¼š

##### **poll(è½®è¯¢é˜¶æ®µ)**

>å½“ä¸ªv8å¼•æ“å°†jsä»£ç è§£æåä¼ å…¥libuvå¼•æ“åï¼Œå¾ªç¯é¦–å…ˆè¿›å…¥pollé˜¶æ®µã€‚pollé˜¶æ®µçš„æ‰§è¡Œé€»è¾‘å¦‚ä¸‹ï¼š å…ˆæŸ¥çœ‹poll queueä¸­æ˜¯å¦æœ‰äº‹ä»¶ï¼Œæœ‰ä»»åŠ¡å°±æŒ‰å…ˆè¿›å…ˆå‡ºçš„é¡ºåºä¾æ¬¡æ‰§è¡Œå›è°ƒã€‚ å½“queueä¸ºç©ºæ—¶ï¼Œä¼šæ£€æŸ¥æ˜¯å¦æœ‰setImmediate()çš„callbackï¼Œå¦‚æœæœ‰å°±è¿›å…¥checké˜¶æ®µæ‰§è¡Œè¿™äº›callbackã€‚ä½†åŒæ—¶ä¹Ÿä¼šæ£€æŸ¥æ˜¯å¦æœ‰åˆ°æœŸçš„timerï¼Œå¦‚æœæœ‰ï¼Œå°±æŠŠè¿™äº›åˆ°æœŸçš„timerçš„callbackæŒ‰ç…§è°ƒç”¨é¡ºåºæ”¾åˆ°timer queueä¸­ï¼Œä¹‹åå¾ªç¯ä¼šè¿›å…¥timeré˜¶æ®µæ‰§è¡Œqueueä¸­çš„ callbackã€‚ è¿™ä¸¤è€…çš„é¡ºåºæ˜¯ä¸å›ºå®šçš„ï¼Œæ”¶åˆ°ä»£ç è¿è¡Œçš„ç¯å¢ƒçš„å½±å“ã€‚å¦‚æœä¸¤è€…çš„queueéƒ½æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆloopä¼šåœ¨pollé˜¶æ®µåœç•™ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªi/oäº‹ä»¶è¿”å›ï¼Œå¾ªç¯ä¼šè¿›å…¥i/o callbacké˜¶æ®µå¹¶ç«‹å³æ‰§è¡Œè¿™ä¸ªäº‹ä»¶çš„callbackã€‚
>
>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œpollé˜¶æ®µåœ¨æ‰§è¡Œpoll queueä¸­çš„å›è°ƒæ—¶å®é™…ä¸Šä¸ä¼šæ— é™çš„æ‰§è¡Œä¸‹å»ã€‚`æœ‰ä¸¤ç§æƒ…å†µpollé˜¶æ®µä¼šç»ˆæ­¢æ‰§è¡Œpoll queueä¸­çš„ä¸‹ä¸€ä¸ªå›è°ƒï¼š1.æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œæ¯•ã€‚2.æ‰§è¡Œæ•°è¶…è¿‡äº†nodeçš„é™åˆ¶ã€‚`

##### check(æ£€æŸ¥é˜¶æ®µ)

>checké˜¶æ®µä¸“é—¨ç”¨æ¥æ‰§è¡Œ`setImmediate()`æ–¹æ³•çš„å›è°ƒï¼Œå½“pollé˜¶æ®µè¿›å…¥ç©ºé—²çŠ¶æ€ï¼Œå¹¶ä¸”setImmediate queueä¸­æœ‰callbackæ—¶ï¼Œäº‹ä»¶å¾ªç¯è¿›å…¥è¿™ä¸ªé˜¶æ®µã€‚

##### close callbacks(å…³é—­äº‹ä»¶å›è°ƒé˜¶æ®µ)

>å½“ä¸€ä¸ªsocketè¿æ¥æˆ–è€…ä¸€ä¸ªhandleè¢«çªç„¶å…³é—­æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨äº†`socket.destroy()`æ–¹æ³•ï¼‰ï¼Œcloseäº‹ä»¶ä¼šè¢«å‘é€åˆ°è¿™ä¸ªé˜¶æ®µæ‰§è¡Œå›è°ƒã€‚å¦åˆ™äº‹ä»¶ä¼šç”¨`process.nextTickï¼ˆï¼‰`æ–¹æ³•å‘é€å‡ºå»ã€‚

##### timers(å®šæ—¶å™¨æ£€æµ‹é˜¶æ®µ)

>è¿™ä¸ªé˜¶æ®µä»¥å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼æ‰§è¡Œæ‰€æœ‰åˆ°æœŸçš„timeråŠ å…¥timeré˜Ÿåˆ—é‡Œçš„callbackï¼Œä¸€ä¸ªtimer callbackæŒ‡å¾—æ˜¯ä¸€ä¸ªé€šè¿‡setTimeoutæˆ–è€…setIntervalå‡½æ•°è®¾ç½®çš„å›è°ƒå‡½æ•°ã€‚

##### I/O callbacks(I/Oäº‹ä»¶å›è°ƒé˜¶æ®µ)

>å¦‚ä¸Šæ–‡æ‰€è¨€ï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦æ‰§è¡Œå¤§éƒ¨åˆ†I/Oäº‹ä»¶çš„å›è°ƒï¼ŒåŒ…æ‹¬ä¸€äº›ä¸ºæ“ä½œç³»ç»Ÿæ‰§è¡Œçš„å›è°ƒã€‚ä¾‹å¦‚ä¸€ä¸ªTCPè¿æ¥ç”Ÿé”™è¯¯æ—¶ï¼Œç³»ç»Ÿéœ€è¦æ‰§è¡Œå›è°ƒæ¥è·å¾—è¿™ä¸ªé”™è¯¯çš„æŠ¥å‘Šã€‚

#### â‘£ **process.nextTick,setTimeoutä¸setImmediateçš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯**

>åœ¨nodeä¸­æœ‰ä¸‰ä¸ªå¸¸ç”¨çš„ç”¨æ¥æ¨è¿Ÿä»»åŠ¡æ‰§è¡Œçš„æ–¹æ³•ï¼šprocess.nextTick,setTimeoutï¼ˆsetIntervalä¸ä¹‹ç›¸åŒï¼‰ä¸setImmediate

è¿™ä¸‰è€…é—´å­˜åœ¨ç€ä¸€äº›éå¸¸ä¸åŒçš„åŒºåˆ«ï¼š

##### **process.nextTick()**

>å°½ç®¡æ²¡æœ‰æåŠï¼Œä½†æ˜¯å®é™…ä¸Šnodeä¸­å­˜åœ¨ç€ä¸€ä¸ªç‰¹æ®Šçš„é˜Ÿåˆ—ï¼Œå³nextTick queueã€‚è¿™ä¸ªé˜Ÿåˆ—ä¸­çš„å›è°ƒæ‰§è¡Œè™½ç„¶æ²¡æœ‰è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªé˜¶æ®µï¼Œå½“æ—¶è¿™äº›äº‹ä»¶å´ä¼šåœ¨æ¯ä¸€ä¸ªé˜¶æ®µæ‰§è¡Œå®Œæ¯•å‡†å¤‡è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µæ—¶ä¼˜å…ˆæ‰§è¡Œã€‚å½“äº‹ä»¶å¾ªç¯å‡†å¤‡è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µä¹‹å‰ï¼Œä¼šå…ˆæ£€æŸ¥nextTick queueä¸­æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œé‚£ä¹ˆä¼šå…ˆæ¸…ç©ºè¿™ä¸ªé˜Ÿåˆ—ã€‚ä¸æ‰§è¡Œpoll queueä¸­çš„ä»»åŠ¡ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªæ“ä½œåœ¨é˜Ÿåˆ—æ¸…ç©ºå‰æ˜¯ä¸ä¼šåœæ­¢çš„ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œé”™è¯¯çš„ä½¿ç”¨`process.nextTick()`æ–¹æ³•ä¼šå¯¼è‡´nodeè¿›å…¥ä¸€ä¸ªæ­»å¾ªç¯ã€‚ã€‚ç›´åˆ°å†…å­˜æ³„æ¼ã€‚
>
>ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒåˆé€‚å‘¢ï¼Ÿä¸‹é¢æœ‰ä¸€ä¸ªä¾‹å­ï¼š
>
>```js
>const server = net.createServer(() => {}).listen(8080);
>server.on('listening', () => {});
>```
>
>è¿™ä¸ªä¾‹å­ä¸­å½“ï¼Œå½“listenæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œé™¤éç«¯å£è¢«å ç”¨ï¼Œå¦åˆ™ä¼šç«‹åˆ»ç»‘å®šåœ¨å¯¹åº”çš„ç«¯å£ä¸Šã€‚è¿™æ„å‘³ç€æ­¤æ—¶è¿™ä¸ªç«¯å£å¯ä»¥ç«‹åˆ»è§¦å‘listeningäº‹ä»¶å¹¶æ‰§è¡Œå…¶å›è°ƒã€‚ç„¶è€Œï¼Œè¿™æ—¶å€™`on('listening)`è¿˜æ²¡æœ‰å°†callbackè®¾ç½®å¥½ï¼Œè‡ªç„¶æ²¡æœ‰callbackå¯ä»¥æ‰§è¡Œã€‚ä¸ºäº†é¿å…å‡ºç°è¿™ç§æƒ…å†µï¼Œnodeä¼šåœ¨listenäº‹ä»¶ä¸­ä½¿ç”¨`process.nextTick()`æ–¹æ³•ï¼Œç¡®ä¿äº‹ä»¶åœ¨å›è°ƒå‡½æ•°ç»‘å®šåè¢«è§¦å‘ã€‚

##### **setTimeout()å’ŒsetImmediate()**

>åœ¨ä¸‰ä¸ªæ–¹æ³•ä¸­ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æœ€å®¹æ˜“è¢«å¼„æ··ã€‚å®é™…ä¸Šï¼ŒæŸäº›æƒ…å†µä¸‹è¿™ä¸¤ä¸ªæ–¹æ³•çš„è¡¨ç°ä¹Ÿéå¸¸ç›¸ä¼¼ã€‚ç„¶è€Œå®é™…ä¸Šï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•çš„æ„ä¹‰å´å¤§ä¸ºä¸åŒã€‚
>
>`setTimeout()`æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªå›è°ƒï¼Œå¹¶ä¸”å¸Œæœ›è¿™ä¸ªå›è°ƒåœ¨æˆ‘ä»¬æ‰€æŒ‡å®šçš„æ—¶é—´é—´éš”åç¬¬ä¸€æ—¶é—´å»æ‰§è¡Œã€‚æ³¨æ„è¿™ä¸ªâ€œç¬¬ä¸€æ—¶é—´æ‰§è¡Œâ€ï¼Œè¿™æ„å‘³ç€ï¼Œå—åˆ°æ“ä½œç³»ç»Ÿå’Œå½“å‰æ‰§è¡Œä»»åŠ¡çš„è¯¸å¤šå½±å“ï¼Œè¯¥å›è°ƒå¹¶ä¸ä¼šåœ¨æˆ‘ä»¬é¢„æœŸçš„æ—¶é—´é—´éš”åç²¾å‡†çš„æ‰§è¡Œã€‚æ‰§è¡Œçš„æ—¶é—´å­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿå’Œè¯¯å·®ï¼Œè¿™æ˜¯ä¸å¯é¿å…çš„ã€‚nodeä¼šåœ¨å¯ä»¥æ‰§è¡Œtimerå›è°ƒçš„ç¬¬ä¸€æ—¶é—´å»æ‰§è¡Œä½ æ‰€è®¾å®šçš„ä»»åŠ¡ã€‚
>
>`setImmediate()`æ–¹æ³•ä»æ„ä¹‰ä¸Šå°†æ˜¯ç«‹åˆ»æ‰§è¡Œçš„æ„æ€ï¼Œä½†æ˜¯å®é™…ä¸Šå®ƒå´æ˜¯åœ¨ä¸€ä¸ªå›ºå®šçš„é˜¶æ®µæ‰ä¼šæ‰§è¡Œå›è°ƒï¼Œå³pollé˜¶æ®µä¹‹åã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™ä¸ªåå­—çš„æ„ä¹‰å’Œä¹‹å‰æåˆ°è¿‡çš„`process.nextTick()`æ–¹æ³•æ‰æ˜¯æœ€åŒ¹é…çš„ã€‚nodeçš„å¼€å‘è€…ä»¬ä¹Ÿæ¸…æ¥šè¿™ä¸¤ä¸ªæ–¹æ³•çš„å‘½åä¸Šå­˜åœ¨ä¸€å®šçš„æ··æ·†ï¼Œä»–ä»¬è¡¨ç¤ºä¸ä¼šæŠŠè¿™ä¸¤ä¸ªæ–¹æ³•çš„åå­—è°ƒæ¢è¿‡æ¥---å› ä¸ºæœ‰å¤§é‡çš„nodeç¨‹åºä½¿ç”¨ç€è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œè°ƒæ¢å‘½åæ‰€å¸¦æ¥çš„å¥½å¤„ä¸å®ƒçš„å½±å“ç›¸æ¯”ä¸å€¼ä¸€æã€‚
>
>`setTimeout()`å’Œä¸è®¾ç½®æ—¶é—´é—´éš”çš„`setImmediate()`è¡¨ç°ä¸ŠåŠå…¶ç›¸ä¼¼ã€‚çŒœçŒœä¸‹é¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ
>
>```js
>setTimeout(() => {
>    console.log('timeout');
>}, 0);
>
>setImmediate(() => {
>    console.log('immediate');
>});
>```
>
>å®é™…ä¸Šï¼Œç­”æ¡ˆæ˜¯ä¸ä¸€å®šã€‚æ²¡é”™ï¼Œå°±è¿nodeçš„å¼€å‘è€…éƒ½æ— æ³•å‡†ç¡®çš„åˆ¤æ–­è¿™ä¸¤è€…çš„é¡ºåºè°å‰è°åã€‚è¿™å–å†³äºè¿™æ®µä»£ç çš„è¿è¡Œç¯å¢ƒã€‚è¿è¡Œç¯å¢ƒä¸­çš„å„ç§å¤æ‚çš„æƒ…å†µä¼šå¯¼è‡´åœ¨åŒæ­¥é˜Ÿåˆ—é‡Œä¸¤ä¸ªæ–¹æ³•çš„é¡ºåºéšæœºå†³å®šã€‚ä½†æ˜¯ï¼Œåœ¨ä¸€ç§æƒ…å†µä¸‹å¯ä»¥å‡†ç¡®åˆ¤æ–­ä¸¤ä¸ªæ–¹æ³•å›è°ƒçš„æ‰§è¡Œé¡ºåºï¼Œé‚£å°±æ˜¯åœ¨ä¸€ä¸ªI/Oäº‹ä»¶çš„å›è°ƒä¸­ã€‚ä¸‹é¢è¿™æ®µä»£ç çš„é¡ºåºæ°¸è¿œæ˜¯å›ºå®šçš„ï¼š
>
>```js
>const fs = require('fs');
>
>fs.readFile(__filename, () => {
>    setTimeout(() => {
>        console.log('timeout');
>    }, 0);
>    setImmediate(() => {
>        console.log('immediate');
>    });
>});
>```
>
>ç­”æ¡ˆæ°¸è¿œæ˜¯ï¼š
>
>```js
>immediate
>timeout
>```
>
>å› ä¸ºåœ¨I/Oäº‹ä»¶çš„å›è°ƒä¸­ï¼ŒsetImmediateæ–¹æ³•çš„å›è°ƒæ°¸è¿œåœ¨timerçš„å›è°ƒå‰æ‰§è¡Œã€‚

## 5ã€Web Workers

>æƒ³äº†è§£æ›´å¤šå¯ä»¥ç‚¹å‡»é“¾æ¥æŸ¥çœ‹æ›´å¤š,æ­¤å¤„åªæ˜¯å¤§è‡´äº†è§£å­¦ä¹    -->[Web Workers](https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API/Using_web_workers)
>
>1. H5è§„èŒƒæä¾›äº†jsåˆ†çº¿ç¨‹çš„å®ç°, å–åä¸º: Web Workers
>2. ç›¸å…³API
>  * Worker: æ„é€ å‡½æ•°, åŠ è½½åˆ†çº¿ç¨‹æ‰§è¡Œçš„jsæ–‡ä»¶
>  * Worker.prototype.onmessage: ç”¨äºæ¥æ”¶å¦ä¸€ä¸ªçº¿ç¨‹çš„å›è°ƒå‡½æ•°
>  * Worker.prototype.postMessage: å‘å¦ä¸€ä¸ªçº¿ç¨‹å‘é€æ¶ˆæ¯
>3. ä¸è¶³
>  * workerå†…ä»£ç ä¸èƒ½æ“ä½œDOM(æ›´æ–°UI)
>  * ä¸èƒ½è·¨åŸŸåŠ è½½JS
>  * ä¸æ˜¯æ¯ä¸ªæµè§ˆå™¨éƒ½æ”¯æŒè¿™ä¸ªæ–°ç‰¹æ€§

### â… -æŠ›ç –å¼•ç‰,å¼•å‡ºç”¨å¤„

>è¿˜æ˜¯æ‹¿æ–æ³¢é‚£å¥‘ï¼ˆFibonacciï¼‰æ•°åˆ—æ¥åšä¾‹å­,è¿™ä¸œè¥¿æ•ˆç‡ä½,å¯ä»¥æ‹¿æ¥æ¨¡æ‹Ÿ
>
>```html
><body>
><input type="text" placeholder="æ•°å€¼" id="number">
><button id="btn">è®¡ç®—</button>
><script type="text/javascript">
>  // 1 1 2 3 5 8    f(n) = f(n-1) + f(n-2)
>  function fibonacci(n) {
>    return n<=2 ? 1 : fibonacci(n-1) + fibonacci(n-2)  //é€’å½’è°ƒç”¨
>  }
>  // console.log(fibonacci(7))
>  var input = document.getElementById('number')
>  document.getElementById('btn').onclick = function () {
>    var number = input.value
>    var result = fibonacci(number)
>    alert(result)
>  }
></script>
>```
>
>å½“æˆ‘è¿è¡Œæ­¤è¡Œä»£ç ,ä¼ å…¥è®¡ç®—æ•°å€¼ä¸º50å·¦å³(æœ‰çš„ç”šè‡³æ›´ä½),æ•´ä¸ªé¡µé¢å°±ä¼šå¡ä½å¥½ä¹…çš„æ—¶é—´ä¸èƒ½æ“ä½œ(è®¡ç®—ç»“æŸåæ‰ä¼šå¼¹çª—,ä½†æ˜¯æœªå¼¹çª—çš„è¿™æ®µæ—¶é—´ç”¨æˆ·å¹¶ä¸èƒ½è¿›è¡Œæ“ä½œ),è¿™æ—¶å€™å°±ä¼šå‘ç°å•çº¿ç¨‹çš„å¼Šç«¯äº†

### â…¡-å°è¯•ä½¿ç”¨

>1. H5è§„èŒƒæä¾›äº†jsåˆ†çº¿ç¨‹çš„å®ç°, å–åä¸º: Web Workers
>2. ç›¸å…³API
>  * Worker: æ„é€ å‡½æ•°, åŠ è½½åˆ†çº¿ç¨‹æ‰§è¡Œçš„jsæ–‡ä»¶
>  * Worker.prototype.onmessage: ç”¨äºæ¥æ”¶å¦ä¸€ä¸ªçº¿ç¨‹çš„å›è°ƒå‡½æ•°
>  * Worker.prototype.postMessage: å‘å¦ä¸€ä¸ªçº¿ç¨‹å‘é€æ¶ˆæ¯
>3. ä¸è¶³
>  * workerå†…ä»£ç ä¸èƒ½æ“ä½œDOM(æ›´æ–°UI)
>  * ä¸èƒ½è·¨åŸŸåŠ è½½JS
>  * ä¸æ˜¯æ¯ä¸ªæµè§ˆå™¨éƒ½æ”¯æŒè¿™ä¸ªæ–°ç‰¹æ€§

#### â‘  ä¸»çº¿ç¨‹

>1. åˆ›å»ºä¸€ä¸ªWorkerå¯¹è±¡
>2. ç»‘å®š[ä¸»çº¿ç¨‹æ¥æ”¶åˆ†çº¿ç¨‹è¿”å›çš„æ•°æ®]æ–¹æ³•
>3. ä¸»çº¿ç¨‹å‘åˆ†çº¿ç¨‹å‘é€æ•°æ®,ç„¶åç­‰å¾…æ¥å—æ•°æ®
>4. æ¥æ”¶åˆ°åˆ†çº¿ç¨‹å›é¦ˆçš„æ•°æ®,å°†æ•°æ®è¿›è¡Œå¤„ç†(å¦‚å¼¹çª—)
>
>```html
><body>
><input type="text" placeholder="æ•°å€¼" id="number">
><button id="btn">è®¡ç®—</button>
><script type="text/javascript">
>  var input = document.getElementById('number')
>  document.getElementById('btn').onclick = function () {
>    var number = input.value
>
>    //åˆ›å»ºä¸€ä¸ªWorkerå¯¹è±¡
>    var worker = new Worker('worker.js')
>    // ç»‘å®šæ¥æ”¶æ¶ˆæ¯çš„ç›‘å¬
>    worker.onmessage = function (event) { //æ­¤å¤„å˜æˆå›è°ƒä»£ç ,ä¼šåœ¨åˆå§‹åŒ–å·¥ä½œå®Œæˆåæ‰ä¼šè¿›è¡Œ
>      console.log('ä¸»çº¿ç¨‹æ¥æ”¶åˆ†çº¿ç¨‹è¿”å›çš„æ•°æ®: '+event.data)
>      alert(event.data)
>    }
>
>    // å‘åˆ†çº¿ç¨‹å‘é€æ¶ˆæ¯
>    worker.postMessage(number)
>    console.log('ä¸»çº¿ç¨‹å‘åˆ†çº¿ç¨‹å‘é€æ•°æ®: '+number)
>  }
>  // console.log(this) // window
>
></script>
></body>
>```

#### â‘¡ åˆ†çº¿ç¨‹

>å°†è®¡ç®—æ”¾ç½®åˆ†çº¿ç¨‹ä¸­
>
>`æ³¨æ„`:alert(result)  alertæ˜¯windowçš„æ–¹æ³•, åœ¨åˆ†çº¿ç¨‹ä¸èƒ½è°ƒç”¨,`åˆ†çº¿ç¨‹ä¸­çš„å…¨å±€å¯¹è±¡ä¸å†æ˜¯window`, æ‰€ä»¥åœ¨åˆ†çº¿ç¨‹ä¸­ä¸å¯èƒ½æ›´æ–°ç•Œé¢
>
>```js
>//worker.js
>function fibonacci(n) {
>  return n<=2 ? 1 : fibonacci(n-1) + fibonacci(n-2)  //é€’å½’è°ƒç”¨
>}
>
>console.log(this)
>this.onmessage = function (event) {
>  var number = event.data
>  console.log('åˆ†çº¿ç¨‹æ¥æ”¶åˆ°ä¸»çº¿ç¨‹å‘é€çš„æ•°æ®: '+number)
>  //è®¡ç®—
>  var result = fibonacci(number)
>  postMessage(result)
>  console.log('åˆ†çº¿ç¨‹å‘ä¸»çº¿ç¨‹è¿”å›æ•°æ®: '+result)
>  // alert(result)  alertæ˜¯windowçš„æ–¹æ³•, åœ¨åˆ†çº¿ç¨‹ä¸èƒ½è°ƒç”¨
>  // åˆ†çº¿ç¨‹ä¸­çš„å…¨å±€å¯¹è±¡ä¸å†æ˜¯window, æ‰€ä»¥åœ¨åˆ†çº¿ç¨‹ä¸­ä¸å¯èƒ½æ›´æ–°ç•Œé¢
>}
>```

### â…¢-æµç¨‹åŸç†å›¾

> ![image-20210729173545339](image/image-20210729173545339.png)













