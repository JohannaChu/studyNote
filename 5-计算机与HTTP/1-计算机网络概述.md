# 计算机网络概述

## 基本概念

> 计算机网络是**互连**的，**自治**的计算机的集合
>
> 协议的定义：是网络通信实体之间在数据交换过程中需要遵循的规则或预定，包括：
>
> - 语法（交换信息的格式与结构）
> - 语义（交换信息的数据的格式 - 交换信息中需要发送(或包含)哪种控制信息，这些信息的具体含义，以及针对不同含义的控制信息，接收信息端应如何响应）
> - 时序（交换信息的顺序以及如何匹配或适应彼此的速度）
>
> 计算机网络的功能：
>
> - 硬件资源共享
> - 软件资源共享
> - 信息资源共享
>
> 计算机网络的分类：
>
> - 按覆盖范围：个域网、局域网、城域网、广域网（覆盖范围从小到大）
> - 按拓扑结构：星形、总线型、环形、网状、树形等
> - 按交换方式：电路交换网络、报文交换网络、分组交换网络（目前常用的）
> - 按网络用户属性：公用网、私有网
> 
## 计算机网络结构
>网络边缘：对数据进行处理（连接到网络上的所有端系统构成 网络边缘）- 又叫资源层
>
>接入网络：实现网络边缘的端系统与网络核心的连接与接入
>
>- 电话拨号
>- 非对称瀛湖数字线ADSL
>- 混合光纤同轴电缆
>- 局域网
>- 移动接入网络（现在都是用这个）
>
>网络核心：是由通信链路互连的分组交换设备构成的网络，作用是实现网络边缘中主机之间的数据中继与转发（网络核心不处理数据，只传递数据） - 又叫通信层
>
## 数据交换与网络性能
>交换结点与传输介质的集合称为通信子网，即网络核心
>
>- 电路交换
>- 报文交换
>
>网络性能的描述参数
>
>- 速率：网络单位事件内传送的数据量，基本单位是bit/s(bps)
>- 带宽：信号具有的频带宽度（信号成分的最高频率与最低频率之差）- 频域方面的参数
>- 时延：数据从网络的一个节点到另一个节点的时间（主要有四类延迟）
>- 丢包率：用于评价和衡量网络性能的指标，可以反应网络的拥塞程度（丢包率=丢失分组总数/发送分组总数）
>
## 计算机网络体系结构
>体系结构：计算机网络所划分的层次以及各层协议的集合
>
### OSI参考模型
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317155333490.png" alt="image-20220317155333490" style="zoom:80%;" />
>
>发送进程全部走完后才会转成信号的编码方式传输给接收端
>
>#### （1）应用层
>
>`OSI`参考模型中最靠近用户的一层，是为计算机用户提供应用接口，也为用户直接提供各种网络服务。常见应用层的网络服务协议有：`HTTP`，`HTTPS`，`FTP`，`POP3`、`SMTP`等
>
>- 在客户端与服务器中经常会有数据的请求，这个时候就是会用到`http(hyper text transfer protocol)(超文本传输协议)`或者`https`
>- `FTP`是文件传输协议
>- `SMTP`是`simple mail transfer protocol（简单邮件传输协议）`。在一个项目中，在用户邮箱验证码登录的功能时，使用到了这个协议。
>
>#### （2）表示层
>
>表示层提供各种用于应用层数据的编码和转换功能,确保一个系统的应用层发送的数据能被另一个系统的应用层识别。如果必要，该层可提供一种标准表示形式，用于将计算机内部的多种数据格式转换成通信中采用的标准表示形式。数据压缩和加密也是表示层可提供的转换功能之一
>
>在项目开发中，为了方便数据传输，可以使用`base64`对数据进行编解码。如果按功能来划分，`base64`应该是工作在表示层
>
>#### （3）会话层
>
>会话层就是负责建立、管理和终止表示层实体之间的通信会话。该层的通信由不同设备中的应用程序之间的服务请求和响应组成
>
>#### （4）传输层
>
>传输层建立了主机端到端的链接，传输层的作用是为上层协议提供端到端的可靠和透明的数据传输服务，包括处理差错控制和流量控制等问题。该层向高层屏蔽了下层数据通信的细节，使高层用户看到的只是在两个传输实体间的一条主机到主机的、可由用户控制和设定的、可靠的数据通路。我们通常说的，`TCP` `UDP`就是在这一层。端口号既是这里的“端”
>
>#### （5）网络层
>
>本层通过`IP`寻址来建立两个节点之间的连接，为源端的运输层送来的分组，选择合适的路由和交换节点，正确无误地按照地址传送给目的端的运输层。就是通常说的`IP`层。这一层就是我们经常说的`IP`协议层。`IP`协议是`Internet`的基础。我们可以这样理解，网络层规定了数据包的传输路线，而传输层则规定了数据包的传输方式。
>
>#### （6）数据链路层
>
>将比特组合成字节,再将字节组合成帧,使用链路层地址 (以太网使用MAC地址)来访问介质,并进行差错检测。 网络层与数据链路层的对比，通过上面的描述，我们或许可以这样理解，网络层是规划了数据包的传输路线，而数据链路层就是传输路线。不过，在数据链路层上还增加了差错控制的功能。
>
>#### （7）物理层
>
>实际最终信号的传输是通过物理层实现的。通过物理介质传输比特流。规定了电平、速度和电缆针脚。常用设备有（各种物理设备）集线器、中继器、调制解调器、网线、双绞线、同轴电缆。这些都是物理层的传输介质。
>
>OSI七层模型通信特点：对等通信   对等通信，为了使数据分组从源传送到目的地，源端OSI模型的每一层都必须与目的端的对等层进行通信，这种通信方式称为对等层通信。在每一层通信过程中，使用本层自己协议进行通信。
### TCP/IP参考模型
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317160033845.png" alt="image-20220317160033845" style="zoom:80%;" />
>
>- 网络接口层对应OSI的物理层和数据链路层 - 实现物理层的传输比特流和数据链路层的点到点的数据间的可靠传输功能
>- 网际层对应网络层 - 实现网络中从源主机到目的主机的路径选择
>- 运输层对应传输层 - 复用，分用和可靠传输
>- 应用层对应会话层、表示层、应用层，合并为一层
>
### TCP五层参考模型
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317160212863.png" alt="image-20220317160212863" style="zoom:80%;" />
>
>**应用层 (application layer)**：直接为应用进程提供服务。应用层协议定义的是应用进程间通讯和交互的规则，不同的应用有着不同的应用层协议，如 HTTP协议（万维网服务）、FTP协议（文件传输）、SMTP协议（电子邮件）、DNS（域名查询）等。
>
>**传输层 (transport layer)**：有时也译为运输层，它负责为两台主机中的进程提供通信服务。该层主要有以下两种协议：
>
>- 传输控制协议 (Transmission Control Protocol，TCP)：提供面向连接的、可靠的数据传输服务，数据传输的基本单位是报文段（segment）；
>- 用户数据报协议 (User Datagram Protocol，UDP)：提供无连接的、尽最大努力的数据传输服务，但不保证数据传输的可靠性，数据传输的基本单位是用户数据报。
>
>**网络层 (internet layer)**：有时也译为网际层，它负责为两台主机提供通信服务，并通过选择合适的路由将数据传递到目标主机。
>
>**数据链路层 (data link layer)**：负责将网络层交下来的 IP 数据报封装成帧，并在链路的两个相邻节点间传送帧，每一帧都包含数据和必要的控制信息（如同步信息、地址信息、差错控制等）。
>
>**物理层 (physical Layer)**：确保数据可以在各种物理媒介上进行传输，为数据的传输提供可靠的环境。

### 总结

> <img src="C:\Users\Z\Desktop\1-计算机网络概述.assets\image-20220319164654282.png" alt="image-20220319164654282" style="zoom: 80%;" />
>
> 在每一层都工作着不同的设备：
>
> <img src="C:\Users\Z\Desktop\1-计算机网络概述.assets\image-20220319164901390.png" alt="image-20220319164901390" style="zoom:80%;" />
>
> 在每一层实现的协议也各不同，即每一层的服务也不同：
>
> <img src="C:\Users\Z\Desktop\1-计算机网络概述.assets\image-20220319164945648.png" alt="image-20220319164945648" style="zoom:80%;" />
>
> `TCP/IP`五层协议的通信方式也是对等通信：
>
> <img src="C:\Users\Z\Desktop\1-计算机网络概述.assets\image-20220319165033677.png" alt="image-20220319165033677" style="zoom:80%;" />

# 网络应用

## 计算机网络应用体系结构

> 有三种类型：
>
> - 客户/服务器（C/S）结构：客户主动请求服务器，通信只在客户与服务器之间进行，客户与客户之间不进行直接通信
> - P2P结构：每个对等端都同时具备C/S应用的客户和服务器的特征，是一个服务器与客户的结合体，对等端之间直接通信（也就是服务端和客户端之间的关系可以对调，这次你是服务端我是客户端，下次你是客户端我是服务端）
> - 混合结构：既有中心服务器的存在，也有对等端(客户)间的直接通信
> 

## 网络应用通信基本原理
>三种类型的原理都是一样的：服务器端运行的是服务器进程,被动地等待客户请求服务;客户端运行的是客户进程,主动发起通信,请求服务器进程提供服务。应用进程间遵循应用层协议交换应用层报文
>

## 域名系统
>域名：采用特定的字符或符号以特定的结构来表示计算机名称的命名方法
>
>域名解析：将域名映射为IP地址的过程
>
>域名服务器：为了实现域名解析,需要建立分布式数据库，存储网络中域名与IP地址的映射关系数据，这些数据库存储在域名服务器上， 域名服务器根据用户的请求提供域名解析服务
>
>域名解析过程：区别在于域名服务器的配合方式不一样
>
>- 递归查询：由域名服务器代替查询主机或其他域名服务器（实际上就是代替客户端向其他域名服务器进行查询，如果不知道的话再向上一级服务器进行查询），进行进一步的域名查询，并将最终解析结果发送给查询主机或服务器
>
>  <img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317163031835.png" alt="image-20220317163031835" style="zoom:67%;" />
>
>  ​					缺点：根域名服务器负担很大
>
>- 选代查询：只是将下一步要查询的服务器告知查询主机或服务器（如果不知道，可以告诉客户端去查哪个）
>
>  <img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317163051519.png" alt="image-20220317163051519" style="zoom:67%;" />
>  
## HTTP
>### 1.HTTP(超文本传输协议) - 是使用HTML编写和设计的文件，过程：
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317164257910.png" alt="image-20220317164257910" style="zoom:80%;" />
>
>- 由客户机向服务器发起TCP请求连接，作用是保证传输的可靠性
>- 建立连接后在应用层使用HTTP协议，由客户机上的浏览器根据页面要访问的网址来发出HTTP的请求报文，HTTP报文内包含了URL信息，URL中包含了服务器主机的域名，浏览器会通过域名查询的DNS服务器来获得web服务器的IP地址，根据IP地址来建立TCP的连接，建立连接后再发送HTTP报文，在报文中把URL携带上
>- URL发到服务器后服务器会根据URL找到相应的网页资源，网页内容会作为HTTP报文的响应信息返回给浏览器，浏览器会解析编译，以特定的格式呈现
>
>### 2.HTTP概念
>
>HTTP是超文本传输协议,定义浏览器如何向Web服务器发送请求以及Web服务器如何向浏览器进行响应
>
>版本: HTTP/1.0 和HTTP/1.1
>
>HTTP连接:非持久连接（非持久连接和并行连接），持久连接（非流水方式连接，流水方式连接）
>
>### 3.报文
>
>- HTTP报文：请求报文 - 从客户向服务器发送请求报文
>
>  <img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317165347778.png" alt="image-20220317165347778" style="zoom:67%;" />
>
>  版本指的是1.0还是1.1的HTTP版本；首部行可以认为是传递给服务器的参数，由key-value组成
>
>  请求方法：GET、HEAD、POST、OPTION、 PUT
>
>  - GET：请求读取由URL所标识的信息
>  - HEAD ：请求读取由URL所标识的信息的首部（如HTML的头部<head>标签的内容），无须在响应报文中包含对象
>  - POST：给服务器添加信息(例如注释)
>  - OPTION：请求一些选项的信息
>  - PUT：在指明的URL下存储一个文档
>
>- 响应报文：从服务器到客户的回答
>
>  <img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317165943709.png" alt="image-20220317165943709" style="zoom:67%;" />
>
>  短语：简单描写状态码的含义
>
>  状态码信息：
>
>  <img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317170120459.png" alt="image-20220317170120459" style="zoom:67%;" />
>
>  ### 4.cookie
>
>  Cookie：小型文本文件，文本文件包含了一个编号，是分配给某个客户的固定编号，会存储在服务器和浏览器上，通过编号的对比可以实现会话跟踪（某些网站为了辨别用户身份，进行会话跟踪而储存在用户本地终端上的数据）
>
>  弥补了HTTP协议无状态性的不足，有利于进行用户跟踪并提供针对性的服务，但也带来一些安全问题
>
>  <img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317170743420.png" alt="image-20220317170743420" style="zoom:50%;" />
>  

## socket
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317171824767.png" alt="image-20220317171824767" style="zoom: 67%;" />
>
>### TCP
>
>![image-20220317172955793](C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317172955793.png)
>
>服务端的close()方法结束后会关闭 TCP连接（关闭单个客户端的TCP连接），而不是整个监听端口的TCP关闭了，bind()监听端口还可以继续监听由其他主机（客户端）发出的请求，直到没有其他客户端发请求或服务器要求关机，才会关闭监听端口，整个程序退出
>
>### UDP
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220317172602419.png" alt="image-20220317172602419" style="zoom:50%;" />
>
>服务器都是固定分配的端口号，不需要建立连接
>

# 传输层

## 基本服务

> 传输层的核心任务是为应用进程之间提供**端到端**的逻辑通信服务；主要功能:
>
> - 传输层寻址
>
> - 应用层报文的分段和重组
>
> - 报文的差错检测
>
> - 进程间的端到端可靠数据传输控制
>
> - 面向应用层实现复用与分解端到端的流量控制
>
> - 拥塞控制
>
>   传输层协议提供**逻辑通信**服务（网络层实现数据的快速传输，但不解决数据丢失的问题，此时需要主机端的运输层及时发现是否丢失并通知对方计算机，对方计算机通过处理发送丢失数据）
>
>   传输层协议只需在**端系统**中实现（网络层实现主机对主机的通信）
>
>   通信的真正端点并不是主机，而是主机中运行的**应用进程**
>
>   一般是在网络边缘实现的（例如主机，终端）
>
> 
>
> ### 1. 传输层寻址与端口
>
> - 用统一的寻址方法对应用进程进行标识一一端口号
> - 在全网范围内利用“IP地址+端口号”准一标识一个通信端点（通信端实际上是就是一个应用进程）
> - 传输层端口号为16位整数，包含三类端口
>   - 熟知端口号,数值为0~1023
>   - 登记端口号，数值为1024~49151，为没有熟知端口号的应用程序使用的；使用这个范围的端口号必须在IANA登记以防止重复
>   - 客户端口号或短暂端口号，数值为49152~65535，留给客户进程选择暂时使用（端口号不固定）
>

## 停等协议与滑动窗口协议

>### 1. 可靠数据传输原理
>
>- 差错检测，利用差错编码实现数据包传输过程中的比特差错检测
>- 确认：接收方向发送方反馈接收状态
>- 重传：发送方重新发送接收方没有正确接收的数据（收到了但是出错了会进行重传）
>- 序号：确保数据按序提交（可能会收到两份相同的数据，根据序号删除重复数据）
>- 计时器：解决数据丢失问题（在规定的时间内没有收到数据则认为数据丢失，因此需要开启一个定时器）
>
>### 2. 停-等协议
>
>停-等协议的主要特点就是每发送一个报文段后就停下来等待接收方的确认
>
>基本工作过程是
>
>- 发送方发送经过差错编码和编号的报文段，等待接收方的确认(发送并等待确认)
>- 接收方如果正确接收报文段，即差错检测无误且序号正确则接收报文段，并向发送方发送ACK，否则丢弃报发送方发送NAK(接收并确认/否认)
>- 发送方如果收到ACK，则继续发送后续报文段，否则重发刚刚发送的报文段(继续发送/重发)
>
>停-等协议的主要性能问题：停止-等待机制降低了信道利用率
>
>解决方法：流水线协议或管道协议--允许发送方在没有收到确认前连续发送多个分组（典型的流水线协议：滑动窗口协议）
>
>流水线协议的改进：
>
>- 增加分组序号范围
>- 发送方和(或)接收方必须缓存多个分组
>
>### 3. 滑动窗口协议
>
>在滑动窗口进行数据缓存，两种最具有代表性的滑动窗口协议
>
>- 回退N步(Go-Back-N, GBN)协议：发送端窗口大小较大,可以在未得到确认前连续发送多个分组;但接收窗口大小仅为1,只能接收1个按序到达的分组,未按序到达的分组或者某个分组差错,就会引起发送方重发该分组及其之后的所有分组
>- 选择重传(Selective Repeat , SR)协议:增加接收方缓存能力(接收窗口>1),缓存正确到达但失序的分组,仅要求发送方重传未被接收方确认的分组,等缺失分组到达后一并向上层按序提交

## TCP和UDP的区别
>### 无连接服务和面向连接服务
>
>- 无连接服务：数据传输之前无需与对端进行任何信息交换(即“握手”)，直接构造传输层报文段并向接收端发送(UDP)
>- 面向连接服务：在数据传输之前，需要双方交换些控制信息，建立**逻辑连接**，然后再传输数据，数据传输结束后还需要再拆除连接（TCP）
>
## UDP
>用户数据报协议（UDP）是Internet传输层协议,提供无连接、不可靠、数据报尽力传输服务
>
>UDP数据结构：
>
>- 源和目的端口号：用于UDP实现复用与分解（源端口号/目的端口号长度共16位，内容包括发送端/接收端的应用程序的地址）
>- 长度字段：在UDP报文段中的字节数(首部和数据的总和) - 数据长度
>- 校验和：接收方用来检测该报文段是否出现了差错 - 采用校验码的方式
>
## TCP
>面向连接的可靠服务
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220318133831387.png" alt="image-20220318133831387" style="zoom:80%;" />
>
>- 源端口/目的端口：该报文的发送端/接收端 端口的应用程序地址
>- 序号：标识该TCP报文到整个TCP数据的位置（保证可靠传输的重要标志）- 一个TCP被分成很多小份
>- 确认号：接收端确认收到发送的数据并且返回确认号，哪个序号的数据收到了（和序号配合使用）
>- URG：紧急指针位，当特殊情况发生时紧急指针有效，此时URG=1
>- ACK：表示确认位，若ACK=1，则代表该报文确认号有效
>- PUSH：TCP报文可以很快把数据进行传输
>- RST：复位，有时连接出现异常需要重新连接，此时需要复位
>- SYN：同步请求，双方要协商一个起始的第一个数据的编号是多少
>- FIN：双方通信结束后拆除连接，FIN=1则代表双方通信结束
>- 窗口：告诉对方我目前滑动窗口有多大，缓存有多大，发送多少数据量可以接收，但可以协商因为接收能力会变化
>- 校验和：对数据进行校验，接收方也要根据校验和对数据进行差错的检验
>
>### TCP的连接管理：
### 连接建立一一三次握手

>三次握手其实就是指建立一个TCP连接时，需要客户端和服务器总共发送3个包。进行三次握手的主要作用就是为了确认双方的接收能力和发送能力是否正常、指定自己的初始化序列号为后面的可靠性传送做准备。实质上其实就是连接服务器指定端口，建立TCP连接，并同步连接双方的序列号和确认号，交换TCP窗口大小信息。
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220318142814806.png" alt="image-20220318142814806" style="zoom: 80%;" />
>
>- 刚开始客户端处于 Closed 的状态，服务端处于 Listen 状态
>- SYN连接请求：发送一个同步请求，当接收到则返回一个响应信息
>- SYN、ACK确认：如果接收到SYN的同步请求，服务端会发送ACK同步确认给客户端；还会携带一个服务端的SYN同步请求
>- ACK确认：客户端发送给服务器发送ACK表示确定
>
>只有上述三次握手成功才会建立连接，之后才会传输数据，不成功则不会传数据；并且数据的传输要根据序号传输
>
>总结：
>
>- **第一次握手：** 客户端向服务端发送连接请求报文段。该报文段中包含自身的数据通讯初始序号。请求发送后，客户端便进入 SYN-SENT 状态。
>
>- **第二次握手：** 服务端收到连接请求报文段后，如果同意连接，则会发送一个应答，该应答中也会包含自身的数据通讯初始序号，发送完成后便进入 SYN-RECEIVED 状态
>
>- **第三次握手：** 当客户端收到连接同意的应答后，还要向服务端发送一个确认报文。客户端发完这个报文段后便进入 ESTABLISHED 状态，服务端收到这个应答后也进入 ESTABLISHED 状态，此时连接建立成功。
>
### 断开连接一一四次挥手
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220318135636653.png" alt="image-20220318135636653" style="zoom:80%;" />
>
>连接释放请求可以是客户端发出也可以是服务端发出，但是连接建立请求只能是客户端发出
>
>- 一开始发送FIN报文请求，并且携带一个序号
>- 服务端收到后返回一个ACK确认信息，确认号位u+1，服务端自己的数据编号为v
>- 连接的断开是单向的，当客户端接收到ACK后只是客户端不再向服务端发送数据，但如果B仍然有数据给A，还是可以进行传输的；只有当B没有数据传给A了，B才会向A发送一个断开连接的请求FIN=1
>- A直到B的数据也传完了，返回一个确认号ACK=1；服务端一旦接收到就进入CLOSE阶段关闭，但是A还有一个time-wait
>
>总结：
>
>- **第一次挥手：** 若客户端认为数据发送完成，则它需要向服务端发送连接释放请求。
>- **第二次挥手**：服务端收到连接释放请求后，会告诉应用层要释放 TCP 链接。然后会发送 ACK 包，并进入 CLOSE_WAIT 状态，此时表明客户端到服务端的连接已经释放，不再接收客户端发的数据了。但是因为 TCP 连接是双向的，所以服务端仍旧可以发送数据给客户端。
>- **第三次挥手**：服务端如果此时还有没发完的数据会继续发送，完毕后会向客户端发送连接释放请求，然后服务端便进入 LAST-ACK 状态。
>- **第四次挥手：** 客户端收到释放请求后，向服务端发送确认应答，此时客户端进入 TIME-WAIT 状态。该状态会持续 2MSL（最大段生存期，指报文段在网络中生存的时间，超时会被抛弃） 时间，若该时间段内没有服务端的重发请求的话，就进入 CLOSED 状态。当服务端收到确认应答后，也便进入 CLOSED 状态
>
>
>最后一次挥手中，客户端会等待一段时间再关闭的原因，是为了防止发送给服务器的确认报文段丢失或者出错，从而导致服务器 端不能正常关闭
### 可靠数据传输
>
>- TCP的可靠数据传输实现机制包括差错编码、确认、序号、重传、计时器等
>- TCP的可靠数据传输是基于滑动窗口协议，但是发送窗口大小动态变化
>- 总结：
>  - 封装TCP报文段
>  - 发出一个报文段后启动一个计时器
>  - 通过校验和发现数据差错
>  - 通过序号重新排序,丢弃重复的报文段
>  - 流量控制
>
### 流量控制
>
>- TCP协议利用窗口机制实现流量控制,但不是简单的滑动窗口协议
>- TCP连接建立时，双方都为之分配了固定大小的缓冲空间；TCP的接收端只允许另一端发送其缓冲区所能接纳据
> - 接收端在给发送端发送确认段时，通告接收窗口大小
> - 发送端在接下来发送数据段时，确保未确认段的应用层数据总量不超过接收端通告的接收窗口大小，从而确保接收端不会发生缓存溢出
>
### 拥塞控制
>拥塞控制是为了控制在网络中的传输
>
>
>- 窗口机制：通过调节窗口的大小实现对发送数据速率的调整
>- 窗口调整的基本策略：AIMD (Additive Increase, Multiplicative Decrease) -- 加性增加，乘性减小（网络未发生拥塞时，逐渐“加性”增大窗口大小；当络拥塞时“乘性”快速减小窗口大小）
>- TCP的拥塞控制算法包括了慢启动、拥塞避免、快速重传和快速恢复4部分

# 网络层

## 网络层服务

>网络层的主要作用是将网络层数据报从源主机送达目的主机。主要功能:
>
>- 转发:分组从输入接口转移到输出接口
>- 路由选择:决定分组经过的路由或路径
>
><img src="C:\Users\Z\AppData\Roaming\Typora\typora-user-images\image-20220318145251513.png" alt="image-20220318145251513" style="zoom:67%;" />

## 数据报网络和与虚电路网络

> 数据报网络：按照目的主机地址进行路由选择的网络（根据目的主机地址选择不同的路径）。特点:
>
> - 无连接
> - 每个分组作为一个独立的数据报进行传送，路径也可能不同
> - 分组可能出现乱序和丢失（堵塞或者丢失了）
>
> 虚电路网络在网络层提供面向连接的分组交换服务。特点:
>
> - 建立一条网络层逻辑连接
> - 不需要为每条虚电路分配独享资源(区别于电路交换) 
> - 根据虚电路号沿虚电路路径按序发送分组
>
> 现在互联网一般使用数据报的方式，虽然会丢失但是效率高，而且传输层用了TCP有不会丢失的保障

## 网络互连

> 异构网络：两个网络的通信技术和运行的协议不同。异构网络互连的基本策略:
>
> - 协议转换
> - 构建虚拟互联网络（用IP协议构建虚拟互联网络，上层都是IP协议，但是下层可以是自己的网络技术）

## 网络层拥塞

> ### 1. 拥塞
>
> 拥塞：一种持续过载的网络状态,此时用户对网络资源(包括链路带宽、存储空间和处理器处理能力等)的总需求超过了网络固有的容量。原因:
>
> - 缓冲区容量有限
> - 传输线路的带宽有限
> - 网络结点的处理能力有限
> - 网络中某些部分发生了故障
>
> 解决方法：流量感知路由 -- 根据网络负载动态调整,将网络流量引导到不同的链路上,均衡网络负载,从而延缓或避免拥塞发生。解决网络负载的震荡现象：（拥塞状况的量化：基于平均流量和瞬时流量）
>
> - 多路径路由：缓慢转移流量至另一链路
> - 准入控制：是一种广泛应用于虚电路网络的拥塞预防技术。基本思想是对新建虚电路进行审核,如果新建立的虚电路会导致网络变得拥塞,那么网络拒绝建立该新虚电路
>
> ### 2. 流量调节
>
> - 感知拥塞
> - 处理拥塞:将拥塞信息通知到其上游结点，处理方法
>   - 抑制分组：给拥塞数据报的源主机返回一个抑制分组（让源结点不要再发那么多东西过来）
>   - 背压：让抑制分组在从拥塞结点到源结点的路径上的每一跳，都发挥抑制作用（不止是源节点，经过的每个节点都发生抑制）
>
> ### 3.负载脱落
>
> 负载脱落:路由器主动丢弃某些数据报。如何选择要丢弃的数据报
>
> - 丢弃新分组:如GBN
> - 丢弃老分组:如实时视频流（针对应用）
>
> 上面三种方法都是解决网络层拥塞的方法

# 数据链路层与局域网

> 综上总结：
>
> - 应用层：
> - 传输层：保证对应用层的服务复用分用，以及保证它的数据可靠性传输
> - 网络层：从主机到主机经过路由转发把数据从主机到主机（决定从这个节点到哪个节点）
> - 链路层：把数据从一个节点可靠的传输给另一个节点
>
> 数据链路层主要功能：
>
> - 组帧
> - 链路接入:点对点链路、广播链路
> - 可靠交付(可靠传输方法多用出错率链路）
> - 差错控制（差错检测 - 主要手段：差错编码）

## 局域网：主要针对广播链路

>MAC地址：每个接口对应一个MAC地址，且全球唯一长度48位 - 前24位叫厂商标识（应用层有域名，网络层有IP地址，传输层有端口号，每一层都有自己的地址，因为网络是分层的，每层只处理自己的东西）
>
>地址解析协议（ARP）：根据本网内目的主机或默认网关的IP地址获取其MAC地址 - 利用查询/响应的方式（广播方式）
>
>### 1. 交换机
>
>- 转发与过滤：可以依据接收到的链路层帧的目的MAC地址,选择性地转发相应的端口；是以目的MAC地址为主键,查找交换表
>- 自学习交换机通过自学习构建交换表

## 点对点链路协议:主要用于拨号上网

> 点对点协议 - PPP：能够处理差错检测、支持多种上层协议、允许连接时协商IP地址、允许身份认证，功能：
>
> - 成帧（封装成帧）
> - 链路控制协议LCP（双方建立起通信链路）
> - 网络控制协议NCP

# 物理层

> 负责把所有比特的数据转换成物理信号在线路传输，功能：
>
> - 信道利用（利用信道传输数据）
> - 接口及信号产生
> - 同步（发送端发出1个，接收方接收一个）
> - 差错检测与纠正
> - 寻址与路由（主要在数据链路层）
> - 网络管理
> - 安全保证

# 网络安全

> 网络安全通信所需要的基本属性：
>
> - 机密性
> - 消息完整性
> - 可访问与可用性
> - 身份认证
>
> 网络安全威胁：
>
> - 窃听
> - 插入
> - 假冒
> - 劫持
> - 拒绝服务DoS和分布式拒绝服务DDoS
> - 映射：端口扫描（扫描所有端口看有无相应的服务，分析服务有可能的缺陷）
> - 嗅探
> - IP欺骗（某种类型的假冒）

## 数据加密

> - 传统加密：凯撒密码、列置换密码
> - 现代加密：
>   - 对称密钥密码：加密密钥和解密密钥相同(密钥保密) - 对称密钥密码分类：分组密码（**DES**, **AES**、IDEA）和 流密码
>   - 非对称密钥密码:加密密钥和解密密钥不同 - RSA算法、Diffie-Hellman算法

## 网络安全协议

> - 安全电子邮件标准：PGP
> - 在通信安全中使用SSL套接字保障通信安全（SSL建立在传输层） -  SSL是介于应用层和传输层之间的安全协议；SSL握手过程：协商密码组、生成密钥、服务器/客户认证与鉴别
> - 虚拟专用网VPN安全：IPSec（建立在网络层）- 提供机密性、身份鉴别、数据完整性验证和防重放攻击服务
>   - 体系结构：认证头AH协议、封装安全载荷ESP协议
>   - 运行模式：传输模式(AH传输模式、ESP传输模式)和隧道模式(AH隧道模式、ESP隧道模式)
